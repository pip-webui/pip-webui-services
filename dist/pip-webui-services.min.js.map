{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","src/ServicesModule.ts","src/routing/BackDecorator.ts","src/routing/RedirectDecorator.ts","src/routing/RoutingEvents.ts","src/routing/RoutingModule.ts","src/session/IdentityService.ts","src/session/SessionModule.ts","src/session/SessionService.ts","src/transactions/Transaction.ts","src/transactions/TransactionError.ts","src/transactions/TransactionModule.ts","src/transactions/TransactionService.ts","src/transactions/TransactionStrings.ts","src/translate/TranslateDirective.ts","src/translate/TranslateFilter.ts","src/translate/TranslateModule.ts","src/translate/TranslateService.ts","src/translate/Translation.ts","src/utilities/Codes.ts","src/utilities/Format.ts","src/utilities/PageResetService.ts","src/utilities/ScrollService.ts","src/utilities/SystemInfo.ts","src/utilities/Tags.ts","src/utilities/TimerService.ts"],"names":["f","exports","module","define","amd","g","window","global","self","this","pip","services","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","angular","captureStateTranslations","$rootScope","$on","event","toState","toParams","fromState","fromParams","CurrentState","name","url","params","PreviousState","decorateBackStateService","$delegate","$window","goBack","history","back","goBackAndSelect","state","_","cloneDeep","extend","go","addBackStateDecorator","$provide","decorator","$inject","config","run","3","decorateRedirectStateProvider","redirect","RedirectedStates","addRedirectStateProviderDecorator","$timeout","isNull","preventDefault","transitionTo","location","addRedirectStateDecorator","decorateRedirectStateService","4","hookRoutingEvents","$log","$state","RoutingVar","error","unfoundState","to","5","./RedirectDecorator","./RoutingEvents","6","IdentityRootVar","IdentityChangedEvent","IdentityService","setRootVar","identity","_setRootVar","_identity","_rootScope","_log","prototype","value","$emit","debug","id","full_name","enumerable","configurable","IdentityProvider","_service","get","set","$get","provider","7","./SessionService","8","SessionRootVar","SessionOpenedEvent","SessionClosedEvent","SessionService","session","_session","defineProperty","isOpened","open","fullReset","partialReset","close","oldSession","SessionProvider","9","Transaction","scope","_scope","_id","_operation","_progress","_error","message","reset","busy","failed","empty","aborted","begin","operation","Date","getTime","toString","update","progress","Math","max","abort","end","decode","10","TransactionError","details","cause","stack_trace","data","statusText","status","11","./TransactionStrings","12","TransactionService","_transactions","create","transaction","Transaction_1","13","configureTransactionStrings","$injector","has","setTranslations","ENTERING","PROCESSING","LOADING","SAVING","pipTranslate","restrict","key1","key2","link","element","attrs","key","translate","text","html","directive","translateDirective","translateHtmlDirective","translateFilter","optionalTranslateFilter","16","./TranslateFilter","./TranslateService","17","__extends","d","b","__","constructor","p","hasOwnProperty","Object","LanguageRootVar","LanguageChangedEvent","TranslateService","translation","persist","_persist","_translation","_window","localStorage","language","getItem","save","setItem","PageResetService_1","ResetPageEvent","use","translations","translateArray","keys","translateSet","keyProp","valueProp","translateObjects","items","translateWithPrefix","prefix","translateSetWithPrefix","translateSetWithPrefix2","_super","TranslateProvider","Translation","./Translation","18","en","ru","es","pt","de","fr","_language","map","_translations","isUndefined","values","each","k","push","item","replace","toUpperCase","19","Codes","hash","result","charCodeAt","verification","random","substr","20","Format","cache","sample","maxLength","indexOf","substring","strRepeat","str","qty","getType","variable","slice","toLowerCase","parseFormat","fmt","match","parse_tree","arg_names","exec","_fmt","field_list","replacement_field","field_match","format","argv","tree_length","output","node_type","arg","cursor","sprintf","test","String","fromCharCode","parseInt","toExponential","parseFloat","toFixed","abs","pad_character","charAt","pad_length","pad","join","_i","arguments","args","21","hookResetEvents","pipPageReset","ResetAreaEvent","area","resetArea","ResetRootVar","ResetAreaRootVar","PageResetService","_timeout","performReset","_this","scrollTo","parentElement","childElement","animationDuration","undefined","setTimeout","$","position","modDiff","scrollTop","top","animate","ScrollService","SystemInfo","ua","navigator","userAgent","search","browserName","browser","version","split","osAll","osAndroid","err","isDesktop","platform","isMobile","isCordova","isSupported","supported","edge","ie","opera","chrome","browserVersion","service","Tags","normalizeOne","tag","trim","compressOne","equal","tag1","tag2","normalizeAll","tags","isString","compressAll","extract","entity","searchFields","field","hashTags","concat","uniq","TimerEvent","timeout","DefaultEvents","TimerService","$interval","_started","_events","_interval","isStarted","addEvent","existingEvent","find","newEvent","startEvent","removeEvent","stopEvent","splice","clearEvents","stop","interval","cancel","ex","start"],"mappings":"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","file":"pip-webui-services.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","﻿'use strict';\r\n\r\nimport './translate/TranslateModule';\r\nimport './session/SessionModule';\r\nimport './transactions/TransactionModule';\r\nimport './routing/RoutingModule';\r\nimport './utilities/Format';\r\nimport './utilities/TimerService';\r\nimport './utilities/ScrollService';\r\nimport './utilities/Tags';\r\nimport './utilities/Codes';\r\nimport './utilities/SystemInfo';\r\nimport './utilities/PageResetService';\r\n\r\nangular.module('pipServices', [\r\n    'pipTranslate',\r\n    'pipSession',\r\n    'pipTransaction',\r\n    'pipRouting',\r\n    'pipFormat',\r\n    'pipTimer',\r\n    'pipScroll',\r\n    'pipTags',\r\n    'pipCodes',\r\n    'pipSystemInfo',\r\n    'pipPageReset'\r\n]);\r\n","'use strict';\r\n\r\nexport let CurrentState: any;\r\nexport let PreviousState: any;\r\n\r\nfunction captureStateTranslations($rootScope: ng.IRootScopeService) {\r\n    \"ngInject\";\r\n\r\n    $rootScope.$on('$stateChangeSuccess',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            CurrentState = {\r\n                name: toState.name, \r\n                url: toState.url, \r\n                params: toParams\r\n            };\r\n\r\n            PreviousState = {\r\n                name: fromState.name, \r\n                url: fromState.url, \r\n                params: fromParams\r\n            };\r\n        }\r\n    );\r\n\r\n}\r\n\r\nfunction decorateBackStateService($delegate, $window: ng.IWindowService) {\r\n    \"ngInject\";\r\n\r\n    $delegate.goBack = goBack;\r\n    $delegate.goBackAndSelect = goBackAndSelect;\r\n\r\n    return $delegate;\r\n    //////////////////////////////////////////////////\r\n\r\n    function goBack(): void {\r\n        $window.history.back()\r\n    }\r\n\r\n    function goBackAndSelect(params: any): void {\r\n        if (PreviousState != null \r\n            && PreviousState.name != null) {\r\n\r\n            let state = _.cloneDeep(PreviousState);\r\n\r\n            // Override selected parameters\r\n            state.params = _.extend(state.params, params);\r\n\r\n            $delegate.go(state.name, state.params);\r\n        } else {\r\n            $window.history.back();\r\n        }\r\n    }\r\n}\r\n\r\nfunction addBackStateDecorator($provide) {\r\n    $provide.decorator('$state', decorateBackStateService);\r\n}\r\n\r\nangular\r\n    .module('pipRouting')\r\n    .config(addBackStateDecorator)\r\n    .run(captureStateTranslations);\r\n    ","'use strict';\r\n\r\nlet RedirectedStates: any = {};\r\n\r\nfunction decorateRedirectStateProvider($delegate) {\r\n    \"ngInject\";\r\n\r\n    $delegate.redirect = redirect;\r\n\r\n    return $delegate;\r\n    /////////////////////////////////////////////\r\n\r\n    // Specify automatic redirect from one state to another\r\n    function redirect(fromState, toState) {\r\n        RedirectedStates[fromState] = toState;  \r\n        return this;\r\n    }\r\n}\r\n\r\nfunction addRedirectStateProviderDecorator($provide) {\r\n    \"ngInject\";\r\n\r\n    $provide.decorator('$state', decorateRedirectStateProvider);\r\n}\r\n\r\nfunction decorateRedirectStateService($delegate, $timeout) {\r\n    \"ngInject\";\r\n\r\n    $delegate.redirect = redirect;\r\n    \r\n    return $delegate;\r\n    ////////////////////////////////\r\n    \r\n    // Todo: Move this code directly to event handler?\r\n    // Todo: Nothing calls this code!!\r\n    function redirect(event, state, params) {\r\n        let toState = RedirectedStates[state.name];\r\n        if (_.isFunction(toState)) {\r\n            toState = toState(state.name, params);\r\n\r\n            if (_.isNull(toState))\r\n                throw new Error('Redirected toState cannot be null');\r\n        }\r\n\r\n        if (!!toState) {\r\n            $timeout(() => {\r\n                event.preventDefault();\r\n                $delegate.transitionTo(toState, params, {location: 'replace'});\r\n            });\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction addRedirectStateDecorator($provide) {\r\n    \"ngInject\";\r\n\r\n    $provide.decorator('$state', decorateRedirectStateService);\r\n}\r\n\r\nangular\r\n    .module('pipRouting')\r\n    .config(addRedirectStateProviderDecorator)\r\n    .config(addRedirectStateDecorator);\r\n    ","'use strict';\r\n\r\nexport let RoutingVar: string = \"$routing\";\r\n\r\nfunction hookRoutingEvents(\r\n    $rootScope: ng.IRootScopeService,\r\n    $log: ng.ILogService,\r\n    $state: ng.ui.IStateService\r\n) {\r\n    \"ngInject\";\r\n\r\n    $rootScope.$on('$stateChangeStart',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            $rootScope[RoutingVar] = true;\r\n        }\r\n    );\r\n\r\n    $rootScope.$on('$stateChangeSuccess',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            // Unset routing variable to disable page transition\r\n            $rootScope[RoutingVar] = false;                \r\n        }\r\n    );\r\n\r\n    // Intercept route error\r\n    $rootScope.$on('$stateChangeError',\r\n        (event, toState, toParams, fromState, fromParams, error) => {\r\n            // Unset routing variable to disable page transition\r\n            $rootScope[RoutingVar] = false;\r\n\r\n            $log.error('Error while switching route to ' + toState.name);\r\n            $log.error(error);\r\n        }\r\n    );\r\n\r\n    // Intercept route error\r\n    $rootScope.$on('$stateNotFound',\r\n        function(event, unfoundState, fromState, fromParams) {\r\n            event.preventDefault();\r\n\r\n            $rootScope[RoutingVar] = false;\r\n\r\n            // Todo: Move to errors\r\n            $state.go('errors_missing_route',  {\r\n                    unfoundState: unfoundState,\r\n                    fromState : {\r\n                        to: fromState ? fromState.name : '',\r\n                        fromParams: fromParams\r\n                    }\r\n                }\r\n            );\r\n        }\r\n    );\r\n\r\n}\r\n\r\nangular\r\n    .module('pipRouting')\r\n    .run(hookRoutingEvents);\r\n    ","'use strict';\r\n\r\nangular.module('pipRouting', ['ui.router']);\r\n\r\nimport './BackDecorator';\r\nimport './RedirectDecorator';\r\nimport './RoutingEvents';\r\n","'use strict';\r\n\r\nexport let IdentityRootVar = \"$identity\";\r\nexport let IdentityChangedEvent = \"pipIdentityChanged\";\r\n\r\nexport interface IIdentity {\r\n    id: string;\r\n    full_name: string;\r\n    details: string;\r\n    email: string;\r\n    photo_url: string;\r\n}\r\n\r\nexport interface IIdentityService {\r\n    identity: IIdentity;\r\n}\r\n\r\nexport interface IIdentityProvider extends ng.IServiceProvider {\r\n    setRootVar: boolean;\r\n    identity: IIdentity;\r\n}\r\n\r\n\r\nclass IdentityService implements IIdentityService {\r\n    private _identity: IIdentity;\r\n    private _setRootVar: boolean;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n\r\n    public constructor(\r\n        setRootVar: boolean,\r\n        identity: IIdentity,\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._identity = identity;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n\r\n        this.setRootVar();\r\n    }\r\n\r\n    private setRootVar(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[IdentityRootVar] = this._identity;\r\n    }\r\n\r\n    public get identity(): IIdentity {\r\n        return this._identity;\r\n    }\r\n\r\n    public set identity(value: IIdentity) {\r\n        this._identity = value;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(IdentityChangedEvent, this._identity);\r\n\r\n        let identity: IIdentity = value || <IIdentity>{};\r\n        this._log.debug(\"Changed identity to \" + identity.id + \" \" + identity.full_name);\r\n    }\r\n}\r\n\r\nclass IdentityProvider implements IdentityProvider {\r\n    private _setRootVar = true;\r\n    private _identity: IIdentity = null;\r\n    private _service: IdentityService = null;\r\n\r\n    public constructor() { }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get identity(): any {\r\n        return this._identity;  \r\n    }\r\n\r\n    public set identity(value: any) {\r\n        this._identity = value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null)\r\n            this._service = new IdentityService(this._setRootVar, this._identity, $rootScope, $log);\r\n\r\n        return this._service;\r\n    }\r\n\r\n}\r\n\r\nangular\r\n    .module('pipSession')\r\n    .provider('pipIdentity', IdentityProvider);\r\n","'use strict';\r\n\r\nangular.module('pipSession', []);\r\n\r\nimport './IdentityService';\r\nimport './SessionService';\r\n","'use strict';\r\n\r\nexport const SessionRootVar = \"$session\";\r\nexport const SessionOpenedEvent = \"pipSessionOpened\";\r\nexport const SessionClosedEvent = \"pipSessionClosed\";\r\n\r\nexport interface ISessionService {\r\n    session: any;\r\n    isOpened(): boolean;\r\n\r\n    open(session: any): void;\r\n    close(): void;\r\n}\r\n\r\nexport interface ISessionProvider extends ng.IServiceProvider {\r\n    setRootVar: boolean;\r\n    session: any;\r\n}\r\n\r\nclass SessionService implements ISessionService {\r\n    private _setRootVar: boolean;\r\n    private _session: any;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n\r\n    public constructor(\r\n        setRootVar: boolean, \r\n        session: any, \r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._session = session;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n\r\n        this.setRootVar();\r\n    }\r\n    \r\n    private setRootVar(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[SessionRootVar] = this._session;\r\n    }\r\n\r\n    public get session(): any {\r\n        return this._session;\r\n    }\r\n\r\n    public isOpened(): boolean {\r\n        return this._session != null;\r\n    }\r\n\r\n    public open(session: any, fullReset: boolean = false, partialReset: boolean = false) {\r\n        if (session == null)\r\n            throw new Error(\"Session cannot be null\");\r\n\r\n        this._session = session;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(SessionOpenedEvent, session);\r\n\r\n        this._log.debug(\"Opened session \" + session);\r\n    }\r\n\r\n    public close(fullReset: boolean = false, partialReset: boolean = false) {\r\n        let oldSession = this._session;\r\n\r\n        this._session = null;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(SessionClosedEvent, oldSession);\r\n\r\n        this._log.debug(\"Closed session \" + oldSession);\r\n    }\r\n}\r\n\r\nclass SessionProvider implements ISessionProvider {\r\n    private _setRootVar = true;\r\n    private _session: any = null;\r\n    private _service: SessionService = null;\r\n\r\n    public constructor() { }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get session(): any {\r\n        return this._session;  \r\n    }\r\n\r\n    public set session(value: any) {\r\n        this._session = value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null)\r\n            this._service = new SessionService(this._setRootVar, this._session, $rootScope, $log);\r\n\r\n        return this._service;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipSession')\r\n    .provider('pipSession', SessionProvider); \r\n","'use strict';\r\n\r\nimport { TransactionError } from './TransactionError'\r\n\r\nexport class Transaction {\r\n    private _scope: string;\r\n    private _id: string;\r\n    private _operation: string;\r\n    private _error: TransactionError = new TransactionError();\r\n    private _progress: number = 0;\r\n\r\n    public constructor(scope: string) {\r\n        this._scope = scope;\r\n    }\r\n\r\n    public get scope(): string {\r\n        return this._scope;\r\n    }\r\n\r\n    public get id(): string {\r\n        return this._id;\r\n    }\r\n\r\n    public get operation(): string {\r\n        return this._operation;\r\n    }\r\n\r\n    public get progress(): number {\r\n        return this._progress;\r\n    }\r\n\r\n    public get error(): TransactionError {\r\n        return this._error;\r\n    }\r\n\r\n    public get errorMessage(): string {\r\n        return this._error.message;\r\n    }\r\n\r\n    public reset(): void {\r\n        this._id = null;\r\n        this._operation = null;\r\n        this._progress = 0;\r\n        this._error.reset();\r\n    }\r\n\r\n    public busy(): boolean {\r\n        return this._id != null;\r\n    }\r\n\r\n    public failed(): boolean {\r\n        return !this._error.empty();\r\n    }\r\n\r\n    public aborted(id: string): boolean {\r\n        return this._id != id;\r\n    }\r\n\r\n    public begin(operation: string): string {\r\n        // Transaction is already running\r\n        if (this._id != null) return null;\r\n\r\n        this._id = new Date().getTime().toString();\r\n        this._operation = operation || 'PROCESSING'\r\n        this._error.reset();\r\n\r\n        return this._id;\r\n    }\r\n\r\n    public update(progress: number): void {\r\n        this._progress = Math.max(progress, 100);\r\n    }\r\n\r\n    public abort(): void {\r\n        this._id = null;\r\n        this._error.reset();\r\n    }\r\n\r\n    public end(error?: any): void {\r\n        this._error.decode(error);\r\n        this._id = null;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport class TransactionError {\r\n    public code: string;\r\n    public message: string;\r\n    public details: any;\r\n    public cause: string;\r\n    public stack_trace: string;\r\n\r\n    public constructor(error?: any) {\r\n        if (error != null)\r\n            this.decode(error);\r\n    }\r\n\r\n    public reset(): void {\r\n        this.code = null;\r\n        this.message = null;\r\n        this.details = null;\r\n        this.cause = null;\r\n        this.stack_trace = null;\r\n    }\r\n\r\n    public empty(): boolean {\r\n        return this.message = null && this.code == null;\r\n    }\r\n\r\n    public decode(error: any): void {\r\n        this.reset();\r\n\r\n        if (error == null) return;\r\n\r\n        // Process regular messages\r\n        if (error.message) \r\n            this.message = error.message;\r\n\r\n        // Process server application errors\r\n        if (error.data) {\r\n            if (error.data.code) { \r\n                // process server error codes here\r\n                this.message = this.message || 'ERROR_' + error.data.code;\r\n                this.code = this.code || error.data.code;\r\n            }\r\n\r\n            if (error.data.message)\r\n                this.message = this.message || error.data.message;\r\n\r\n            this.message = this.message || error.data;\r\n            this.details = this.details || error.data;\r\n\r\n            this.cause = error.data.cause;\r\n            this.stack_trace = error.data.stack_trace;\r\n            this.details = error.data.details;            \r\n        }\r\n\r\n        // Process standard HTTP errors\r\n        if (error.statusText)\r\n            this.message = this.message || error.statusText;\r\n\r\n        if (error.status) {\r\n            this.message = this.message || 'ERROR_' + error.status;\r\n            this.code = this.code || error.status;\r\n        }\r\n        \r\n        this.message = this.message || error;\r\n        this.details = this.details || error;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nangular.module('pipTransaction', []);\r\n\r\nimport './TransactionStrings';\r\nimport './TransactionService';\r\n","'use strict';\r\n\r\nimport { Transaction } from './Transaction';\r\n\r\nexport interface ITransactionService {\r\n    create(scope?: string): Transaction;\r\n    get(scope?: string): Transaction;\r\n}\r\n\r\nclass TransactionService implements TransactionService {\r\n    private _transactions: any = {};\r\n\r\n    public constructor() {}\r\n\r\n    public create(scope?: string): Transaction {\r\n        let transaction = new Transaction(scope);\r\n        \r\n        if (scope != null)\r\n            this._transactions[scope] = transaction;\r\n\r\n        return transaction;\r\n    }\r\n\r\n    public get(scope?: string): Transaction {\r\n        let transaction: Transaction = scope != null ? <Transaction>this._transactions[scope] : null;\r\n\r\n        if (transaction == null) {\r\n            transaction = new Transaction(scope);\r\n            if (scope != null)\r\n                this._transactions[scope] = transaction;\r\n        }\r\n\r\n        return transaction;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTransaction')\r\n    .service('pipTransaction', TransactionService);\r\n","'use strict';\r\n\r\nfunction configureTransactionStrings($injector) {\r\n    \"ngInject\";\r\n\r\n    let pipTranslate = $injector.has('pipTranslateProvider') ? $injector.get('pipTranslateProvider') : null;\r\n\r\n    if (pipTranslate) {\r\n        pipTranslate.setTranslations('en', {\r\n            'ENTERING': 'Entering...',\r\n            'PROCESSING': 'Processing...',\r\n            'LOADING': 'Loading...',\r\n            'SAVING': 'Saving...'\r\n        });\r\n\r\n        pipTranslate.setTranslations('ru', {\r\n            'ENTERING': 'Вход в систему...',\r\n            'PROCESSING': 'Обрабатывается...',\r\n            'LOADING': 'Загружается...',\r\n            'SAVING': 'Сохраняется...'\r\n        });   \r\n    }\r\n    \r\n}\r\n\r\nangular\r\n    .module('pipTransaction')\r\n    .config(configureTransactionStrings);\r\n","'use strict';\r\n\r\nfunction translateDirective(pipTranslate): ng.IDirective {\r\n    \"ngInject\";\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            key1: '@pipTranslate',\r\n            key2: '@key'\r\n        },\r\n        link: (scope: any, element: any, attrs: any) => {\r\n            let key = scope.key1 || scope.key2;\r\n            let value = pipTranslate.translate(key);\r\n            element.text(value);\r\n        }\r\n    };\r\n}\r\n\r\nfunction translateHtmlDirective(pipTranslate): ng.IDirective {\r\n    \"ngInject\";\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            key1: '@pipTranslateHtml',\r\n            key2: '@key'\r\n        },\r\n        link: (scope: any, element: any, attrs: any) => {\r\n            let key = scope.key1 || scope.key2;\r\n            let value = pipTranslate.translate(key);\r\n            element.html(value);\r\n        }\r\n    };\r\n}\r\n\r\nangular\r\n    .module('pipTranslate')\r\n    .directive('pipTranslate', translateDirective)\r\n    .directive('pipTranslateHtml', translateHtmlDirective);\r\n","'use strict';\r\n\r\nfunction translateFilter(pipTranslate) {\r\n    \"ngInject\";\r\n\r\n    return function (key) {\r\n        return pipTranslate.translate(key) || key;\r\n    }\r\n}\r\n\r\nfunction optionalTranslateFilter($injector) {\r\n    \"ngInject\";\r\n\r\n    let pipTranslate = $injector.has('pipTranslate') \r\n        ? $injector.get('pipTranslate') : null;\r\n\r\n    return function (key) {\r\n        return pipTranslate  ? pipTranslate.translate(key) || key : key;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTranslate')\r\n    .filter('translate', translateFilter);\r\n","'use strict';\r\n\r\nangular.module('pipTranslate', []);\r\n\r\nimport './TranslateService';\r\nimport './TranslateFilter';\r\nimport './TranslateDirective';\r\n","﻿'use strict';\r\n\r\nimport { Translation } from './Translation';\r\nimport { ResetPageEvent } from '../utilities/PageResetService';\r\n\r\nexport let LanguageRootVar = \"$language\";\r\nexport let LanguageChangedEvent = \"pipLanguageChanged\";    \r\n\r\nexport interface ITranslateService {\r\n    language: string;\r\n\r\n    use(language: string): string;\r\n    setTranslations(language: string, translations: any): void;\r\n    translations(language: string, translations: any): void;\r\n\r\n    translate(key: string): string;\r\n    translateArray(keys: string[]): string[];\r\n    translateSet(keys: string[], keyProp: string, valueProp: string): any[];\r\n    translateObjects(items: any[], keyProp: string, valueProp: string): any[];\r\n    translateWithPrefix(prefix: string, key: string);\r\n    translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string);\r\n    translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string);\r\n}\r\n\r\nexport interface ITranslateProvider extends ITranslateService, ng.IServiceProvider {\r\n}\r\n\r\nclass TranslateService implements ITranslateService {\r\n    private _translation: Translation;\r\n    private _setRootVar: boolean;\r\n    private _persist: boolean;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _window: ng.IWindowService;\r\n\r\n    public constructor(\r\n        translation: Translation,\r\n        setRootVar: boolean,\r\n        persist: boolean,\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService,\r\n        $window: ng.IWindowService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._persist = persist;\r\n        this._translation = translation;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._window = $window;\r\n\r\n        if (this._persist && this._window.localStorage)\r\n            this._translation.language = this._window.localStorage.getItem('language') || this._translation.language;\r\n\r\n        this._log.debug(\"Set language to \" + this._translation.language);\r\n\r\n        this.save();\r\n    }\r\n\r\n    private save(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[LanguageRootVar] = this._translation.language;\r\n\r\n        if (this._persist && this._window.localStorage != null)\r\n            this._window.localStorage.setItem('language', this._translation.language);\r\n    }\r\n\r\n    public get language(): string {\r\n        return this._translation.language;\r\n    }\r\n\r\n    public set language(value: string) {\r\n        if (value != this._translation.language) {\r\n            this._translation.language = value;\r\n            \r\n            this._log.debug(\"Changing language to \" + value);\r\n\r\n            this.save();                \r\n\r\n            this._rootScope.$emit(LanguageChangedEvent, value);\r\n            this._rootScope.$emit(ResetPageEvent);\r\n        }\r\n    }\r\n\r\n    public use(language: string): string {\r\n        if (language != null)\r\n            this.language = language;\r\n        return this.language;\r\n    }\r\n\r\n    public setTranslations(language: string, translations: any): void {\r\n        return this._translation.setTranslations(language, translations);\r\n    }\r\n\r\n    public translations(language: string, translations: any): void {\r\n        return this._translation.setTranslations(language, translations);\r\n    }\r\n\r\n    public translate(key: string): string {\r\n        return this._translation.translate(key);\r\n    }\r\n\r\n    public translateArray(keys: string[]): string[] {\r\n        return this._translation.translateArray(keys);\r\n    }\r\n    \r\n    public translateSet(keys: string[], keyProp: string, valueProp: string): any[] {\r\n        return this._translation.translateSet(keys, keyProp, valueProp);\r\n    }\r\n\r\n    public translateObjects(items: any[], keyProp: string, valueProp: string): any[] {\r\n        return this._translation.translateObjects(items, keyProp, valueProp);\r\n    }\r\n\r\n    public translateWithPrefix(prefix: string, key: string) {\r\n        return this._translation.translateWithPrefix(prefix, key);\r\n    }\r\n\r\n    public translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        return this._translation.translateSetWithPrefix(prefix, keys, keyProp, valueProp);\r\n    }\r\n\r\n    public translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        return this._translation.translateSetWithPrefix2(prefix, keys, keyProp, valueProp);\r\n    }\r\n}\r\n\r\nclass TranslateProvider extends Translation implements ITranslateProvider {\r\n    private _translation: Translation;\r\n    private _setRootVar: boolean = true;\r\n    private _persist: boolean = true;\r\n    private _service: TranslateService;\r\n    \r\n    public constructor() {\r\n        super();\r\n    }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get persist(): boolean {\r\n        return this._persist;  \r\n    }\r\n\r\n    public set persist(value: boolean) {\r\n        this._persist = !!value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $window: ng.IWindowService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null) \r\n            this._service = new TranslateService(this, this._setRootVar, this._persist, $rootScope, $log, $window);\r\n\r\n        return this._service;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTranslate')\r\n    .provider('pipTranslate', TranslateProvider);\r\n","'use strict';\r\n\r\nexport class Translation {\r\n    protected _language = 'en';\r\n    protected _translations = {\r\n        en: {\r\n            'en': 'English',\r\n            'ru': 'Russian',\r\n            'es': 'Spanish',\r\n            'pt': 'Portuguese',\r\n            'de': 'German',\r\n            'fr': 'French'\r\n        },\r\n        ru: {\r\n            'en': 'Английский',\r\n            'ru': 'Русский',\r\n            'es': 'Испанский',\r\n            'pt': 'Португальский',\r\n            'de': 'Немецкий',\r\n            'fr': 'Французский'\r\n        }\r\n    };\r\n\r\n    public constructor() {}\r\n\r\n    public get language(): string { return this._language; }\r\n    public set language(value: string) { this._language = value; }\r\n\r\n    public use(language: string): string {\r\n        if (language != null)\r\n            this._language = language;\r\n        return this._language;\r\n    }\r\n\r\n    // Set translation strings for specific language\r\n    public setTranslations(language: string, translations: any): void {\r\n        let map = this._translations[language] || {};\r\n        this._translations[language] = _.extend(map, translations);\r\n    }\r\n\r\n    // Yet another method to set translation strings for specific language\r\n    public translations(language: string, translations: any): void {\r\n        this.setTranslations(language, translations);\r\n    }\r\n\r\n    // Translate a string by key using set language\r\n    public translate(key: string): string {\r\n        if (_.isNull(key) || _.isUndefined(key)) return '';\r\n\r\n        let translations = this._translations[this._language] || {};\r\n        return translations[key] || key;\r\n    }\r\n\r\n    // Translate an array of strings\r\n    public translateArray(keys: string[]): string[] {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (k) {\r\n            let key = k || '';\r\n            values.push(translations[key] || key);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate an array of strings into array of objects (set)\r\n    public translateSet(keys: string[], keyProp: string, valueProp: string): any[] {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n\r\n        let values: any[] = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {};\r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[key] || key;\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate a collection of objects\r\n    public translateObjects(items: any[], keyProp: string, valueProp: string): any[] {\r\n        if (_.isNull(items) || items.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'name';\r\n        valueProp = valueProp || 'nameLocal';\r\n\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(items, function (item) {\r\n            let key = item[keyProp] || '';\r\n\r\n            item[valueProp] = translations[key] || key;\r\n        });\r\n\r\n        return items;\r\n    }\r\n\r\n    // Translate a string by key  with prefix using set language todo\r\n    public translateWithPrefix(prefix: string, key: string) {\r\n        prefix = prefix ? prefix + '_' : '';\r\n        key = (prefix + key).replace(/ /g, '_').toUpperCase();\r\n        if (key == null) return '';\r\n        let translations = this._translations[this._language] || {};\r\n        return translations[key] || key;\r\n    };\r\n\r\n    public translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() : '';\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {}; \r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[prefix + '_' + key] || key;\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate an array of strings, apply uppercase and replace ' ' => '_'\r\n    public translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n        prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() + '_': '';\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {};\r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[prefix + key.replace(/ /g, '_').toUpperCase()]\r\n                || (prefix + key.replace(/ /g, '_').toUpperCase());\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport interface ICodes {\r\n    // Simple version of string hashcode\r\n    hash(value: string): number;\r\n    // Generates random big number for verification codes\r\n    verification(): string;\r\n}\r\n\r\n\r\nclass Codes implements ICodes {\r\n    // Simple version of string hashcode\r\n    public hash(value: string): number {\r\n        if (value == null) return 0;\r\n        \r\n        let result = 0;\r\n        for (let i = 0; i < value.length; i++)\r\n            result += value.charCodeAt(i);\r\n\r\n        return result;\r\n    }\r\n\r\n    // Generates random big number for verification codes\r\n    public verification(): string {\r\n        return Math.random().toString(36).substr(2, 10).toUpperCase(); // remove `0.`\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipCodes', [])\r\n    .service('pipCodes', Codes);\r\n","'use strict';\r\n\r\nexport interface IFormat {\r\n    // Creates a sample line from a text\r\n    sample(value: string, maxLength: number): string;\r\n\r\n    sprintf(message: string, ...args: any[]): string;\r\n}\r\n\r\n\r\nclass Format implements IFormat {\r\n    // Cached for parsed formats\r\n    private cache = {};\r\n\r\n    // Creates a sample line from a text\r\n    public sample(value: string, maxLength: number): string {\r\n        if (!value || value == '') return '';\r\n\r\n        var length = value.indexOf('\\n');\r\n        length = length >= 0 ? length : value.length;\r\n        length = length < maxLength ? value.length : maxLength;\r\n\r\n        return value.substring(0, length);\r\n    }\r\n\r\n    private strRepeat(str: string, qty: number): string {\r\n        if (qty < 1) return '';\r\n        var result = '';\r\n        while (qty > 0) {\r\n            if (qty & 1) result += str;\r\n            qty >>= 1, str += str;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private getType(variable) {\r\n        return toString.call(variable).slice(8, -1).toLowerCase();\r\n    }\r\n\r\n    private parseFormat(fmt: string) {\r\n        let _fmt = fmt, match = [], parse_tree = [], arg_names = 0;\r\n        while (_fmt) {\r\n            if ((match = /^[^\\x25]+/.exec(_fmt)) !== null) {\r\n                parse_tree.push(match[0]);\r\n            }\r\n            else if ((match = /^\\x25{2}/.exec(_fmt)) !== null) {\r\n                parse_tree.push('%');\r\n            }\r\n            else if ((match = /^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt)) !== null) {\r\n                if (match[2]) {\r\n                    arg_names |= 1;\r\n                    var field_list = [], replacement_field = match[2], field_match = [];\r\n                    if ((field_match = /^([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                        field_list.push(field_match[1]);\r\n                        while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {\r\n                            if ((field_match = /^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                                field_list.push(field_match[1]);\r\n                            }\r\n                            else if ((field_match = /^\\[(\\d+)\\]/.exec(replacement_field)) !== null) {\r\n                                field_list.push(field_match[1]);\r\n                            }\r\n                            else {\r\n                                throw new Error('Unknown error');\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        throw new Error('Unknown error');\r\n                    }\r\n                    match[2] = field_list;\r\n                }\r\n                else {\r\n                    arg_names |= 2;\r\n                }\r\n                if (arg_names === 3) {\r\n                    throw new Error('Mixing positional and named placeholders is not (yet) supported');\r\n                }\r\n                parse_tree.push(match);\r\n            }\r\n            else {\r\n                throw new Error('Unknown error');\r\n            }\r\n            _fmt = _fmt.substring(match[0].length);\r\n        }\r\n        return parse_tree;\r\n    }\r\n\r\n    private format(parse_tree, argv) {\r\n        let cursor = 0; \r\n        let tree_length = parse_tree.length; \r\n        let output = [];\r\n\r\n        for (let i = 0; i < tree_length; i++) {\r\n            let node_type = this.getType(parse_tree[i]);\r\n            if (node_type === 'string') {\r\n                output.push(parse_tree[i]);\r\n            }\r\n            else if (node_type === 'array') {\r\n                let match = parse_tree[i]; // convenience purposes only\r\n                let arg: any;\r\n                if (match[2]) { // keyword argument\r\n                    arg = argv[cursor];\r\n                    for (let k = 0; k < match[2].length; k++) {\r\n                        if (!arg.hasOwnProperty(match[2][k])) {\r\n                            throw new Error(this.sprintf('Property \"%s\" does not exist', match[2][k]));\r\n                        }\r\n                        arg = arg[match[2][k]];\r\n                    }\r\n                } else if (match[1]) { // positional argument (explicit)\r\n                    arg = argv[match[1]];\r\n                }\r\n                else { // positional argument (implicit)\r\n                    arg = argv[cursor++];\r\n                }\r\n\r\n                if (/[^s]/.test(match[8]) && (this.getType(arg) != 'number')) {\r\n                    throw new Error(this.sprintf('Expecting number but found %s', this.getType(arg)));\r\n                }\r\n                switch (match[8]) {\r\n                    case 'b': arg = arg.toString(2); break;\r\n                    case 'c': arg = String.fromCharCode(arg); break;\r\n                    case 'd': arg = parseInt(arg, 10); break;\r\n                    case 'e': arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential(); break;\r\n                    case 'f': arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg); break;\r\n                    case 'o': arg = arg.toString(8); break;\r\n                    case 's': arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg); break;\r\n                    case 'u': arg = Math.abs(arg); break;\r\n                    case 'x': arg = arg.toString(16); break;\r\n                    case 'X': arg = arg.toString(16).toUpperCase(); break;\r\n                }\r\n                arg = (/[def]/.test(match[8]) && match[3] && arg >= 0 ? '+'+ arg : arg);                \r\n                let pad_character = match[4] ? match[4] == '0' ? '0' : match[4].charAt(1) : ' ';\r\n                let pad_length = match[6] - String(arg).length;\r\n                let pad = match[6] ? this.strRepeat(pad_character, pad_length) : '';\r\n                output.push(match[5] ? arg + pad : pad + arg);\r\n            }\r\n        }\r\n        return output.join('');\r\n    }\r\n    \r\n    public sprintf(message: string, ...args: any[]): string {\r\n        if (!this.cache.hasOwnProperty(message))\r\n            this.cache[message] = this.parseFormat(message);\r\n\r\n        return this.format(this.cache[message], args);\r\n    }\r\n}\r\n\r\n\r\nangular\r\n    .module('pipFormat', [])\r\n    .service('pipFormat', Format);\r\n","'use strict';\r\n\r\nexport let ResetPageEvent: string = \"pipResetPage\";\r\nexport let ResetAreaEvent: string = \"pipResetArea\";\r\n\r\nexport let ResetRootVar: string = \"$reset\";\r\nexport let ResetAreaRootVar: string = \"$resetArea\";\r\n\r\nexport interface IPageResetService {\r\n    reset(): void;\r\n    resetArea(area: string): void;\r\n}\r\n\r\n\r\nclass PageResetService implements IPageResetService {\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _timeout: ng.ITimeoutService;\r\n\r\n    public constructor(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $timeout: ng.ITimeoutService\r\n    ) {\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._timeout = $timeout;\r\n\r\n        $rootScope[ResetRootVar] = false;\r\n        $rootScope[ResetAreaRootVar] = null;\r\n    }\r\n\r\n    public reset(): void {\r\n        this._log.debug(\"Resetting the entire page\");\r\n        this.performReset(null);\r\n    }\r\n\r\n    public resetArea(area: string): void {\r\n        this._log.debug(\"Resetting the area \" + area);\r\n        this.performReset(area);\r\n    }\r\n\r\n    private performReset(area?: string): void {\r\n        this._rootScope[ResetRootVar] = area == null;\r\n        this._rootScope[ResetAreaRootVar] = area;\r\n\r\n        this._timeout(() => {\r\n            this._rootScope[ResetRootVar] = false;\r\n            this._rootScope[ResetAreaRootVar] = null;\r\n        }, 0);\r\n    }\r\n}\r\n\r\n\r\nfunction hookResetEvents(\r\n    $rootScope: ng.IRootScopeService, \r\n    pipPageReset: IPageResetService\r\n) {\r\n    $rootScope.$on(ResetPageEvent, () => { pipPageReset.reset(); });\r\n    $rootScope.$on(ResetAreaEvent, (event, area) => { pipPageReset.resetArea(area); });\r\n}\r\n\r\n\r\nangular.module('pipPageReset', [])\r\n    .service('pipPageReset', PageResetService)\r\n    .run(hookResetEvents);\r\n","'use strict';\r\n\r\nexport interface IScrollService {\r\n    scrollTo(parentElement, childElement, animationDuration): void;\r\n}\r\n\r\nclass ScrollService implements IScrollService {\r\n\r\n    public scrollTo(parentElement, childElement, animationDuration): void {\r\n        if (!parentElement || !childElement) return;\r\n        if (animationDuration == undefined) animationDuration = 300;\r\n\r\n        setTimeout(function () {\r\n            if (!$(childElement).position()) return;\r\n            var modDiff= Math.abs($(parentElement).scrollTop() - $(childElement).position().top);\r\n            if (modDiff < 20) return;\r\n            var scrollTo = $(parentElement).scrollTop() + ($(childElement).position().top - 20);\r\n            if (animationDuration > 0)\r\n                $(parentElement).animate({\r\n                    scrollTop: scrollTo + 'px'\r\n                }, animationDuration);\r\n        }, 100);\r\n    }\r\n\r\n}\r\n\r\n\r\nangular\r\n    .module('pipScroll', [])\r\n    .service('pipScroll', ScrollService);\r\n","'use strict';\r\n\r\nexport interface ISystemInfo {\r\n    browserName: string;\r\n    browserVersion: string;\r\n    platform: string;\r\n    os: string;\r\n\r\n    isDesktop(): boolean;\r\n    isMobile(): boolean;\r\n    isCordova(): boolean;\r\n    isSupported(supported?: any): boolean;\r\n}\r\n\r\n\r\nclass SystemInfo implements ISystemInfo {\r\n    private _window: ng.IWindowService;\r\n\r\n    public constructor($window: ng.IWindowService) {\r\n        \"ngInject\";\r\n\r\n        this._window = $window;\r\n    }\r\n\r\n    // todo add support for iPhone\r\n    public get browserName(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        if (ua.search(/Edge/) > -1) return \"edge\";\r\n        if (ua.search(/MSIE/) > -1) return \"ie\";\r\n        if (ua.search(/Trident/) > -1) return \"ie\";\r\n        if (ua.search(/Firefox/) > -1) return \"firefox\";\r\n        if (ua.search(/Opera/) > -1) return \"opera\";\r\n        if (ua.search(/OPR/) > -1) return \"opera\";\r\n        if (ua.search(/YaBrowser/) > -1) return \"yabrowser\";\r\n        if (ua.search(/Chrome/) > -1) return \"chrome\";\r\n        if (ua.search(/Safari/) > -1) return \"safari\";\r\n        if (ua.search(/Maxthon/) > -1) return \"maxthon\";\r\n        \r\n        return \"unknown\";\r\n    }\r\n\r\n    public get browserVersion(): string {\r\n        let version;\r\n        let ua = this._window.navigator.userAgent;\r\n        let browser = this.browserName;\r\n\r\n        switch (browser) {\r\n            case \"edge\":\r\n                version = (ua.split(\"Edge\")[1]).split(\"/\")[1];\r\n                break;\r\n            case \"ie\":\r\n                version = (ua.split(\"MSIE \")[1]).split(\";\")[0];\r\n                break;\r\n            case \"ie11\":\r\n                browser = \"ie\";\r\n                version = (ua.split(\"; rv:\")[1]).split(\")\")[0];\r\n                break;\r\n            case \"firefox\":\r\n                version = ua.split(\"Firefox/\")[1];\r\n                break;\r\n            case \"opera\":\r\n                version = ua.split(\"Version/\")[1];\r\n                break;\r\n            case \"operaWebkit\":\r\n                version = ua.split(\"OPR/\")[1];\r\n                break;\r\n            case \"yabrowser\":\r\n                version = (ua.split(\"YaBrowser/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"chrome\":\r\n                version = (ua.split(\"Chrome/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"safari\":\r\n                version = (ua.split(\"Version/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"maxthon\":\r\n                version = ua.split(\"Maxthon/\")[1];\r\n                break;\r\n        }\r\n\r\n        return version;\r\n    }\r\n    \r\n    public get platform(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        if (/iphone|ipad|ipod|android|blackberry|mini|windows\\sce|palm/i.test(ua.toLowerCase())) \r\n            return 'mobile';\r\n\r\n        return 'desktop';\r\n    }\r\n\r\n    public get os(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        try {\r\n            let osAll = (/(windows|mac|android|linux|blackberry|sunos|solaris|iphone)/.exec(ua.toLowerCase()) || [ua])[0].replace('sunos', 'solaris');\r\n            let osAndroid = (/(android)/.exec(ua.toLowerCase()) || '');\r\n            return osAndroid && (osAndroid == 'android' || (osAndroid[0] == 'android')) ? 'android' : osAll;\r\n        } catch (err) {\r\n            return 'unknown'\r\n        }\r\n    }\r\n\r\n    public isDesktop(): boolean {\r\n        return this.platform == 'desktop';\r\n    }\r\n\r\n    public isMobile(): boolean {\r\n        return this.platform == 'mobile';\r\n    }\r\n\r\n    // Todo: complete implementation\r\n    public isCordova(): boolean {\r\n        return false;\r\n    }\r\n\r\n    // Todo: Move to errors\r\n    public isSupported(supported?: any): boolean {\r\n        if (!supported) \r\n            supported = {\r\n                edge: 11,\r\n                ie: 11,\r\n                firefox: 43, //4, for testing\r\n                opera: 35,\r\n                chrome: 47\r\n            };\r\n\r\n        let browser = this.browserName;\r\n        let version = this.browserVersion;\r\n        version = version.split(\".\")[0]\r\n\r\n        if (browser && supported[browser] && version >= supported[browser]) \r\n            return true;\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\n\r\nangular\r\n    .module('pipSystemInfo', [])\r\n    .service('pipSystemInfo', SystemInfo);\r\n","'use strict';\r\n\r\nexport interface ITags {\r\n    normalizeOne(tag: string): string;\r\n    compressOne(tag: string): string;\r\n    equal(tag1: string, tag2: string): boolean;\r\n    normalizeAll(tags: any): string[];\r\n    compressAll(tags: any): string[];\r\n    extract(entity: any, searchFields?: string[]): string[];\r\n}\r\n\r\n\r\nclass Tags implements ITags {\r\n\r\n    public normalizeOne(tag: string): string {\r\n        return tag \r\n            ? _.trim(tag.replace(/(_|#)+/g, ' '))\r\n            : null;\r\n    }\r\n\r\n    public compressOne(tag: string): string {\r\n        return tag\r\n            ? tag.replace(/( |_|#)/g, '').toLowerCase()\r\n            : null;\r\n    }\r\n\r\n    public equal(tag1: string, tag2: string): boolean {\r\n        if (tag1 == null && tag2 == null)\r\n            return true;\r\n        if (tag1 == null || tag2 == null)\r\n            return false;\r\n        return this.compressOne(tag1) == this.compressOne(tag2);\r\n    }\r\n\r\n    public normalizeAll(tags: any): string[] {\r\n        if (_.isString(tags))\r\n            tags = tags.split(/( |,|;)+/);\r\n\r\n        tags = _.map(tags, (tag: string) => this.normalizeOne(tag));\r\n\r\n        return tags;\r\n    }\r\n\r\n    public compressAll(tags: any): string[] {\r\n        if (_.isString(tags))\r\n            tags = tags.split(/( |,|;)+/);\r\n\r\n        tags = _.map(tags, (tag: string) => this.compressOne(tag));\r\n\r\n        return tags;\r\n    }\r\n\r\n    public extract(entity: any, searchFields?: string[]): string[] {\r\n        let tags = this.normalizeAll(entity.tags);\r\n\r\n        _.each(searchFields, (field) => {\r\n            let text = entity[field] || '';\r\n\r\n            if (text != '') {\r\n                let hashTags = text.match(/#\\w+/g);\r\n                tags = tags.concat(this.normalizeAll(hashTags));\r\n            }\r\n        });\r\n\r\n        return _.uniq(tags);\r\n    }\r\n}\r\n\r\n\r\nangular\r\n    .module('pipTags', [])\r\n    .service('pipTags', Tags);\r\n","'use strict';\r\n\r\nexport interface ITimerService {\r\n    isStarted(): boolean;\r\n\r\n    addEvent(event: string, timeout: number): void;\r\n    removeEvent(event: string): void;\r\n    clearEvents(): void;\r\n\r\n    start(): void;\r\n    stop(): void;\r\n}\r\n\r\n\r\nclass TimerEvent {\r\n    public event: string;\r\n    public timeout: number;\r\n    public interval: any;\r\n\r\n    public constructor(event: string, timeout: number) {\r\n        this.event = event;\r\n        this.timeout = timeout;\r\n    }\r\n}\r\n\r\n\r\nlet DefaultEvents: TimerEvent[] = [\r\n    new TimerEvent('pipAutoPullChanges', 60000), // 1 min\r\n    new TimerEvent('pipAutoUpdatePage', 15000), // 15 sec\r\n    new TimerEvent('pipAutoUpdateCollection', 300000) // 5 min\r\n];\r\n\r\n\r\nclass TimerService implements ITimerService {\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _interval: ng.IIntervalService;        \r\n    private _started = false;\r\n    private _events: TimerEvent[] = _.cloneDeep(DefaultEvents);\r\n\r\n    public constructor(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $interval: ng.IIntervalService\r\n    ) {\r\n        \"ngInject\";\r\n\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._interval = $interval;\r\n    }\r\n\r\n    public isStarted(): boolean {\r\n        return this._started;\r\n    }\r\n\r\n    public addEvent(event: string, timeout: number): void {\r\n        var existingEvent = _.find(this._events, (e) => e.event == event);\r\n        if (existingEvent != null) return;\r\n\r\n        let newEvent = <TimerEvent> {\r\n            event: event,\r\n            timeout: timeout\r\n        };\r\n        this._events.push(newEvent);\r\n\r\n        if (this._started)\r\n            this.startEvent(newEvent);\r\n    }\r\n\r\n    public removeEvent(event: string): void {\r\n        for (let i = this._events.length - 1; i >= 0; i--) {\r\n            let existingEvent = this._events[i];\r\n            if (existingEvent.event == event) {\r\n                this.stopEvent(existingEvent);\r\n                this._events.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    public clearEvents(): void {\r\n        this.stop();\r\n        this._events = [];\r\n    }\r\n\r\n    private startEvent(event: TimerEvent): void {\r\n        event.interval = this._interval(\r\n            () => { \r\n                this._log.debug('Generated timer event ' + event.event); \r\n                this._rootScope.$emit(event.event)\r\n            },\r\n            event.timeout\r\n        )\r\n    }\r\n\r\n    private stopEvent(event: TimerEvent): void {\r\n        if (event.interval != null) {\r\n            try {\r\n                this._interval.cancel(event.interval);\r\n            } catch (ex) {\r\n                // Do nothing\r\n            }\r\n            event.interval = null;\r\n        }\r\n    }\r\n\r\n    public start(): void {\r\n        if (this._started) return;\r\n\r\n        _.each(this._events, (event) => {\r\n            this.startEvent(event);\r\n        });\r\n\r\n        this._started = true;\r\n    }\r\n\r\n    public stop(): void {\r\n        _.each(this._events, (event) => {\r\n            this.stopEvent(event);\r\n        });\r\n\r\n        this._started = false;\r\n    }\r\n}\r\n\r\n\r\nangular.module('pipTimer', [])\r\n    .service('pipTimer', TimerService);\r\n"]}