{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","src/routing/back_decorator.ts","src/routing/redirect_decorator.ts","src/routing/routing.ts","src/routing/routing_events.ts","src/scope/scope_error.ts","src/scope/scope_transaction.ts","src/services.ts","src/session/identity.ts","src/session/session.ts","src/translate/translate.ts","src/translate/translate_directive.ts","src/translate/translate_filter.ts","src/translate/translate_service.ts","src/utilities/codes.ts","src/utilities/format.ts","src/utilities/reset.ts","src/utilities/scroll.ts","src/utilities/system_info.ts","src/utilities/tags.ts","src/utilities/timer.ts"],"names":["f","exports","module","define","amd","g","window","global","self","this","pip","services","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","captureStateTranslations","$rootScope","$on","event","toState","toParams","fromState","fromParams","CurrentState","name","url","params","PreviousState","decorateBackStateService","$delegate","$window","goBack","history","back","goBackAndSelect","state","_","cloneDeep","extend","go","addBackStateDecorator","$provide","decorator","$inject","config","run","4","decorateRedirectStateProvider","redirect","RedirectedStates","addRedirectStateProviderDecorator","$timeout","isNull","preventDefault","transitionTo","location","addRedirectStateDecorator","decorateRedirectStateService","5","6","hookRoutingEvents","$log","$state","RoutingVar","error","unfoundState","to","angular","7","factory","initError","scope","errors","message","undefined","details","errorMessage","data","statusText","status","errorCode","scopeObject","errorDetails","console","isObject","createError","$injector","pipTranslate","has","get","setTranslations","ENTERING","PROCESSING","LOADING","SAVING","pipError","initTransaction","transactions","id","operation","createTransaction","reset","transaction","empty","Date","getTime","err","set","10","IdentityRootVar","IdentityChangedEvent","IdentityService","setRootVar","identity","_setRootVar","_identity","_rootScope","prototype","defineProperty","value","$broadcast","enumerable","configurable","IdentityProvider","_service","$get","SessionRootVar","SessionOpenedEvent","SessionClosedEvent","SessionService","session","_session","open","fullReset","partialReset","close","oldSession","SessionProvider","provider","13","restrict","key1","key2","link","element","attrs","key","translate","text","html","directive","pipTranslateDirective","pipTranslateHtmlDirective","15","translateFilter","optionalTranslateFilter","__extends","d","b","constructor","hasOwnProperty","p","Object","create","__","en","ru","es","pt","de","fr","Translation","_language","use","language","translations","map","_translations","isUndefined","translateArray","keys","values","each","k","push","translateSet","keyProp","valueProp","translateObjects","items","item","translateWithPrefix","prefix","replace","toUpperCase","translateSetWithPrefix","translateSetWithPrefix2","TranslateService","translation","persist","localStorageService","_persist","_translation","_storage","save","LanguageRootVar","LanguageChangedEvent","TranslateProvider","_super","hash","result","charCodeAt","verification","Math","random","toString","substr","19","sample","maxLength","indexOf","substring","strRepeat","str","qty","sprintf","get_type","variable","slice","toLowerCase","args","_i","arguments","str_format","cache","parse","format","parse_tree","argv","arg","match","pad","pad_character","pad_length","node_type","output","tree_length","cursor","test","String","fromCharCode","parseInt","toExponential","parseFloat","toFixed","abs","charAt","str_repeat","join","fmt","arg_names","exec","_fmt","replacement_field","field_match","field_list","20","thisModule","resetPartial","resetFull","resetAll","full","partial","$reset","$partialReset","scrollTo","parentElement","childElement","animationDuration","setTimeout","$","position","modDiff","scrollTop","top","animate","getBrowserName","ua","navigator","userAgent","search","version","split","browser","getPlatform","isDesktop","isMobile","isCordova","getOS","osAll","osAndroid","isSupported","supported","edge","ie","firefox","chrome","getBrowserVersion","normalizeOne","tag","trim","compressOne","equal","tag1","tag2","normalizeAll","tags","isString","compressAll","entity","searchFields","field","hashTags","concat","uniq","normalize","compress","extract","25","DefaultEvents","TimerEvent","timeout","TimerService","$interval","_started","_events","_interval","addEvent","existingEvent","find","newEvent","startEvent","removeEvent","stopEvent","splice","clearEvents","stop","_this","interval","cancel","ex","start"],"mappings":"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","file":"pip-webui-services.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\n\r\nexport let CurrentState: any;\r\nexport let PreviousState: any;\r\n\r\nfunction captureStateTranslations($rootScope) {\r\n    \"ngInject\";\r\n\r\n    $rootScope.$on('$stateChangeSuccess',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            CurrentState = {\r\n                name: toState.name, \r\n                url: toState.url, \r\n                params: toParams\r\n            };\r\n\r\n            PreviousState = {\r\n                name: fromState.name, \r\n                url: fromState.url, \r\n                params: fromParams\r\n            };\r\n        }\r\n    );\r\n\r\n}\r\n\r\nfunction decorateBackStateService($delegate, $window) {\r\n    \"ngInject\";\r\n\r\n    $delegate.goBack = goBack;\r\n    $delegate.goBackAndSelect = goBackAndSelect;\r\n\r\n    return $delegate;\r\n    //////////////////////////////////////////////////\r\n\r\n    function goBack(): void {\r\n        $window.history.back()\r\n    }\r\n\r\n    function goBackAndSelect(params: any): void {\r\n        if (PreviousState != null \r\n            && PreviousState.name != null) {\r\n\r\n            let state = _.cloneDeep(PreviousState);\r\n\r\n            // Override selected parameters\r\n            state.params = _.extend(state.params, params);\r\n\r\n            $delegate.go(state.name, state.params);\r\n        } else {\r\n            $window.history.back();\r\n        }\r\n    }\r\n}\r\n\r\nfunction addBackStateDecorator($provide) {\r\n    $provide.decorator('$state', decorateBackStateService);\r\n}\r\n\r\nangular\r\n    .module('pipRouting.Back', [])\r\n    .config(addBackStateDecorator)\r\n    .run(captureStateTranslations);\r\n","'use strict';\r\n\r\nexport let RedirectedStates: any = {};\r\n\r\nfunction decorateRedirectStateProvider($delegate) {\r\n    \"ngInject\";\r\n\r\n    $delegate.redirect = redirect;\r\n\r\n    return $delegate;\r\n    /////////////////////////////////////////////\r\n\r\n    // Specify automatic redirect from one state to another\r\n    function redirect(fromState, toState) {\r\n        RedirectedStates[fromState] = toState;  \r\n        return this;\r\n    }\r\n}\r\n\r\nfunction addRedirectStateProviderDecorator($provide) {\r\n    \"ngInject\";\r\n\r\n    $provide.decorator('$state', decorateRedirectStateProvider);\r\n}\r\n\r\nfunction decorateRedirectStateService($delegate, $timeout) {\r\n    \"ngInject\";\r\n\r\n    $delegate.redirect = redirect;\r\n    \r\n    return $delegate;\r\n    ////////////////////////////////\r\n    \r\n    // Todo: Move this code directly to event handler?\r\n    // Todo: Nothing calls this code!!\r\n    function redirect(event, state, params) {\r\n        let toState = RedirectedStates[state.name];\r\n        if (_.isFunction(toState)) {\r\n            toState = toState(state.name, params);\r\n\r\n            if (_.isNull(toState))\r\n                throw new Error('Redirected toState cannot be null');\r\n        }\r\n\r\n        if (!!toState) {\r\n            $timeout(() => {\r\n                event.preventDefault();\r\n                $delegate.transitionTo(toState, params, {location: 'replace'});\r\n            });\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction addRedirectStateDecorator($provide) {\r\n    \"ngInject\";\r\n\r\n    $provide.decorator('$state', decorateRedirectStateService);\r\n}\r\n\r\nangular\r\n    .module('pipRouting.Redirect', ['ui.router'])\r\n    .config(addRedirectStateProviderDecorator)\r\n    .config(addRedirectStateDecorator);\r\n\r\n","'use strict';\r\n\r\nangular.module('pipRouting', [\r\n    'ui.router', 'pipRouting.Events', 'pipRouting.Back', 'pipRouting.Redirect'\r\n]);\r\n","'use strict';\r\n\r\nexport let RoutingVar: string = \"$routing\";\r\n\r\nfunction hookRoutingEvents($log, $rootScope, $state) {\r\n    \"ngInject\";\r\n\r\n    $rootScope.$on('$stateChangeStart',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            $rootScope[RoutingVar] = true;\r\n        }\r\n    );\r\n\r\n    $rootScope.$on('$stateChangeSuccess',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            // Unset routing variable to disable page transition\r\n            $rootScope[RoutingVar] = false;                \r\n        }\r\n    );\r\n\r\n    // Intercept route error\r\n    $rootScope.$on('$stateChangeError',\r\n        (event, toState, toParams, fromState, fromParams, error) => {\r\n            // Unset routing variable to disable page transition\r\n            $rootScope[RoutingVar] = false;\r\n\r\n            $log.error('Error while switching route to ' + toState.name);\r\n            $log.error(error);\r\n\r\n            console.error('Error while switching route to ' + toState.name);\r\n            console.error(error);\r\n        }\r\n    );\r\n\r\n    // Intercept route error\r\n    $rootScope.$on('$stateNotFound',\r\n        function(event, unfoundState, fromState, fromParams) {\r\n            event.preventDefault();\r\n\r\n            $rootScope[RoutingVar] = false;\r\n\r\n            // Todo: Move to errors\r\n            $state.go('errors_missing_route',  {\r\n                    unfoundState: unfoundState,\r\n                    fromState : {\r\n                        to: fromState ? fromState.name : '',\r\n                        fromParams: fromParams\r\n                    }\r\n                }\r\n            );\r\n        }\r\n    );\r\n\r\n}\r\n\r\nangular\r\n    .module('pipRouting.Events', [])\r\n    .run(hookRoutingEvents);\r\n\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipScope.Error', []);\r\n\r\n/*\r\n    * Error is designed to assist with error handling\r\n    * within different application scopes & controllers without overlap.\r\n    *\r\n    * A unique identification of the scope/controller is passed to the service\r\n    * when it is initialized to identify the error for that scope.\r\n    * */\r\nthisModule.factory('pipError',\r\n    function ($rootScope) {\r\n\r\n        // Initialize error scope\r\n        $rootScope.errors = {};\r\n\r\n        return createError;\r\n\r\n        //----------------------------\r\n\r\n        function initError(scope) {\r\n            $rootScope.errors[scope] = {\r\n                message: undefined,\r\n                code: undefined,\r\n                details: undefined\r\n            };\r\n        };\r\n\r\n        function errorMessage(error) {\r\n            if (_.isNull(error)) {\r\n                return null;\r\n            }\r\n\r\n            // Process regular messages\r\n            if (error.message) {\r\n                return error.message;\r\n            }\r\n\r\n            // Process server application errors\r\n            if (error.data) {\r\n                if (error.data.code) {\r\n                    // process server error codes here\r\n                    return 'ERROR_' + error.data.code;\r\n                }\r\n\r\n                if (error.data.message) {\r\n                    return error.data.message;\r\n                }\r\n            }\r\n\r\n            // Process standard HTTP errors\r\n            if (error.statusText) {\r\n                return error.statusText;\r\n            }\r\n\r\n            if (error.status) {\r\n                return 'ERROR_' + error.status;\r\n            }\r\n            \r\n            return error.data ? error.data : error;\r\n        };\r\n\r\n        function errorCode(error) {\r\n            if (_.isNull(error)) {\r\n                return null;\r\n            }\r\n\r\n            if (error.data && error.data.code) {\r\n                return error.data.code;\r\n            }\r\n\r\n            if (error.status) {\r\n                return error.status;\r\n            }\r\n            \r\n            return null;\r\n        };\r\n\r\n        function errorDetails(error) {\r\n            return error && error.data ? error.data : error;\r\n        };\r\n\r\n        function createError(scope, scopeObject) {\r\n            scope = scope || 'global';\r\n\r\n            var error = {\r\n                reset: function () {\r\n                    initError(scope);\r\n                },\r\n\r\n                empty: function() {\r\n                    var error = $rootScope.errors[scope];\r\n                    return _.isNull(error) || (_.isNull(error.message) && _.isNull(error.code));\r\n                },\r\n\r\n                get: function () {\r\n                    if ($rootScope.errors[scope]) {\r\n                        return $rootScope.errors[scope];\r\n                    }\r\n                    return '';\r\n                },\r\n\r\n                message: function () {\r\n                    if ($rootScope.errors[scope]) {\r\n                        return $rootScope.errors[scope].message;\r\n                    }\r\n                    return null;\r\n                },\r\n\r\n                code: function () {\r\n                    if ($rootScope.errors[scope]) {\r\n                        return $rootScope.errors[scope].code;\r\n                    }\r\n                    return null;\r\n                },\r\n\r\n                details: function () {\r\n                    if ($rootScope.errors[scope]) {\r\n                        return $rootScope.errors[scope].details;\r\n                    }\r\n                    return null;\r\n                },\r\n\r\n                set: function (error) {\r\n                    if (error) {\r\n                        //pipAssert.isObject(error, \"Setting error: error should be an object\");\r\n\r\n                        $rootScope.errors[scope] = {\r\n                            message: errorMessage(error),\r\n                            code: errorCode(error),\r\n                            details: errorDetails(error)\r\n                        };\r\n                        console.error($rootScope.errors[scope]);\r\n                    } else {\r\n                        initError(scope);\r\n                    }\r\n                }\r\n            };\r\n\r\n            // Assign error into scope\r\n            if (_.isObject(scopeObject)) scopeObject.error = error;\r\n\r\n            return error;\r\n        };\r\n    }\r\n);\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipScope.Transaction', ['pipTranslate']);\r\n\r\nthisModule.run(function($injector) {\r\n    var pipTranslate = $injector.has('pipTranslate') ? $injector.get('pipTranslate') : null;\r\n    if (pipTranslate) {\r\n        pipTranslate.setTranslations('en', {\r\n            'ENTERING': 'Entering...',\r\n            'PROCESSING': 'Processing...',\r\n            'LOADING': 'Loading...',\r\n            'SAVING': 'Saving...'\r\n        });\r\n\r\n        pipTranslate.setTranslations('ru', {\r\n            'ENTERING': 'Вход в систему...',\r\n            'PROCESSING': 'Обрабатывается...',\r\n            'LOADING': 'Загружается...',\r\n            'SAVING': 'Сохраняется...'\r\n        });   \r\n    }\r\n    \r\n});\r\n\r\n/*\r\n    * Transaction is designed to assist with transaction processing\r\n    * within different application scopes & controllers without overlap.\r\n    *\r\n    * A unique identification of the scope/controller is passed to the service\r\n    * when it is initialized to identify the error for that scope.\r\n    * \r\n    * Transaction is also integrated with Error service. So you don't need to double it\r\n    * */\r\nthisModule.factory('pipTransaction',\r\n    function ($rootScope, pipError) {\r\n\r\n        // Initialize transaction scope\r\n        $rootScope.transactions = {};\r\n\r\n        return createTransaction;\r\n\r\n        //---------------------------------\r\n\r\n        function initTransaction(scope) {\r\n            $rootScope.transactions[scope] = {\r\n                id: undefined,\r\n                operation: undefined\r\n            };\r\n        }\r\n        \r\n        function createTransaction(scope, scopeObject) {\r\n            scope = scope || 'global';\r\n\r\n            var error = pipError(scope);\r\n            var transaction = {\r\n                error: error,\r\n\r\n                reset: function () {\r\n                    initTransaction(\"\");\r\n                    error.reset();\r\n                },\r\n\r\n                busy: function() {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    return transaction != null && transaction.id;\r\n                },\r\n\r\n                failed: function() {\r\n                    return !error.empty();\r\n                },\r\n\r\n                aborted: function(id) {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    return _.isNull(transaction) || transaction.id != id;\r\n                },\r\n\r\n                get: function () {\r\n                    if (_.isNull($rootScope.transactions[scope])) {\r\n                        initTransaction(scope);\r\n                    }\r\n                    return $rootScope.transactions[scope];\r\n                },\r\n\r\n                id: function () {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    return transaction ? transaction.id : null;\r\n                },\r\n\r\n                operation: function () {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    return transaction ? transaction.operation : null;\r\n                },\r\n\r\n                errorMessage: function () {\r\n                    return error.message();\r\n                },\r\n\r\n                begin: function (operation) {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    // Transaction already in progress\r\n                    if (transaction != null && transaction.id) {\r\n                        return null;\r\n                    }                      \r\n\r\n                    transaction = $rootScope.transactions[scope] = {\r\n                        id: new Date().getTime(),\r\n                        operation: operation || 'PROCESSING'\r\n                    };\r\n                    error.reset();\r\n\r\n                    return transaction.id;\r\n                },\r\n\r\n                abort: function() {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    if (transaction) {\r\n                        transaction.id = null;\r\n                    }\r\n                    error.reset();\r\n                },\r\n\r\n                end: function (err) {\r\n                    if (err) error.set(err);\r\n                    else error.reset();\r\n\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    if (transaction != null) {\r\n                        transaction.id = null;\r\n                    }                      \r\n                }\r\n            };\r\n\r\n            if (_.isObject(scopeObject)) {\r\n                scopeObject.error = error;\r\n                scopeObject.transaction = transaction;\r\n            }\r\n\r\n            return transaction;\r\n        }\r\n    }\r\n);\r\n","﻿'use strict';\r\n\r\nangular.module('pipServices', [\r\n    'pipScope',\r\n    'pipTranslate',\r\n    'pipRouting',\r\n    'pipTimer',\r\n    'pipSession',\r\n    'pipIdentity',\r\n    'pipSystemInfo',\r\n    'pipFormat',\r\n    'pipScroll',\r\n    'pipPageReset',        \r\n    'pipTags'\r\n]);\r\n","'use strict';\r\n\r\nexport const IdentityRootVar = \"$identity\";\r\nexport const IdentityChangedEvent = \"pipIdentityChanged\";\r\n\r\nexport interface IIdentity {\r\n    id: string;\r\n    full_name: string;\r\n    details: string;\r\n    email: string;\r\n    photo_url: string;\r\n}\r\n\r\nexport interface IIdentityService {\r\n    identity: IIdentity;\r\n}\r\n\r\nexport interface IIdentityProvider extends ng.IServiceProvider {\r\n    setRootVar: boolean;\r\n    identity: IIdentity;\r\n}\r\n\r\nclass IdentityService implements IIdentityService {\r\n    private _identity: IIdentity;\r\n    private _setRootVar: boolean;\r\n    private _rootScope: ng.IRootScopeService;\r\n\r\n    public constructor(\r\n        setRootVar: boolean,\r\n        identity: IIdentity,\r\n        $rootScope: ng.IRootScopeService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._identity = identity;\r\n        this._rootScope = $rootScope;\r\n\r\n        this.setRootVar();\r\n    }\r\n\r\n    private setRootVar(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[IdentityRootVar] = this._identity;\r\n    }\r\n\r\n    public get identity(): IIdentity {\r\n        return this._identity;\r\n    }\r\n\r\n    public set identity(value: IIdentity) {\r\n        this._identity = value;\r\n        this.setRootVar();\r\n        this._rootScope.$broadcast(IdentityChangedEvent, this._identity);\r\n    }\r\n}\r\n\r\nclass IdentityProvider implements IdentityProvider {\r\n    private _setRootVar = true;\r\n    private _identity: IIdentity = null;\r\n    private _service: IIdentityService = null;\r\n\r\n    public constructor() { }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get identity(): any {\r\n        return this._identity;  \r\n    }\r\n\r\n    public set identity(value: any) {\r\n        this._identity = value;\r\n    }\r\n\r\n    public $get($rootScope: ng.IRootScopeService): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null)\r\n            this._service = new IdentityService(this._setRootVar, this._identity, $rootScope);\r\n\r\n        return this._service;\r\n    }\r\n\r\n}\r\n\r\nangular\r\n    .module('pipIdentity', [])\r\n    .provider('pipIdentity', IdentityProvider);\r\n","'use strict';\r\n\r\nexport const SessionRootVar = \"$session\";\r\nexport const SessionOpenedEvent = \"pipSessionOpened\";\r\nexport const SessionClosedEvent = \"pipSessionClosed\";\r\n\r\nexport interface ISessionService {\r\n    session: any;\r\n    isOpened: boolean;\r\n\r\n    open(session: any): void;\r\n    close(): void;\r\n}\r\n\r\nexport interface ISessionProvider extends ng.IServiceProvider {\r\n    setRootVar: boolean;\r\n    session: any;\r\n}\r\n\r\nclass SessionService implements ISessionService {\r\n    private _setRootVar: boolean;\r\n    private _session: any;\r\n    private _rootScope: ng.IRootScopeService;\r\n\r\n    public constructor(\r\n        setRootVar: boolean, \r\n        session: any, \r\n        $rootScope: ng.IRootScopeService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._session = session;\r\n        this._rootScope = $rootScope;\r\n\r\n        this.setRootVar();\r\n    }\r\n    \r\n    private setRootVar(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[SessionRootVar] = this._session;\r\n    }\r\n\r\n    public get session(): any {\r\n        return this._session;\r\n    }\r\n\r\n    public get isOpened(): boolean {\r\n        return this._session != null;\r\n    }\r\n\r\n    public open(session: any, fullReset: boolean = false, partialReset: boolean = false) {\r\n        if (session == null)\r\n            throw new Error(\"Session cannot be null\");\r\n\r\n        this._session = session;\r\n        this.setRootVar();\r\n        this._rootScope.$broadcast(SessionOpenedEvent, session);\r\n    }\r\n\r\n    public close(fullReset: boolean = false, partialReset: boolean = false) {\r\n        let oldSession = this._session;\r\n\r\n        this._session = null;\r\n        this.setRootVar();\r\n        this._rootScope.$broadcast(SessionClosedEvent, oldSession);\r\n    }\r\n}\r\n\r\nclass SessionProvider implements ISessionProvider {\r\n    private _setRootVar = true;\r\n    private _session: any = null;\r\n    private _service: ISessionService = null;\r\n\r\n    public constructor() { }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get session(): any {\r\n        return this._session;  \r\n    }\r\n\r\n    public set session(value: any) {\r\n        this._session = value;\r\n    }\r\n\r\n    public $get($rootScope: ng.IRootScopeService): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null)\r\n            this._service = new SessionService(this._setRootVar, this._session, $rootScope);\r\n\r\n        return this._service;\r\n    }\r\n}\r\n\r\nangular.module('pipSession', ['pipPageReset'])\r\n    .provider('pipSession', SessionProvider); \r\n","'use strict';\r\n\r\nangular.module('pipTranslate', [\r\n    'LocalStorageModule', 'pipTranslate.Service', 'pipTranslate.Filter', 'pipTranslate.Directive'\r\n]);\r\n","'use strict';\r\n\r\nfunction pipTranslateDirective(pipTranslate): ng.IDirective {\r\n    \"ngInject\";\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            key1: '@pipTranslate',\r\n            key2: '@key'\r\n        },\r\n        link: (scope: any, element: any, attrs: any) => {\r\n            let key = scope.key1 || scope.key2;\r\n            let value = pipTranslate.translate(key);\r\n            element.text(value);\r\n        }\r\n    };\r\n}\r\n\r\nfunction pipTranslateHtmlDirective(pipTranslate): ng.IDirective {\r\n    \"ngInject\";\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            key1: '@pipTranslateHtml',\r\n            key2: '@key'\r\n        },\r\n        link: (scope: any, element: any, attrs: any) => {\r\n            let key = scope.key1 || scope.key2;\r\n            let value = pipTranslate.translate(key);\r\n            element.html(value);\r\n        }\r\n    };\r\n}\r\n\r\nangular\r\n    .module('pipTranslate.Directive', [])\r\n    .directive('pipTranslate', pipTranslateDirective)\r\n    .directive('pipTranslateHtml', pipTranslateHtmlDirective);\r\n","'use strict';\r\n\r\nfunction translateFilter(pipTranslate) {\r\n    \"ngInject\";\r\n\r\n    return function (key) {\r\n        return pipTranslate.translate(key) || key;\r\n    }\r\n}\r\n\r\nfunction optionalTranslateFilter($injector) {\r\n    \"ngInject\";\r\n\r\n    let pipTranslate = $injector.has('pipTranslate') \r\n        ? $injector.get('pipTranslate') : null;\r\n\r\n    return function (key) {\r\n        return pipTranslate  ? pipTranslate.translate(key) || key : key;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTranslate.Filter', [])\r\n    .filter('translate', translateFilter);\r\n","﻿'use strict';\r\n\r\nexport const LanguageRootVar = \"$language\";\r\nexport const LanguageChangedEvent = \"pipLanguageChanged\";    \r\n\r\nexport interface ITranslateService {\r\n    language: string;\r\n\r\n    use(language: string): string;\r\n    setTranslations(language: string, translations: any): void;\r\n\r\n    translate(key: string): string;\r\n    translateArray(keys: string[]): string[];\r\n    translateSet(keys: string[], keyProp: string, valueProp: string): any[];\r\n    translateObjects(items: any[], keyProp: string, valueProp: string): any[];\r\n    translateWithPrefix(prefix: string, key: string);\r\n    translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string);\r\n    translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string);\r\n}\r\n\r\nexport interface ITranslateProvider extends ITranslateService, ng.IServiceProvider {\r\n\r\n}\r\n\r\nclass Translation implements ITranslateService {\r\n    protected _language = 'en';\r\n    protected _translations = {\r\n        en: {\r\n            'en': 'English',\r\n            'ru': 'Russian',\r\n            'es': 'Spanish',\r\n            'pt': 'Portuguese',\r\n            'de': 'German',\r\n            'fr': 'French'\r\n        },\r\n        ru: {\r\n            'en': 'Английский',\r\n            'ru': 'Русский',\r\n            'es': 'Испанский',\r\n            'pt': 'Португальский',\r\n            'de': 'Немецкий',\r\n            'fr': 'Французский'\r\n        }\r\n    };\r\n\r\n    public constructor() {}\r\n\r\n    public get language(): string { return this._language; }\r\n    public set language(value: string) { this._language = value; }\r\n\r\n    public use(language: string): string {\r\n        if (language != null)\r\n            this._language = language;\r\n        return this._language;\r\n    }\r\n\r\n    // Set translation strings for specific language\r\n    public setTranslations(language: string, translations: any): void {\r\n        let map = this._translations[language] || {};\r\n        this._translations[language] = _.extend(map, translations);\r\n    }\r\n\r\n    // Translate a string by key using set language\r\n    public translate(key: string): string {\r\n        if (_.isNull(key) || _.isUndefined(key)) return '';\r\n\r\n        let translations = this._translations[this._language] || {};\r\n        return translations[key] || key;\r\n    }\r\n\r\n    // Translate an array of strings\r\n    public translateArray(keys: string[]): string[] {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (k) {\r\n            let key = k || '';\r\n            values.push(translations[key] || key);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate an array of strings into array of objects (set)\r\n    public translateSet(keys: string[], keyProp: string, valueProp: string): any[] {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n\r\n        let values: any[] = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {};\r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[key] || key;\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate a collection of objects\r\n    public translateObjects(items: any[], keyProp: string, valueProp: string): any[] {\r\n        if (_.isNull(items) || items.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'name';\r\n        valueProp = valueProp || 'nameLocal';\r\n\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(items, function (item) {\r\n            let key = item[keyProp] || '';\r\n\r\n            item[valueProp] = translations[key] || key;\r\n        });\r\n\r\n        return items;\r\n    }\r\n\r\n    // Translate a string by key  with prefix using set language todo\r\n    public translateWithPrefix(prefix: string, key: string) {\r\n        prefix = prefix ? prefix + '_' : '';\r\n        key = (prefix + key).replace(/ /g, '_').toUpperCase();\r\n        if (key == null) return '';\r\n        let translations = this._translations[this._language] || {};\r\n        return translations[key] || key;\r\n    };\r\n\r\n    public translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() : '';\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {}; \r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[prefix + '_' + key] || key;\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate an array of strings, apply uppercase and replace ' ' => '_'\r\n    public translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n        prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() + '_': '';\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {};\r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[prefix + key.replace(/ /g, '_').toUpperCase()]\r\n                || (prefix + key.replace(/ /g, '_').toUpperCase());\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n}\r\n\r\nclass TranslateService {\r\n    private _translation: Translation;\r\n    private _setRootVar: boolean;\r\n    private _persist: boolean;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _storage: any;\r\n\r\n    public constructor(\r\n        translation: Translation,\r\n        setRootVar: boolean,\r\n        persist: boolean,\r\n        $rootScope: ng.IRootScopeService,\r\n        localStorageService: any\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._persist = persist;\r\n        this._translation = translation;\r\n        this._rootScope = $rootScope;\r\n        this._storage = localStorageService;\r\n\r\n        if (this._persist) {\r\n            this._translation.language = localStorageService.get('language') \r\n                || this._translation.language;\r\n        }\r\n\r\n        this.save();\r\n    }\r\n\r\n    private save(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[LanguageRootVar] = this._translation.language;\r\n\r\n        if (this._persist)\r\n            this._storage.set('language', this._translation.language);\r\n    }\r\n\r\n    public get language(): string {\r\n        return this._translation.language;\r\n    }\r\n\r\n    public set language(value: string) {\r\n        if (value != this._translation.language) {\r\n            this._translation.language = value;\r\n            \r\n            this.save();                \r\n            this._rootScope.$broadcast(LanguageChangedEvent, value);\r\n        }\r\n    }\r\n\r\n    public use(language: string): string {\r\n        if (language != null)\r\n            this.language = language;\r\n        return this.language;\r\n    }\r\n\r\n    public setTranslations(language: string, translations: any): void {\r\n        return this._translation.setTranslations(language, translations);\r\n    }\r\n\r\n    public translate(key: string): string {\r\n        return this._translation.translate(key);\r\n    }\r\n\r\n    public translateArray(keys: string[]): string[] {\r\n        return this._translation.translateArray(keys);\r\n    }\r\n    \r\n    public translateSet(keys: string[], keyProp: string, valueProp: string): any[] {\r\n        return this._translation.translateSet(keys, keyProp, valueProp);\r\n    }\r\n\r\n    public translateObjects(items: any[], keyProp: string, valueProp: string): any[] {\r\n        return this._translation.translateObjects(items, keyProp, valueProp);\r\n    }\r\n\r\n    public translateWithPrefix(prefix: string, key: string) {\r\n        return this._translation.translateWithPrefix(prefix, key);\r\n    }\r\n\r\n    public translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        return this._translation.translateSetWithPrefix(prefix, keys, keyProp, valueProp);\r\n    }\r\n\r\n    public translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        return this._translation.translateSetWithPrefix2(prefix, keys, keyProp, valueProp);\r\n    }\r\n}\r\n\r\nclass TranslateProvider extends Translation implements ITranslateProvider {\r\n    private _translation: Translation;\r\n    private _setRootVar: boolean;\r\n    private _persist: boolean;\r\n    private _service: TranslateService;\r\n    \r\n    public constructor() {\r\n        super();\r\n    }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get persist(): boolean {\r\n        return this._persist;  \r\n    }\r\n\r\n    public set persist(value: boolean) {\r\n        this._persist = !!value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService, \r\n        localStorageService: any\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null) \r\n            this._service = new TranslateService(this, this._setRootVar, this._persist, $rootScope, localStorageService);\r\n        return this._service;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTranslate.Service', [])\r\n    .provider('pipTranslate', TranslateProvider);\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipCodes', []);\r\n\r\nthisModule.factory('pipCodes', function () {\r\n    \r\n    return {\r\n        hash: hash,\r\n        verification: verification\r\n    }\r\n\r\n    // Simple version of string hashcode\r\n    function hash(value) {\r\n        if (value == null) return 0;\r\n        var result = 0;\r\n        for (var i = 0; i < value.length; i++) {\r\n            result += value.charCodeAt(i);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Generates random big number for verification codes\r\n    function verification() {\r\n        return Math.random().toString(36).substr(2, 10).toUpperCase(); // remove `0.`\r\n    }\r\n\r\n});\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipFormat', []);\r\n\r\nthisModule.factory('pipFormat', function () {\r\n\r\n    // Creates a sample line from a text\r\n    function sample(value, maxLength) {\r\n        if (!value || value == '') return '';\r\n\r\n        var length = value.indexOf('\\n');\r\n        length = length >= 0 ? length : value.length;\r\n        length = length < maxLength ? value.length : maxLength;\r\n\r\n        return value.substring(0, length);\r\n    }\r\n\r\n    function strRepeat(str, qty) {\r\n        if (qty < 1) return '';\r\n        var result = '';\r\n        while (qty > 0) {\r\n            if (qty & 1) result += str;\r\n            qty >>= 1, str += str;\r\n        }\r\n        return result;\r\n    }\r\n    \r\n    var sprintf = (function sprintf(...args: any[]) {\r\n        function get_type(variable) {\r\n            return toString.call(variable).slice(8, -1).toLowerCase();\r\n        }\r\n\r\n        var str_repeat = strRepeat;\r\n\r\n        var str_format: any = function() {\r\n            if (!str_format.cache.hasOwnProperty(arguments[0])) {\r\n                str_format.cache[arguments[0]] = str_format.parse(arguments[0]);\r\n            }\r\n            return str_format.format.call(null, str_format.cache[arguments[0]], arguments);\r\n        };\r\n\r\n        str_format.format = function(parse_tree, argv) {\r\n            var cursor = 1, tree_length = parse_tree.length, node_type = '', arg, output = [], i, k, match, pad, pad_character, pad_length;\r\n            for (i = 0; i < tree_length; i++) {\r\n                node_type = get_type(parse_tree[i]);\r\n                if (node_type === 'string') {\r\n                    output.push(parse_tree[i]);\r\n                }\r\n                else if (node_type === 'array') {\r\n                    match = parse_tree[i]; // convenience purposes only\r\n                    if (match[2]) { // keyword argument\r\n                        arg = argv[cursor];\r\n                        for (k = 0; k < match[2].length; k++) {\r\n                            if (!arg.hasOwnProperty(match[2][k])) {\r\n                                throw new Error(sprintf('[_.sprintf] property \"%s\" does not exist', match[2][k]));\r\n                            }\r\n                            arg = arg[match[2][k]];\r\n                        }\r\n                    } else if (match[1]) { // positional argument (explicit)\r\n                        arg = argv[match[1]];\r\n                    }\r\n                    else { // positional argument (implicit)\r\n                        arg = argv[cursor++];\r\n                    }\r\n\r\n                    if (/[^s]/.test(match[8]) && (get_type(arg) != 'number')) {\r\n                        throw new Error(sprintf('[_.sprintf] expecting number but found %s', get_type(arg)));\r\n                    }\r\n                    switch (match[8]) {\r\n                        case 'b': arg = arg.toString(2); break;\r\n                        case 'c': arg = String.fromCharCode(arg); break;\r\n                        case 'd': arg = parseInt(arg, 10); break;\r\n                        case 'e': arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential(); break;\r\n                        case 'f': arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg); break;\r\n                        case 'o': arg = arg.toString(8); break;\r\n                        case 's': arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg); break;\r\n                        case 'u': arg = Math.abs(arg); break;\r\n                        case 'x': arg = arg.toString(16); break;\r\n                        case 'X': arg = arg.toString(16).toUpperCase(); break;\r\n                    }\r\n                    arg = (/[def]/.test(match[8]) && match[3] && arg >= 0 ? '+'+ arg : arg);\r\n                    pad_character = match[4] ? match[4] == '0' ? '0' : match[4].charAt(1) : ' ';\r\n                    pad_length = match[6] - String(arg).length;\r\n                    pad = match[6] ? str_repeat(pad_character, pad_length) : '';\r\n                    output.push(match[5] ? arg + pad : pad + arg);\r\n                }\r\n            }\r\n            return output.join('');\r\n        };\r\n\r\n        str_format.cache = {};\r\n\r\n        str_format.parse = function(fmt) {\r\n            var _fmt = fmt, match = [], parse_tree = [], arg_names = 0;\r\n            while (_fmt) {\r\n                if ((match = /^[^\\x25]+/.exec(_fmt)) !== null) {\r\n                    parse_tree.push(match[0]);\r\n                }\r\n                else if ((match = /^\\x25{2}/.exec(_fmt)) !== null) {\r\n                    parse_tree.push('%');\r\n                }\r\n                else if ((match = /^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt)) !== null) {\r\n                    if (match[2]) {\r\n                        arg_names |= 1;\r\n                        var field_list = [], replacement_field = match[2], field_match = [];\r\n                        if ((field_match = /^([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                            field_list.push(field_match[1]);\r\n                            while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {\r\n                                if ((field_match = /^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                                    field_list.push(field_match[1]);\r\n                                }\r\n                                else if ((field_match = /^\\[(\\d+)\\]/.exec(replacement_field)) !== null) {\r\n                                    field_list.push(field_match[1]);\r\n                                }\r\n                                else {\r\n                                    throw new Error('[_.sprintf] huh?');\r\n                                }\r\n                            }\r\n                        }\r\n                        else {\r\n                            throw new Error('[_.sprintf] huh?');\r\n                        }\r\n                        match[2] = field_list;\r\n                    }\r\n                    else {\r\n                        arg_names |= 2;\r\n                    }\r\n                    if (arg_names === 3) {\r\n                        throw new Error('[_.sprintf] mixing positional and named placeholders is not (yet) supported');\r\n                    }\r\n                    parse_tree.push(match);\r\n                }\r\n                else {\r\n                    throw new Error('[_.sprintf] huh?');\r\n                }\r\n                _fmt = _fmt.substring(match[0].length);\r\n            }\r\n            return parse_tree;\r\n        };\r\n\r\n        return str_format;\r\n    })();\r\n\r\n    return {\r\n        sprintf: sprintf,\r\n        format: sprintf,\r\n        sample: sample\r\n    };\r\n});\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipPageReset', []);\r\n\r\nthisModule.factory('pipPageReset', function($rootScope, $timeout) {\r\n\r\n    $rootScope.$on('pipResetPage', resetAll);\r\n\r\n    return {\r\n        resetPartial: resetPartial,\r\n        resetFull: resetFull,\r\n        resetAll: resetAll,\r\n        reset: reset\r\n    };\r\n\r\n    //------------------------------------------\r\n\r\n    function resetPartial() {\r\n        reset(false, true);\r\n    }\r\n\r\n    function resetFull() {\r\n        reset(true, false);\r\n    }\r\n\r\n    function resetAll() {\r\n        reset(true, true);\r\n    }\r\n\r\n    function reset(full, partial) {\r\n        full = full !== undefined ? !!full : true;\r\n        partial = partial !== undefined ? !!partial : true;\r\n\r\n        if (full || partial) {\r\n            $rootScope.$reset = full;\r\n            $rootScope.$partialReset = partial;\r\n            $timeout(function() {\r\n                $rootScope.$reset = false;\r\n                $rootScope.$partialReset = false;\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n});\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipScroll', []);\r\n\r\nthisModule.factory('pipScroll', function () {\r\n    return {\r\n        scrollTo: scrollTo\r\n    };\r\n    \r\n    //-------------------------------------\r\n\r\n    function scrollTo(parentElement, childElement, animationDuration) {\r\n        if(!parentElement || !childElement) return;\r\n        if (animationDuration == undefined) animationDuration = 300;\r\n\r\n        setTimeout(function () {\r\n            if (!$(childElement).position()) return;\r\n            var modDiff= Math.abs($(parentElement).scrollTop() - $(childElement).position().top);\r\n            if (modDiff < 20) return;\r\n            var scrollTo = $(parentElement).scrollTop() + ($(childElement).position().top - 20);\r\n            if (animationDuration > 0)\r\n                $(parentElement).animate({\r\n                    scrollTop: scrollTo + 'px'\r\n                }, animationDuration);\r\n        }, 100);\r\n    }\r\n\r\n});\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipSystemInfo', []);\r\n\r\nthisModule.factory('pipSystemInfo', function ($rootScope, $window) {\r\n\r\n    return {\r\n        getBrowserName: getBrowserName,\r\n        getBrowserVersion: getBrowserVersion,\r\n        getPlatform: getPlatform,\r\n        isDesktop: isDesktop,\r\n        isMobile: isMobile,\r\n        isCordova: isCordova,\r\n        getOS: getOS,            \r\n        isSupported: isSupported\r\n    };\r\n\r\n    // todo add support for iPhone\r\n    function getBrowserName() {\r\n        var ua = $window.navigator.userAgent;\r\n\r\n        if (ua.search(/Edge/) > -1) return \"edge\";\r\n        if (ua.search(/MSIE/) > -1) return \"ie\";\r\n        if (ua.search(/Trident/) > -1) return \"ie\";\r\n        if (ua.search(/Firefox/) > -1) return \"firefox\";\r\n        if (ua.search(/Opera/) > -1) return \"opera\";\r\n        if (ua.search(/OPR/) > -1) return \"opera\";\r\n        if (ua.search(/YaBrowser/) > -1) return \"yabrowser\";\r\n        if (ua.search(/Chrome/) > -1) return \"chrome\";\r\n        if (ua.search(/Safari/) > -1) return \"safari\";\r\n        if (ua.search(/Maxthon/) > -1) return \"maxthon\";\r\n        \r\n        return \"unknown\";\r\n    }\r\n\r\n    function getBrowserVersion() {\r\n        var browser, version;\r\n        var ua = $window.navigator.userAgent;\r\n\r\n        browser = getBrowserName();\r\n\r\n        switch (browser) {\r\n            case \"edge\":\r\n                version = (ua.split(\"Edge\")[1]).split(\"/\")[1];\r\n                break;\r\n            case \"ie\":\r\n                version = (ua.split(\"MSIE \")[1]).split(\";\")[0];\r\n                break;\r\n            case \"ie11\":\r\n                browser = \"ie\";\r\n                version = (ua.split(\"; rv:\")[1]).split(\")\")[0];\r\n                break;\r\n            case \"firefox\":\r\n                version = ua.split(\"Firefox/\")[1];\r\n                break;\r\n            case \"opera\":\r\n                version = ua.split(\"Version/\")[1];\r\n                break;\r\n            case \"operaWebkit\":\r\n                version = ua.split(\"OPR/\")[1];\r\n                break;\r\n            case \"yabrowser\":\r\n                version = (ua.split(\"YaBrowser/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"chrome\":\r\n                version = (ua.split(\"Chrome/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"safari\":\r\n                version = (ua.split(\"Version/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"maxthon\":\r\n                version = ua.split(\"Maxthon/\")[1];\r\n                break;\r\n        }\r\n\r\n        return version;\r\n    }\r\n    \r\n    function getPlatform() {\r\n        var ua = $window.navigator.userAgent;\r\n\r\n        if (/iphone|ipad|ipod|android|blackberry|mini|windows\\sce|palm/i.test(ua.toLowerCase())) \r\n            return 'mobile';\r\n\r\n        return 'desktop';\r\n    }\r\n\r\n    function isDesktop() {\r\n        return getPlatform() == 'desktop';\r\n    }\r\n\r\n    function isMobile() {\r\n        return getPlatform() == 'mobile';\r\n    }\r\n\r\n    // Todo: complete implementation\r\n    function isCordova() {\r\n        return null;\r\n    }\r\n\r\n    function getOS() {\r\n        var ua = $window.navigator.userAgent;\r\n\r\n        try {\r\n            var osAll = (/(windows|mac|android|linux|blackberry|sunos|solaris|iphone)/.exec(ua.toLowerCase()) || [ua])[0].replace('sunos', 'solaris'),\r\n            osAndroid = (/(android)/.exec(ua.toLowerCase()) || '');\r\n            return osAndroid && (osAndroid == 'android' || (osAndroid[0] == 'android')) ? 'android' : osAll;\r\n        } catch (err) {\r\n            return 'unknown'\r\n        }\r\n    }\r\n\r\n    // Todo: Move to errors\r\n    function isSupported(supported) {\r\n        if (!supported) supported = {\r\n            edge: 11,\r\n            ie: 11,\r\n            firefox: 43, //4, for testing\r\n            opera: 35,\r\n            chrome: 47\r\n        };\r\n\r\n        var browser = getBrowserName();\r\n        var version = getBrowserVersion();\r\n        version = version.split(\".\")[0]\r\n\r\n        if (browser && supported[browser] && version >= supported[browser]) \r\n            return true;\r\n\r\n        return true;\r\n    };\r\n\r\n});\r\n\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipTags', []);\r\n\r\nthisModule.factory('pipTags', function () {\r\n        \r\n    return {\r\n        equal: equal,\r\n        normalizeOne: normalizeOne,\r\n        normalizeAll: normalizeAll,\r\n        normalize: normalizeAll,\r\n        compressOne: compressOne,\r\n        compressAll: compressAll,\r\n        compress: compressAll,\r\n        extract: extract\r\n    };\r\n\r\n    //------------------------------\r\n\r\n    function normalizeOne(tag) {\r\n        return tag \r\n            ? _.trim(tag.replace(/(_|#)+/g, ' '))\r\n            : null;\r\n    }\r\n\r\n    function compressOne(tag) {\r\n        return tag\r\n            ? tag.replace(/( |_|#)/g, '').toLowerCase()\r\n            : null;\r\n    }\r\n\r\n    function equal(tag1, tag2) {\r\n        if (tag1 == null && tag2 == null)\r\n            return true;\r\n        if (tag1 == null || tag2 == null)\r\n            return false;\r\n        return compressOne(tag1) == compressOne(tag2);\r\n    }\r\n\r\n    function normalizeAll(tags) {\r\n        if (_.isString(tags)) {\r\n            tags = tags.split(/( |,|;)+/);\r\n        }\r\n\r\n        tags = _.map(tags, function (tag) {\r\n            return normalizeOne(tag);\r\n        });\r\n\r\n        return tags;\r\n    }\r\n\r\n    function compressAll(tags) {\r\n        if (_.isString(tags))\r\n            tags = tags.split(/( |,|;)+/);\r\n\r\n        tags = _.map(tags, function (tag) {\r\n            return compressOne(tag);\r\n        });\r\n\r\n        return tags;\r\n    };\r\n\r\n    function extract(entity, searchFields) {\r\n        var tags = normalizeAll(entity.tags);\r\n\r\n        _.each(searchFields, function (field) {\r\n            var text = entity[field] || '';\r\n\r\n            if (text != '') {\r\n                var hashTags = text.match(/#\\w+/g);\r\n                tags = tags.concat(normalizeAll(hashTags));\r\n            }\r\n        });\r\n\r\n        return _.uniq(tags);\r\n    }\r\n});\r\n","'use strict';\r\n\r\nexport interface ITimerService {\r\n    isStarted: boolean;\r\n\r\n    addEvent(event: string, timeout: number): void;\r\n    removeEvent(event: string): void;\r\n    clearEvents(): void;\r\n\r\n    start(): void;\r\n    stop(): void;\r\n}\r\n\r\nclass TimerEvent {\r\n    event: string;\r\n    timeout: number;\r\n    interval: any;\r\n}\r\n\r\nlet DefaultEvents: TimerEvent[] = [\r\n    <TimerEvent> { event: 'pipAutoPullChanges', timeout: 60000 }, // 1 min\r\n    <TimerEvent> { event: 'pipAutoUpdatePage', timeout: 15000 }, // 15 sec\r\n    <TimerEvent> { event: 'pipAutoUpdateCollection', timeout: 300000 } // 5 min\r\n]\r\n\r\nclass TimerService {\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _interval: ng.IIntervalService;        \r\n    private _started = false;\r\n    private _events: TimerEvent[] = _.cloneDeep(DefaultEvents);\r\n\r\n    public constructor($rootScope, $interval) {\r\n        this._rootScope = $rootScope;\r\n        this._interval = $interval;\r\n    }\r\n\r\n    public get isStarted() {\r\n        return this._started;\r\n    }\r\n\r\n    public addEvent(event: string, timeout: number): void {\r\n        var existingEvent = _.find(this._events, (e) => e.event == event);\r\n        if (existingEvent != null) return;\r\n\r\n        let newEvent = <TimerEvent> {\r\n            event: event,\r\n            timeout: timeout\r\n        };\r\n        this._events.push(newEvent);\r\n\r\n        if (this._started)\r\n            this.startEvent(newEvent);\r\n    }\r\n\r\n    public removeEvent(event: string): void {\r\n        for (let i = this._events.length - 1; i >= 0; i--) {\r\n            let existingEvent = this._events[i];\r\n            if (existingEvent.event == event) {\r\n                this.stopEvent(existingEvent);\r\n                this._events.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    public clearEvents(): void {\r\n        this.stop();\r\n        this._events = [];\r\n    }\r\n\r\n    private startEvent(event: TimerEvent): void {\r\n        event.interval = this._interval(\r\n            () => { this._rootScope.$broadcast(event.event) },\r\n            event.timeout\r\n        )\r\n    }\r\n\r\n    private stopEvent(event: TimerEvent): void {\r\n        if (event.interval != null) {\r\n            try {\r\n                this._interval.cancel(event.interval);\r\n            } catch (ex) {\r\n                // Do nothing\r\n            }\r\n            event.interval = null;\r\n        }\r\n    }\r\n\r\n    public start(): void {\r\n        if (this._started) return;\r\n\r\n        _.each(this._events, (event) => {\r\n            this.startEvent(event);\r\n        });\r\n\r\n        this._started = true;\r\n    }\r\n\r\n    public stop(): void {\r\n        _.each(this._events, (event) => {\r\n            this.stopEvent(event);\r\n        });\r\n\r\n        this._started = false;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTimer', [])\r\n    .service('pipTimer', TimerService);\r\n"]}