{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","src/index.ts","src/routing/BackDecorator.ts","src/routing/RedirectDecorator.ts","src/routing/RoutingEvents.ts","src/routing/index.ts","src/session/IdentityService.ts","src/session/SessionService.ts","src/session/index.ts","src/transactions/Transaction.ts","src/transactions/TransactionError.ts","src/transactions/TransactionService.ts","src/transactions/TransactionStrings.ts","src/transactions/index.ts","src/translate/TranslateDirective.ts","src/translate/TranslateFilter.ts","src/translate/TranslateService.ts","src/translate/Translation.ts","src/translate/index.ts","src/utilities/Codes.ts","src/utilities/Format.ts","src/utilities/PageResetService.ts","src/utilities/ScrollService.ts","src/utilities/SystemInfo.ts","src/utilities/Tags.ts","src/utilities/TimerService.ts","src/utilities/index.ts"],"names":["f","exports","module","define","amd","g","window","global","self","this","pip","services","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","angular","__export","captureStateTranslations","$rootScope","$on","event","toState","toParams","fromState","fromParams","CurrentState","name","url","params","PreviousState","decorateBackStateService","$delegate","$window","goBack","history","back","goBackAndSelect","state","_","cloneDeep","extend","go","addBackStateDecorator","$provide","decorator","$inject","config","run","3","decorateRedirectStateProvider","redirect","RedirectedStates","addRedirectStateProviderDecorator","$timeout","isNull","preventDefault","transitionTo","location","addRedirectStateDecorator","decorateRedirectStateService","4","hookRoutingEvents","$log","$state","RoutingVar","error","unfoundState","to","5","m","./RedirectDecorator","./RoutingEvents","6","IdentityRootVar","IdentityChangedEvent","IdentityService","setRootVar","identity","_setRootVar","_identity","_rootScope","_log","prototype","value","$emit","debug","id","full_name","enumerable","configurable","IdentityProvider","_service","get","set","$get","SessionRootVar","SessionOpenedEvent","SessionClosedEvent","SessionService","session","_session","defineProperty","isOpened","open","fullReset","partialReset","close","oldSession","SessionProvider","provider","8","p","hasOwnProperty","./SessionService","9","Transaction","scope","_scope","_id","_operation","_progress","_error","message","reset","busy","failed","empty","aborted","begin","operation","Date","getTime","toString","update","progress","Math","max","abort","end","decode","10","TransactionError","details","cause","stack_trace","data","statusText","status","TransactionService","_transactions","create","transaction","Transaction_1","12","configureTransactionStrings","$injector","has","setTranslations","ENTERING","PROCESSING","LOADING","SAVING","pipTranslate","13","./TransactionError","./TransactionService","./TransactionStrings","14","restrict","key1","key2","link","element","attrs","key","translate","text","html","directive","translateDirective","translateHtmlDirective","translateFilter","filter","__extends","d","b","__","constructor","Object","LanguageRootVar","LanguageChangedEvent","TranslateService","translation","persist","_persist","_translation","_window","localStorage","language","getItem","save","setItem","PageResetService_1","ResetPageEvent","use","translations","translateArray","keys","translateSet","keyProp","valueProp","translateObjects","items","translateWithPrefix","prefix","translateSetWithPrefix","translateSetWithPrefix2","_super","TranslateProvider","Translation","./Translation","17","en","ru","es","pt","de","fr","_language","map","_translations","isUndefined","values","each","k","push","item","replace","toUpperCase","18","./TranslateFilter","./TranslateService","19","Codes","hash","result","charCodeAt","verification","random","substr","20","Format","cache","sample","maxLength","indexOf","substring","strRepeat","str","qty","getType","variable","slice","toLowerCase","parseFormat","fmt","match","parse_tree","arg_names","exec","_fmt","field_list","replacement_field","field_match","format","argv","tree_length","output","node_type","arg","cursor","sprintf","test","String","fromCharCode","parseInt","toExponential","parseFloat","toFixed","abs","pad_character","charAt","pad_length","pad","join","_i","arguments","args","21","hookResetEvents","pipPageReset","ResetAreaEvent","area","resetArea","ResetRootVar","ResetAreaRootVar","PageResetService","_timeout","performReset","_this","scrollTo","parentElement","childElement","animationDuration","undefined","setTimeout","$","position","modDiff","scrollTop","top","animate","ScrollService","SystemInfo","ua","navigator","userAgent","search","browserName","browser","version","split","osAll","osAndroid","err","isDesktop","platform","isMobile","isCordova","isSupported","supported","edge","ie","opera","chrome","browserVersion","service","Tags","normalizeOne","tag","trim","compressOne","equal","tag1","tag2","normalizeAll","tags","isString","compressAll","extract","entity","searchFields","field","hashTags","concat","uniq","TimerEvent","timeout","DefaultEvents","TimerService","$interval","_started","_events","_interval","isStarted","addEvent","existingEvent","find","newEvent","startEvent","removeEvent","stopEvent","splice","clearEvents","stop","interval","cancel","ex","start"],"mappings":"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","file":"pip-webui-services.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","﻿'use strict';\r\n\r\nimport './translate';\r\nimport './session';\r\nimport './transactions';\r\nimport './routing';\r\nimport './utilities';\r\n\r\nangular.module('pipServices', [\r\n    'pipTranslate',\r\n    'pipSession',\r\n    'pipTransaction',\r\n    'pipRouting',\r\n    'pipFormat',\r\n    'pipTimer',\r\n    'pipScroll',\r\n    'pipTags',\r\n    'pipCodes',\r\n    'pipSystemInfo',\r\n    'pipPageReset'\r\n]);\r\n\r\nexport * from './translate';\r\nexport * from './session';\r\nexport * from './transactions';\r\nexport * from './routing';\r\nexport * from './utilities';\r\n","'use strict';\r\n\r\nexport let CurrentState: any;\r\nexport let PreviousState: any;\r\n\r\nfunction captureStateTranslations($rootScope: ng.IRootScopeService) {\r\n    \"ngInject\";\r\n\r\n    $rootScope.$on('$stateChangeSuccess',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            CurrentState = {\r\n                name: toState.name, \r\n                url: toState.url, \r\n                params: toParams\r\n            };\r\n\r\n            PreviousState = {\r\n                name: fromState.name, \r\n                url: fromState.url, \r\n                params: fromParams\r\n            };\r\n        }\r\n    );\r\n\r\n}\r\n\r\nfunction decorateBackStateService($delegate, $window: ng.IWindowService) {\r\n    \"ngInject\";\r\n\r\n    $delegate.goBack = goBack;\r\n    $delegate.goBackAndSelect = goBackAndSelect;\r\n\r\n    return $delegate;\r\n    //////////////////////////////////////////////////\r\n\r\n    function goBack(): void {\r\n        $window.history.back()\r\n    }\r\n\r\n    function goBackAndSelect(params: any): void {\r\n        if (PreviousState != null \r\n            && PreviousState.name != null) {\r\n\r\n            let state = _.cloneDeep(PreviousState);\r\n\r\n            // Override selected parameters\r\n            state.params = _.extend(state.params, params);\r\n\r\n            $delegate.go(state.name, state.params);\r\n        } else {\r\n            $window.history.back();\r\n        }\r\n    }\r\n}\r\n\r\nfunction addBackStateDecorator($provide) {\r\n    $provide.decorator('$state', decorateBackStateService);\r\n}\r\n\r\nangular\r\n    .module('pipRouting')\r\n    .config(addBackStateDecorator)\r\n    .run(captureStateTranslations);\r\n    ","'use strict';\r\n\r\nlet RedirectedStates: any = {};\r\n\r\nfunction decorateRedirectStateProvider($delegate) {\r\n    \"ngInject\";\r\n\r\n    $delegate.redirect = redirect;\r\n\r\n    return $delegate;\r\n    /////////////////////////////////////////////\r\n\r\n    // Specify automatic redirect from one state to another\r\n    function redirect(fromState, toState) {\r\n        RedirectedStates[fromState] = toState;  \r\n        return this;\r\n    }\r\n}\r\n\r\nfunction addRedirectStateProviderDecorator($provide) {\r\n    \"ngInject\";\r\n\r\n    $provide.decorator('$state', decorateRedirectStateProvider);\r\n}\r\n\r\nfunction decorateRedirectStateService($delegate, $timeout) {\r\n    \"ngInject\";\r\n\r\n    $delegate.redirect = redirect;\r\n    \r\n    return $delegate;\r\n    ////////////////////////////////\r\n    \r\n    // Todo: Move this code directly to event handler?\r\n    // Todo: Nothing calls this code!!\r\n    function redirect(event, state, params) {\r\n        let toState = RedirectedStates[state.name];\r\n        if (_.isFunction(toState)) {\r\n            toState = toState(state.name, params);\r\n\r\n            if (_.isNull(toState))\r\n                throw new Error('Redirected toState cannot be null');\r\n        }\r\n\r\n        if (!!toState) {\r\n            $timeout(() => {\r\n                event.preventDefault();\r\n                $delegate.transitionTo(toState, params, {location: 'replace'});\r\n            });\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction addRedirectStateDecorator($provide) {\r\n    \"ngInject\";\r\n\r\n    $provide.decorator('$state', decorateRedirectStateService);\r\n}\r\n\r\nangular\r\n    .module('pipRouting')\r\n    .config(addRedirectStateProviderDecorator)\r\n    .config(addRedirectStateDecorator);\r\n    ","'use strict';\r\n\r\nexport let RoutingVar: string = \"$routing\";\r\n\r\nfunction hookRoutingEvents(\r\n    $rootScope: ng.IRootScopeService,\r\n    $log: ng.ILogService,\r\n    $state: ng.ui.IStateService\r\n) {\r\n    \"ngInject\";\r\n\r\n    $rootScope.$on('$stateChangeStart',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            $rootScope[RoutingVar] = true;\r\n        }\r\n    );\r\n\r\n    $rootScope.$on('$stateChangeSuccess',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            // Unset routing variable to disable page transition\r\n            $rootScope[RoutingVar] = false;                \r\n        }\r\n    );\r\n\r\n    // Intercept route error\r\n    $rootScope.$on('$stateChangeError',\r\n        (event, toState, toParams, fromState, fromParams, error) => {\r\n            // Unset routing variable to disable page transition\r\n            $rootScope[RoutingVar] = false;\r\n\r\n            $log.error('Error while switching route to ' + toState.name);\r\n            $log.error(error);\r\n        }\r\n    );\r\n\r\n    // Intercept route error\r\n    $rootScope.$on('$stateNotFound',\r\n        function(event, unfoundState, fromState, fromParams) {\r\n            event.preventDefault();\r\n\r\n            $rootScope[RoutingVar] = false;\r\n\r\n            // Todo: Move to errors\r\n            $state.go('errors_missing_route',  {\r\n                    unfoundState: unfoundState,\r\n                    fromState : {\r\n                        to: fromState ? fromState.name : '',\r\n                        fromParams: fromParams\r\n                    }\r\n                }\r\n            );\r\n        }\r\n    );\r\n\r\n}\r\n\r\nangular\r\n    .module('pipRouting')\r\n    .run(hookRoutingEvents);\r\n    ","'use strict';\r\n\r\nangular.module('pipRouting', ['ui.router']);\r\n\r\nimport './BackDecorator';\r\nimport './RedirectDecorator';\r\nimport './RoutingEvents';\r\n\r\nexport * from './BackDecorator';\r\nexport * from './RoutingEvents';\r\n","'use strict';\r\n\r\nexport let IdentityRootVar = \"$identity\";\r\nexport let IdentityChangedEvent = \"pipIdentityChanged\";\r\n\r\nexport interface IIdentity {\r\n    id: string;\r\n    full_name: string;\r\n    details: string;\r\n    email: string;\r\n    photo_url: string;\r\n}\r\n\r\nexport interface IIdentityService {\r\n    identity: IIdentity;\r\n}\r\n\r\nexport interface IIdentityProvider extends ng.IServiceProvider {\r\n    setRootVar: boolean;\r\n    identity: IIdentity;\r\n}\r\n\r\n\r\nclass IdentityService implements IIdentityService {\r\n    private _identity: IIdentity;\r\n    private _setRootVar: boolean;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n\r\n    public constructor(\r\n        setRootVar: boolean,\r\n        identity: IIdentity,\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._identity = identity;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n\r\n        this.setRootVar();\r\n    }\r\n\r\n    private setRootVar(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[IdentityRootVar] = this._identity;\r\n    }\r\n\r\n    public get identity(): IIdentity {\r\n        return this._identity;\r\n    }\r\n\r\n    public set identity(value: IIdentity) {\r\n        this._identity = value;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(IdentityChangedEvent, this._identity);\r\n\r\n        let identity: IIdentity = value || <IIdentity>{};\r\n        this._log.debug(\"Changed identity to \" + identity.id + \" \" + identity.full_name);\r\n    }\r\n}\r\n\r\nclass IdentityProvider implements IdentityProvider {\r\n    private _setRootVar = true;\r\n    private _identity: IIdentity = null;\r\n    private _service: IdentityService = null;\r\n\r\n    public constructor() { }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get identity(): any {\r\n        return this._identity;  \r\n    }\r\n\r\n    public set identity(value: any) {\r\n        this._identity = value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null)\r\n            this._service = new IdentityService(this._setRootVar, this._identity, $rootScope, $log);\r\n\r\n        return this._service;\r\n    }\r\n\r\n}\r\n\r\nangular\r\n    .module('pipSession')\r\n    .provider('pipIdentity', IdentityProvider);\r\n","'use strict';\r\n\r\nexport const SessionRootVar = \"$session\";\r\nexport const SessionOpenedEvent = \"pipSessionOpened\";\r\nexport const SessionClosedEvent = \"pipSessionClosed\";\r\n\r\nexport interface ISessionService {\r\n    session: any;\r\n    isOpened(): boolean;\r\n\r\n    open(session: any): void;\r\n    close(): void;\r\n}\r\n\r\nexport interface ISessionProvider extends ng.IServiceProvider {\r\n    setRootVar: boolean;\r\n    session: any;\r\n}\r\n\r\nclass SessionService implements ISessionService {\r\n    private _setRootVar: boolean;\r\n    private _session: any;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n\r\n    public constructor(\r\n        setRootVar: boolean, \r\n        session: any, \r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._session = session;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n\r\n        this.setRootVar();\r\n    }\r\n    \r\n    private setRootVar(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[SessionRootVar] = this._session;\r\n    }\r\n\r\n    public get session(): any {\r\n        return this._session;\r\n    }\r\n\r\n    public isOpened(): boolean {\r\n        return this._session != null;\r\n    }\r\n\r\n    public open(session: any, fullReset: boolean = false, partialReset: boolean = false) {\r\n        if (session == null)\r\n            throw new Error(\"Session cannot be null\");\r\n\r\n        this._session = session;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(SessionOpenedEvent, session);\r\n\r\n        this._log.debug(\"Opened session \" + session);\r\n    }\r\n\r\n    public close(fullReset: boolean = false, partialReset: boolean = false) {\r\n        let oldSession = this._session;\r\n\r\n        this._session = null;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(SessionClosedEvent, oldSession);\r\n\r\n        this._log.debug(\"Closed session \" + oldSession);\r\n    }\r\n}\r\n\r\nclass SessionProvider implements ISessionProvider {\r\n    private _setRootVar = true;\r\n    private _session: any = null;\r\n    private _service: SessionService = null;\r\n\r\n    public constructor() { }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get session(): any {\r\n        return this._session;  \r\n    }\r\n\r\n    public set session(value: any) {\r\n        this._session = value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null)\r\n            this._service = new SessionService(this._setRootVar, this._session, $rootScope, $log);\r\n\r\n        return this._service;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipSession')\r\n    .provider('pipSession', SessionProvider); \r\n","'use strict';\r\n\r\nangular.module('pipSession', []);\r\n\r\nimport './IdentityService';\r\nimport './SessionService';\r\n\r\nexport * from './IdentityService';\r\nexport * from './SessionService';\r\n","'use strict';\r\n\r\nimport { TransactionError } from './TransactionError'\r\n\r\nexport class Transaction {\r\n    private _scope: string = null;\r\n    private _id: string = null;\r\n    private _operation: string = null;\r\n    private _error: TransactionError = new TransactionError();\r\n    private _progress: number = 0;\r\n\r\n    public constructor(scope: string) {\r\n        this._scope = scope;\r\n    }\r\n\r\n    public get scope(): string {\r\n        return this._scope;\r\n    }\r\n\r\n    public get id(): string {\r\n        return this._id;\r\n    }\r\n\r\n    public get operation(): string {\r\n        return this._operation;\r\n    }\r\n\r\n    public get progress(): number {\r\n        return this._progress;\r\n    }\r\n\r\n    public get error(): TransactionError {\r\n        return this._error;\r\n    }\r\n\r\n    public get errorMessage(): string {\r\n        return this._error.message;\r\n    }\r\n\r\n    public reset(): void {\r\n        this._id = null;\r\n        this._operation = null;\r\n        this._progress = 0;\r\n        this._error.reset();\r\n    }\r\n\r\n    public busy(): boolean {\r\n        return this._id != null;\r\n    }\r\n\r\n    public failed(): boolean {\r\n        return !this._error.empty();\r\n    }\r\n\r\n    public aborted(id: string): boolean {\r\n        return this._id != id;\r\n    }\r\n\r\n    public begin(operation: string): string {\r\n        // Transaction is already running\r\n        if (this._id != null) return null;\r\n\r\n        this._id = new Date().getTime().toString();\r\n        this._operation = operation || 'PROCESSING'\r\n        this._error.reset();\r\n\r\n        return this._id;\r\n    }\r\n\r\n    public update(progress: number): void {\r\n        this._progress = Math.max(progress, 100);\r\n    }\r\n\r\n    public abort(): void {\r\n        this._id = null;\r\n        this._error.reset();\r\n    }\r\n\r\n    public end(error?: any): void {\r\n        this._error.decode(error);\r\n        this._id = null;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport class TransactionError {\r\n    public code: string;\r\n    public message: string;\r\n    public details: any;\r\n    public cause: string;\r\n    public stack_trace: string;\r\n\r\n    public constructor(error?: any) {\r\n        if (error != null)\r\n            this.decode(error);\r\n    }\r\n\r\n    public reset(): void {\r\n        this.code = null;\r\n        this.message = null;\r\n        this.details = null;\r\n        this.cause = null;\r\n        this.stack_trace = null;\r\n    }\r\n\r\n    public empty(): boolean {\r\n        return this.message = null && this.code == null;\r\n    }\r\n\r\n    public decode(error: any): void {\r\n        this.reset();\r\n\r\n        if (error == null) return;\r\n\r\n        // Process regular messages\r\n        if (error.message) \r\n            this.message = error.message;\r\n\r\n        // Process server application errors\r\n        if (error.data) {\r\n            if (error.data.code) { \r\n                // process server error codes here\r\n                this.message = this.message || 'ERROR_' + error.data.code;\r\n                this.code = this.code || error.data.code;\r\n            }\r\n\r\n            if (error.data.message)\r\n                this.message = this.message || error.data.message;\r\n\r\n            this.message = this.message || error.data;\r\n            this.details = this.details || error.data;\r\n\r\n            this.cause = error.data.cause;\r\n            this.stack_trace = error.data.stack_trace;\r\n            this.details = error.data.details;            \r\n        }\r\n\r\n        // Process standard HTTP errors\r\n        if (error.statusText)\r\n            this.message = this.message || error.statusText;\r\n\r\n        if (error.status) {\r\n            this.message = this.message || 'ERROR_' + error.status;\r\n            this.code = this.code || error.status;\r\n        }\r\n        \r\n        this.message = this.message || error;\r\n        this.details = this.details || error;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nimport { Transaction } from './Transaction';\r\n\r\nexport interface ITransactionService {\r\n    create(scope?: string): Transaction;\r\n    get(scope?: string): Transaction;\r\n}\r\n\r\nclass TransactionService implements TransactionService {\r\n    private _transactions: any = {};\r\n\r\n    public constructor() {}\r\n\r\n    public create(scope?: string): Transaction {\r\n        let transaction = new Transaction(scope);\r\n        \r\n        if (scope != null)\r\n            this._transactions[scope] = transaction;\r\n\r\n        return transaction;\r\n    }\r\n\r\n    public get(scope?: string): Transaction {\r\n        let transaction: Transaction = scope != null ? <Transaction>this._transactions[scope] : null;\r\n\r\n        if (transaction == null) {\r\n            transaction = new Transaction(scope);\r\n            if (scope != null)\r\n                this._transactions[scope] = transaction;\r\n        }\r\n\r\n        return transaction;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTransaction')\r\n    .service('pipTransaction', TransactionService);\r\n","'use strict';\r\n\r\nfunction configureTransactionStrings($injector) {\r\n    \"ngInject\";\r\n\r\n    let pipTranslate = $injector.has('pipTranslateProvider') ? $injector.get('pipTranslateProvider') : null;\r\n\r\n    if (pipTranslate) {\r\n        pipTranslate.setTranslations('en', {\r\n            'ENTERING': 'Entering...',\r\n            'PROCESSING': 'Processing...',\r\n            'LOADING': 'Loading...',\r\n            'SAVING': 'Saving...'\r\n        });\r\n\r\n        pipTranslate.setTranslations('ru', {\r\n            'ENTERING': 'Вход в систему...',\r\n            'PROCESSING': 'Обрабатывается...',\r\n            'LOADING': 'Загружается...',\r\n            'SAVING': 'Сохраняется...'\r\n        });   \r\n    }\r\n    \r\n}\r\n\r\nangular\r\n    .module('pipTransaction')\r\n    .config(configureTransactionStrings);\r\n","'use strict';\r\n\r\nangular.module('pipTransaction', []);\r\n\r\nimport './TransactionStrings';\r\nimport './TransactionError';\r\nimport './Transaction';\r\nimport './TransactionService';\r\n\r\nexport * from './TransactionError';\r\nexport * from './Transaction';\r\nexport * from './TransactionService';\r\n","'use strict';\r\n\r\nfunction translateDirective(pipTranslate): ng.IDirective {\r\n    \"ngInject\";\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            key1: '@pipTranslate',\r\n            key2: '@key'\r\n        },\r\n        link: (scope: any, element: any, attrs: any) => {\r\n            let key = scope.key1 || scope.key2;\r\n            let value = pipTranslate.translate(key);\r\n            element.text(value);\r\n        }\r\n    };\r\n}\r\n\r\nfunction translateHtmlDirective(pipTranslate): ng.IDirective {\r\n    \"ngInject\";\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            key1: '@pipTranslateHtml',\r\n            key2: '@key'\r\n        },\r\n        link: (scope: any, element: any, attrs: any) => {\r\n            let key = scope.key1 || scope.key2;\r\n            let value = pipTranslate.translate(key);\r\n            element.html(value);\r\n        }\r\n    };\r\n}\r\n\r\nangular\r\n    .module('pipTranslate')\r\n    .directive('pipTranslate', translateDirective)\r\n    .directive('pipTranslateHtml', translateHtmlDirective);\r\n","'use strict';\r\n\r\nfunction translateFilter(pipTranslate) {\r\n    \"ngInject\";\r\n\r\n    return function (key) {\r\n        return pipTranslate.translate(key) || key;\r\n    }\r\n}\r\n\r\nfunction optionalTranslateFilter($injector) {\r\n    \"ngInject\";\r\n\r\n    let pipTranslate = $injector.has('pipTranslate') \r\n        ? $injector.get('pipTranslate') : null;\r\n\r\n    return function (key) {\r\n        return pipTranslate  ? pipTranslate.translate(key) || key : key;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTranslate')\r\n    .filter('translate', translateFilter);\r\n","﻿'use strict';\r\n\r\nimport { Translation } from './Translation';\r\nimport { ResetPageEvent } from '../utilities/PageResetService';\r\n\r\nexport let LanguageRootVar = \"$language\";\r\nexport let LanguageChangedEvent = \"pipLanguageChanged\";    \r\n\r\nexport interface ITranslateService {\r\n    language: string;\r\n\r\n    use(language: string): string;\r\n    setTranslations(language: string, translations: any): void;\r\n    translations(language: string, translations: any): void;\r\n\r\n    translate(key: string): string;\r\n    translateArray(keys: string[]): string[];\r\n    translateSet(keys: string[], keyProp: string, valueProp: string): any[];\r\n    translateObjects(items: any[], keyProp: string, valueProp: string): any[];\r\n    translateWithPrefix(prefix: string, key: string);\r\n    translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string);\r\n    translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string);\r\n}\r\n\r\nexport interface ITranslateProvider extends ITranslateService, ng.IServiceProvider {\r\n}\r\n\r\nclass TranslateService implements ITranslateService {\r\n    private _translation: Translation;\r\n    private _setRootVar: boolean;\r\n    private _persist: boolean;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _window: ng.IWindowService;\r\n\r\n    public constructor(\r\n        translation: Translation,\r\n        setRootVar: boolean,\r\n        persist: boolean,\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService,\r\n        $window: ng.IWindowService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._persist = persist;\r\n        this._translation = translation;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._window = $window;\r\n\r\n        if (this._persist && this._window.localStorage)\r\n            this._translation.language = this._window.localStorage.getItem('language') || this._translation.language;\r\n\r\n        this._log.debug(\"Set language to \" + this._translation.language);\r\n\r\n        this.save();\r\n    }\r\n\r\n    private save(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[LanguageRootVar] = this._translation.language;\r\n\r\n        if (this._persist && this._window.localStorage != null)\r\n            this._window.localStorage.setItem('language', this._translation.language);\r\n    }\r\n\r\n    public get language(): string {\r\n        return this._translation.language;\r\n    }\r\n\r\n    public set language(value: string) {\r\n        if (value != this._translation.language) {\r\n            this._translation.language = value;\r\n            \r\n            this._log.debug(\"Changing language to \" + value);\r\n\r\n            this.save();                \r\n\r\n            this._rootScope.$emit(LanguageChangedEvent, value);\r\n            this._rootScope.$emit(ResetPageEvent);\r\n        }\r\n    }\r\n\r\n    public use(language: string): string {\r\n        if (language != null)\r\n            this.language = language;\r\n        return this.language;\r\n    }\r\n\r\n    public setTranslations(language: string, translations: any): void {\r\n        return this._translation.setTranslations(language, translations);\r\n    }\r\n\r\n    public translations(language: string, translations: any): void {\r\n        return this._translation.setTranslations(language, translations);\r\n    }\r\n\r\n    public translate(key: string): string {\r\n        return this._translation.translate(key);\r\n    }\r\n\r\n    public translateArray(keys: string[]): string[] {\r\n        return this._translation.translateArray(keys);\r\n    }\r\n    \r\n    public translateSet(keys: string[], keyProp: string, valueProp: string): any[] {\r\n        return this._translation.translateSet(keys, keyProp, valueProp);\r\n    }\r\n\r\n    public translateObjects(items: any[], keyProp: string, valueProp: string): any[] {\r\n        return this._translation.translateObjects(items, keyProp, valueProp);\r\n    }\r\n\r\n    public translateWithPrefix(prefix: string, key: string) {\r\n        return this._translation.translateWithPrefix(prefix, key);\r\n    }\r\n\r\n    public translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        return this._translation.translateSetWithPrefix(prefix, keys, keyProp, valueProp);\r\n    }\r\n\r\n    public translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        return this._translation.translateSetWithPrefix2(prefix, keys, keyProp, valueProp);\r\n    }\r\n}\r\n\r\nclass TranslateProvider extends Translation implements ITranslateProvider {\r\n    private _translation: Translation;\r\n    private _setRootVar: boolean = true;\r\n    private _persist: boolean = true;\r\n    private _service: TranslateService;\r\n    \r\n    public constructor() {\r\n        super();\r\n    }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get persist(): boolean {\r\n        return this._persist;  \r\n    }\r\n\r\n    public set persist(value: boolean) {\r\n        this._persist = !!value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $window: ng.IWindowService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null) \r\n            this._service = new TranslateService(this, this._setRootVar, this._persist, $rootScope, $log, $window);\r\n\r\n        return this._service;\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipTranslate')\r\n    .provider('pipTranslate', TranslateProvider);\r\n","'use strict';\r\n\r\nexport class Translation {\r\n    protected _language = 'en';\r\n    protected _translations = {\r\n        en: {\r\n            'en': 'English',\r\n            'ru': 'Russian',\r\n            'es': 'Spanish',\r\n            'pt': 'Portuguese',\r\n            'de': 'German',\r\n            'fr': 'French'\r\n        },\r\n        ru: {\r\n            'en': 'Английский',\r\n            'ru': 'Русский',\r\n            'es': 'Испанский',\r\n            'pt': 'Португальский',\r\n            'de': 'Немецкий',\r\n            'fr': 'Французский'\r\n        }\r\n    };\r\n\r\n    public constructor() {}\r\n\r\n    public get language(): string { return this._language; }\r\n    public set language(value: string) { this._language = value; }\r\n\r\n    public use(language: string): string {\r\n        if (language != null)\r\n            this._language = language;\r\n        return this._language;\r\n    }\r\n\r\n    // Set translation strings for specific language\r\n    public setTranslations(language: string, translations: any): void {\r\n        let map = this._translations[language] || {};\r\n        this._translations[language] = _.extend(map, translations);\r\n    }\r\n\r\n    // Yet another method to set translation strings for specific language\r\n    public translations(language: string, translations: any): void {\r\n        this.setTranslations(language, translations);\r\n    }\r\n\r\n    // Translate a string by key using set language\r\n    public translate(key: string): string {\r\n        if (_.isNull(key) || _.isUndefined(key)) return '';\r\n\r\n        let translations = this._translations[this._language] || {};\r\n        return translations[key] || key;\r\n    }\r\n\r\n    // Translate an array of strings\r\n    public translateArray(keys: string[]): string[] {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (k) {\r\n            let key = k || '';\r\n            values.push(translations[key] || key);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate an array of strings into array of objects (set)\r\n    public translateSet(keys: string[], keyProp: string, valueProp: string): any[] {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n\r\n        let values: any[] = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {};\r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[key] || key;\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate a collection of objects\r\n    public translateObjects(items: any[], keyProp: string, valueProp: string): any[] {\r\n        if (_.isNull(items) || items.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'name';\r\n        valueProp = valueProp || 'nameLocal';\r\n\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(items, function (item) {\r\n            let key = item[keyProp] || '';\r\n\r\n            item[valueProp] = translations[key] || key;\r\n        });\r\n\r\n        return items;\r\n    }\r\n\r\n    // Translate a string by key  with prefix using set language todo\r\n    public translateWithPrefix(prefix: string, key: string) {\r\n        prefix = prefix ? prefix + '_' : '';\r\n        key = (prefix + key).replace(/ /g, '_').toUpperCase();\r\n        if (key == null) return '';\r\n        let translations = this._translations[this._language] || {};\r\n        return translations[key] || key;\r\n    };\r\n\r\n    public translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() : '';\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {}; \r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[prefix + '_' + key] || key;\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate an array of strings, apply uppercase and replace ' ' => '_'\r\n    public translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n        prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() + '_': '';\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {};\r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[prefix + key.replace(/ /g, '_').toUpperCase()]\r\n                || (prefix + key.replace(/ /g, '_').toUpperCase());\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nangular.module('pipTranslate', []);\r\n\r\nimport './Translation';\r\nimport './TranslateService';\r\nimport './TranslateFilter';\r\nimport './TranslateDirective';\r\n\r\nexport * from './Translation';\r\nexport * from './TranslateService';\r\n","'use strict';\r\n\r\nexport interface ICodes {\r\n    // Simple version of string hashcode\r\n    hash(value: string): number;\r\n    // Generates random big number for verification codes\r\n    verification(): string;\r\n}\r\n\r\n\r\nclass Codes implements ICodes {\r\n    // Simple version of string hashcode\r\n    public hash(value: string): number {\r\n        if (value == null) return 0;\r\n        \r\n        let result = 0;\r\n        for (let i = 0; i < value.length; i++)\r\n            result += value.charCodeAt(i);\r\n\r\n        return result;\r\n    }\r\n\r\n    // Generates random big number for verification codes\r\n    public verification(): string {\r\n        return Math.random().toString(36).substr(2, 10).toUpperCase(); // remove `0.`\r\n    }\r\n}\r\n\r\nangular\r\n    .module('pipCodes', [])\r\n    .service('pipCodes', Codes);\r\n","'use strict';\r\n\r\nexport interface IFormat {\r\n    // Creates a sample line from a text\r\n    sample(value: string, maxLength: number): string;\r\n\r\n    sprintf(message: string, ...args: any[]): string;\r\n}\r\n\r\n\r\nclass Format implements IFormat {\r\n    // Cached for parsed formats\r\n    private cache = {};\r\n\r\n    // Creates a sample line from a text\r\n    public sample(value: string, maxLength: number): string {\r\n        if (!value || value == '') return '';\r\n\r\n        var length = value.indexOf('\\n');\r\n        length = length >= 0 ? length : value.length;\r\n        length = length < maxLength ? value.length : maxLength;\r\n\r\n        return value.substring(0, length);\r\n    }\r\n\r\n    private strRepeat(str: string, qty: number): string {\r\n        if (qty < 1) return '';\r\n        var result = '';\r\n        while (qty > 0) {\r\n            if (qty & 1) result += str;\r\n            qty >>= 1, str += str;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private getType(variable) {\r\n        return toString.call(variable).slice(8, -1).toLowerCase();\r\n    }\r\n\r\n    private parseFormat(fmt: string) {\r\n        let _fmt = fmt, match = [], parse_tree = [], arg_names = 0;\r\n        while (_fmt) {\r\n            if ((match = /^[^\\x25]+/.exec(_fmt)) !== null) {\r\n                parse_tree.push(match[0]);\r\n            }\r\n            else if ((match = /^\\x25{2}/.exec(_fmt)) !== null) {\r\n                parse_tree.push('%');\r\n            }\r\n            else if ((match = /^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt)) !== null) {\r\n                if (match[2]) {\r\n                    arg_names |= 1;\r\n                    var field_list = [], replacement_field = match[2], field_match = [];\r\n                    if ((field_match = /^([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                        field_list.push(field_match[1]);\r\n                        while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {\r\n                            if ((field_match = /^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                                field_list.push(field_match[1]);\r\n                            }\r\n                            else if ((field_match = /^\\[(\\d+)\\]/.exec(replacement_field)) !== null) {\r\n                                field_list.push(field_match[1]);\r\n                            }\r\n                            else {\r\n                                throw new Error('Unknown error');\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        throw new Error('Unknown error');\r\n                    }\r\n                    match[2] = field_list;\r\n                }\r\n                else {\r\n                    arg_names |= 2;\r\n                }\r\n                if (arg_names === 3) {\r\n                    throw new Error('Mixing positional and named placeholders is not (yet) supported');\r\n                }\r\n                parse_tree.push(match);\r\n            }\r\n            else {\r\n                throw new Error('Unknown error');\r\n            }\r\n            _fmt = _fmt.substring(match[0].length);\r\n        }\r\n        return parse_tree;\r\n    }\r\n\r\n    private format(parse_tree, argv) {\r\n        let cursor = 0; \r\n        let tree_length = parse_tree.length; \r\n        let output = [];\r\n\r\n        for (let i = 0; i < tree_length; i++) {\r\n            let node_type = this.getType(parse_tree[i]);\r\n            if (node_type === 'string') {\r\n                output.push(parse_tree[i]);\r\n            }\r\n            else if (node_type === 'array') {\r\n                let match = parse_tree[i]; // convenience purposes only\r\n                let arg: any;\r\n                if (match[2]) { // keyword argument\r\n                    arg = argv[cursor];\r\n                    for (let k = 0; k < match[2].length; k++) {\r\n                        if (!arg.hasOwnProperty(match[2][k])) {\r\n                            throw new Error(this.sprintf('Property \"%s\" does not exist', match[2][k]));\r\n                        }\r\n                        arg = arg[match[2][k]];\r\n                    }\r\n                } else if (match[1]) { // positional argument (explicit)\r\n                    arg = argv[match[1]];\r\n                }\r\n                else { // positional argument (implicit)\r\n                    arg = argv[cursor++];\r\n                }\r\n\r\n                if (/[^s]/.test(match[8]) && (this.getType(arg) != 'number')) {\r\n                    throw new Error(this.sprintf('Expecting number but found %s', this.getType(arg)));\r\n                }\r\n                switch (match[8]) {\r\n                    case 'b': arg = arg.toString(2); break;\r\n                    case 'c': arg = String.fromCharCode(arg); break;\r\n                    case 'd': arg = parseInt(arg, 10); break;\r\n                    case 'e': arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential(); break;\r\n                    case 'f': arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg); break;\r\n                    case 'o': arg = arg.toString(8); break;\r\n                    case 's': arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg); break;\r\n                    case 'u': arg = Math.abs(arg); break;\r\n                    case 'x': arg = arg.toString(16); break;\r\n                    case 'X': arg = arg.toString(16).toUpperCase(); break;\r\n                }\r\n                arg = (/[def]/.test(match[8]) && match[3] && arg >= 0 ? '+'+ arg : arg);                \r\n                let pad_character = match[4] ? match[4] == '0' ? '0' : match[4].charAt(1) : ' ';\r\n                let pad_length = match[6] - String(arg).length;\r\n                let pad = match[6] ? this.strRepeat(pad_character, pad_length) : '';\r\n                output.push(match[5] ? arg + pad : pad + arg);\r\n            }\r\n        }\r\n        return output.join('');\r\n    }\r\n    \r\n    public sprintf(message: string, ...args: any[]): string {\r\n        if (!this.cache.hasOwnProperty(message))\r\n            this.cache[message] = this.parseFormat(message);\r\n\r\n        return this.format(this.cache[message], args);\r\n    }\r\n}\r\n\r\n\r\nangular\r\n    .module('pipFormat', [])\r\n    .service('pipFormat', Format);\r\n","'use strict';\r\n\r\nexport let ResetPageEvent: string = \"pipResetPage\";\r\nexport let ResetAreaEvent: string = \"pipResetArea\";\r\n\r\nexport let ResetRootVar: string = \"$reset\";\r\nexport let ResetAreaRootVar: string = \"$resetArea\";\r\n\r\nexport interface IPageResetService {\r\n    reset(): void;\r\n    resetArea(area: string): void;\r\n}\r\n\r\n\r\nclass PageResetService implements IPageResetService {\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _timeout: ng.ITimeoutService;\r\n\r\n    public constructor(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $timeout: ng.ITimeoutService\r\n    ) {\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._timeout = $timeout;\r\n\r\n        $rootScope[ResetRootVar] = false;\r\n        $rootScope[ResetAreaRootVar] = null;\r\n    }\r\n\r\n    public reset(): void {\r\n        this._log.debug(\"Resetting the entire page\");\r\n        this.performReset(null);\r\n    }\r\n\r\n    public resetArea(area: string): void {\r\n        this._log.debug(\"Resetting the area \" + area);\r\n        this.performReset(area);\r\n    }\r\n\r\n    private performReset(area?: string): void {\r\n        this._rootScope[ResetRootVar] = area == null;\r\n        this._rootScope[ResetAreaRootVar] = area;\r\n\r\n        this._timeout(() => {\r\n            this._rootScope[ResetRootVar] = false;\r\n            this._rootScope[ResetAreaRootVar] = null;\r\n        }, 0);\r\n    }\r\n}\r\n\r\n\r\nfunction hookResetEvents(\r\n    $rootScope: ng.IRootScopeService, \r\n    pipPageReset: IPageResetService\r\n) {\r\n    $rootScope.$on(ResetPageEvent, () => { pipPageReset.reset(); });\r\n    $rootScope.$on(ResetAreaEvent, (event, area) => { pipPageReset.resetArea(area); });\r\n}\r\n\r\n\r\nangular.module('pipPageReset', [])\r\n    .service('pipPageReset', PageResetService)\r\n    .run(hookResetEvents);\r\n","'use strict';\r\n\r\nexport interface IScrollService {\r\n    scrollTo(parentElement, childElement, animationDuration): void;\r\n}\r\n\r\nclass ScrollService implements IScrollService {\r\n\r\n    public scrollTo(parentElement, childElement, animationDuration): void {\r\n        if (!parentElement || !childElement) return;\r\n        if (animationDuration == undefined) animationDuration = 300;\r\n\r\n        setTimeout(function () {\r\n            if (!$(childElement).position()) return;\r\n            var modDiff= Math.abs($(parentElement).scrollTop() - $(childElement).position().top);\r\n            if (modDiff < 20) return;\r\n            var scrollTo = $(parentElement).scrollTop() + ($(childElement).position().top - 20);\r\n            if (animationDuration > 0)\r\n                $(parentElement).animate({\r\n                    scrollTop: scrollTo + 'px'\r\n                }, animationDuration);\r\n        }, 100);\r\n    }\r\n\r\n}\r\n\r\n\r\nangular\r\n    .module('pipScroll', [])\r\n    .service('pipScroll', ScrollService);\r\n","'use strict';\r\n\r\nexport interface ISystemInfo {\r\n    browserName: string;\r\n    browserVersion: string;\r\n    platform: string;\r\n    os: string;\r\n\r\n    isDesktop(): boolean;\r\n    isMobile(): boolean;\r\n    isCordova(): boolean;\r\n    isSupported(supported?: any): boolean;\r\n}\r\n\r\n\r\nclass SystemInfo implements ISystemInfo {\r\n    private _window: ng.IWindowService;\r\n\r\n    public constructor($window: ng.IWindowService) {\r\n        \"ngInject\";\r\n\r\n        this._window = $window;\r\n    }\r\n\r\n    // todo add support for iPhone\r\n    public get browserName(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        if (ua.search(/Edge/) > -1) return \"edge\";\r\n        if (ua.search(/MSIE/) > -1) return \"ie\";\r\n        if (ua.search(/Trident/) > -1) return \"ie\";\r\n        if (ua.search(/Firefox/) > -1) return \"firefox\";\r\n        if (ua.search(/Opera/) > -1) return \"opera\";\r\n        if (ua.search(/OPR/) > -1) return \"opera\";\r\n        if (ua.search(/YaBrowser/) > -1) return \"yabrowser\";\r\n        if (ua.search(/Chrome/) > -1) return \"chrome\";\r\n        if (ua.search(/Safari/) > -1) return \"safari\";\r\n        if (ua.search(/Maxthon/) > -1) return \"maxthon\";\r\n        \r\n        return \"unknown\";\r\n    }\r\n\r\n    public get browserVersion(): string {\r\n        let version;\r\n        let ua = this._window.navigator.userAgent;\r\n        let browser = this.browserName;\r\n\r\n        switch (browser) {\r\n            case \"edge\":\r\n                version = (ua.split(\"Edge\")[1]).split(\"/\")[1];\r\n                break;\r\n            case \"ie\":\r\n                version = (ua.split(\"MSIE \")[1]).split(\";\")[0];\r\n                break;\r\n            case \"ie11\":\r\n                browser = \"ie\";\r\n                version = (ua.split(\"; rv:\")[1]).split(\")\")[0];\r\n                break;\r\n            case \"firefox\":\r\n                version = ua.split(\"Firefox/\")[1];\r\n                break;\r\n            case \"opera\":\r\n                version = ua.split(\"Version/\")[1];\r\n                break;\r\n            case \"operaWebkit\":\r\n                version = ua.split(\"OPR/\")[1];\r\n                break;\r\n            case \"yabrowser\":\r\n                version = (ua.split(\"YaBrowser/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"chrome\":\r\n                version = (ua.split(\"Chrome/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"safari\":\r\n                version = (ua.split(\"Version/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"maxthon\":\r\n                version = ua.split(\"Maxthon/\")[1];\r\n                break;\r\n        }\r\n\r\n        return version;\r\n    }\r\n    \r\n    public get platform(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        if (/iphone|ipad|ipod|android|blackberry|mini|windows\\sce|palm/i.test(ua.toLowerCase())) \r\n            return 'mobile';\r\n\r\n        return 'desktop';\r\n    }\r\n\r\n    public get os(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        try {\r\n            let osAll = (/(windows|mac|android|linux|blackberry|sunos|solaris|iphone)/.exec(ua.toLowerCase()) || [ua])[0].replace('sunos', 'solaris');\r\n            let osAndroid = (/(android)/.exec(ua.toLowerCase()) || '');\r\n            return osAndroid && (osAndroid == 'android' || (osAndroid[0] == 'android')) ? 'android' : osAll;\r\n        } catch (err) {\r\n            return 'unknown'\r\n        }\r\n    }\r\n\r\n    public isDesktop(): boolean {\r\n        return this.platform == 'desktop';\r\n    }\r\n\r\n    public isMobile(): boolean {\r\n        return this.platform == 'mobile';\r\n    }\r\n\r\n    // Todo: complete implementation\r\n    public isCordova(): boolean {\r\n        return false;\r\n    }\r\n\r\n    // Todo: Move to errors\r\n    public isSupported(supported?: any): boolean {\r\n        if (!supported) \r\n            supported = {\r\n                edge: 11,\r\n                ie: 11,\r\n                firefox: 43, //4, for testing\r\n                opera: 35,\r\n                chrome: 47\r\n            };\r\n\r\n        let browser = this.browserName;\r\n        let version = this.browserVersion;\r\n        version = version.split(\".\")[0]\r\n\r\n        if (browser && supported[browser] && version >= supported[browser]) \r\n            return true;\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\n\r\nangular\r\n    .module('pipSystemInfo', [])\r\n    .service('pipSystemInfo', SystemInfo);\r\n","'use strict';\r\n\r\nexport interface ITags {\r\n    normalizeOne(tag: string): string;\r\n    compressOne(tag: string): string;\r\n    equal(tag1: string, tag2: string): boolean;\r\n    normalizeAll(tags: any): string[];\r\n    compressAll(tags: any): string[];\r\n    extract(entity: any, searchFields?: string[]): string[];\r\n}\r\n\r\n\r\nclass Tags implements ITags {\r\n\r\n    public normalizeOne(tag: string): string {\r\n        return tag \r\n            ? _.trim(tag.replace(/(_|#)+/g, ' '))\r\n            : null;\r\n    }\r\n\r\n    public compressOne(tag: string): string {\r\n        return tag\r\n            ? tag.replace(/( |_|#)/g, '').toLowerCase()\r\n            : null;\r\n    }\r\n\r\n    public equal(tag1: string, tag2: string): boolean {\r\n        if (tag1 == null && tag2 == null)\r\n            return true;\r\n        if (tag1 == null || tag2 == null)\r\n            return false;\r\n        return this.compressOne(tag1) == this.compressOne(tag2);\r\n    }\r\n\r\n    public normalizeAll(tags: any): string[] {\r\n        if (_.isString(tags))\r\n            tags = tags.split(/( |,|;)+/);\r\n\r\n        tags = _.map(tags, (tag: string) => this.normalizeOne(tag));\r\n\r\n        return tags;\r\n    }\r\n\r\n    public compressAll(tags: any): string[] {\r\n        if (_.isString(tags))\r\n            tags = tags.split(/( |,|;)+/);\r\n\r\n        tags = _.map(tags, (tag: string) => this.compressOne(tag));\r\n\r\n        return tags;\r\n    }\r\n\r\n    public extract(entity: any, searchFields?: string[]): string[] {\r\n        let tags = this.normalizeAll(entity.tags);\r\n\r\n        _.each(searchFields, (field) => {\r\n            let text = entity[field] || '';\r\n\r\n            if (text != '') {\r\n                let hashTags = text.match(/#\\w+/g);\r\n                tags = tags.concat(this.normalizeAll(hashTags));\r\n            }\r\n        });\r\n\r\n        return _.uniq(tags);\r\n    }\r\n}\r\n\r\n\r\nangular\r\n    .module('pipTags', [])\r\n    .service('pipTags', Tags);\r\n","'use strict';\r\n\r\nexport interface ITimerService {\r\n    isStarted(): boolean;\r\n\r\n    addEvent(event: string, timeout: number): void;\r\n    removeEvent(event: string): void;\r\n    clearEvents(): void;\r\n\r\n    start(): void;\r\n    stop(): void;\r\n}\r\n\r\n\r\nclass TimerEvent {\r\n    public event: string;\r\n    public timeout: number;\r\n    public interval: any;\r\n\r\n    public constructor(event: string, timeout: number) {\r\n        this.event = event;\r\n        this.timeout = timeout;\r\n    }\r\n}\r\n\r\n\r\nlet DefaultEvents: TimerEvent[] = [\r\n    new TimerEvent('pipAutoPullChanges', 60000), // 1 min\r\n    new TimerEvent('pipAutoUpdatePage', 15000), // 15 sec\r\n    new TimerEvent('pipAutoUpdateCollection', 300000) // 5 min\r\n];\r\n\r\n\r\nclass TimerService implements ITimerService {\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _interval: ng.IIntervalService;        \r\n    private _started = false;\r\n    private _events: TimerEvent[] = _.cloneDeep(DefaultEvents);\r\n\r\n    public constructor(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $interval: ng.IIntervalService\r\n    ) {\r\n        \"ngInject\";\r\n\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._interval = $interval;\r\n    }\r\n\r\n    public isStarted(): boolean {\r\n        return this._started;\r\n    }\r\n\r\n    public addEvent(event: string, timeout: number): void {\r\n        var existingEvent = _.find(this._events, (e) => e.event == event);\r\n        if (existingEvent != null) return;\r\n\r\n        let newEvent = <TimerEvent> {\r\n            event: event,\r\n            timeout: timeout\r\n        };\r\n        this._events.push(newEvent);\r\n\r\n        if (this._started)\r\n            this.startEvent(newEvent);\r\n    }\r\n\r\n    public removeEvent(event: string): void {\r\n        for (let i = this._events.length - 1; i >= 0; i--) {\r\n            let existingEvent = this._events[i];\r\n            if (existingEvent.event == event) {\r\n                this.stopEvent(existingEvent);\r\n                this._events.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    public clearEvents(): void {\r\n        this.stop();\r\n        this._events = [];\r\n    }\r\n\r\n    private startEvent(event: TimerEvent): void {\r\n        event.interval = this._interval(\r\n            () => { \r\n                this._log.debug('Generated timer event ' + event.event); \r\n                this._rootScope.$emit(event.event)\r\n            },\r\n            event.timeout\r\n        )\r\n    }\r\n\r\n    private stopEvent(event: TimerEvent): void {\r\n        if (event.interval != null) {\r\n            try {\r\n                this._interval.cancel(event.interval);\r\n            } catch (ex) {\r\n                // Do nothing\r\n            }\r\n            event.interval = null;\r\n        }\r\n    }\r\n\r\n    public start(): void {\r\n        if (this._started) return;\r\n\r\n        _.each(this._events, (event) => {\r\n            this.startEvent(event);\r\n        });\r\n\r\n        this._started = true;\r\n    }\r\n\r\n    public stop(): void {\r\n        _.each(this._events, (event) => {\r\n            this.stopEvent(event);\r\n        });\r\n\r\n        this._started = false;\r\n    }\r\n}\r\n\r\n\r\nangular.module('pipTimer', [])\r\n    .service('pipTimer', TimerService);\r\n","'use strict';\r\n\r\nimport './Format';\r\nimport './TimerService';\r\nimport './ScrollService';\r\nimport './Tags';\r\nimport './Codes';\r\nimport './SystemInfo';\r\nimport './PageResetService';\r\n\r\nexport * from './Format';\r\nexport * from './TimerService';\r\nexport * from './ScrollService';\r\nexport * from './Tags';\r\nexport * from './Codes';\r\nexport * from './SystemInfo';\r\nexport * from './PageResetService';"]}