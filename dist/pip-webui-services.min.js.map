{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","src/ServicesModule.ts","src/routing/BackDecorator.ts","src/routing/RedirectDecorator.ts","src/routing/RoutingEvents.ts","src/routing/RoutingModule.ts","src/scope/scope.ts","src/scope/scope_error.ts","src/scope/scope_transaction.ts","src/session/IdentityProvider.ts","src/session/IdentityService.ts","src/session/SessionModule.ts","src/session/SessionProvider.ts","src/session/SessionService.ts","src/translate/TranslateDirective.ts","src/translate/TranslateFilter.ts","src/translate/TranslateModule.ts","src/translate/TranslateProvider.ts","src/translate/TranslateService.ts","src/translate/Translation.ts","src/utilities/Codes.ts","src/utilities/Format.ts","src/utilities/PageResetService.ts","src/utilities/ScrollService.ts","src/utilities/SystemInfo.ts","src/utilities/Tags.ts","src/utilities/TimerService.ts","src/utilities/UtilitiesModule.ts"],"names":["f","exports","module","define","amd","g","window","global","self","this","pip","services","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","angular","captureStateTranslations","$rootScope","$on","event","toState","toParams","fromState","fromParams","CurrentState","name","url","params","PreviousState","decorateBackStateService","$delegate","$window","goBack","history","back","state","_","cloneDeep","extend","go","goBackAndSelect","addBackStateDecorator","$provide","decorator","$inject","3","decorateRedirectStateProvider","redirect","RedirectedStates","addRedirectStateProviderDecorator","decorateRedirectStateService","$timeout","isFunction","isNull","preventDefault","transitionTo","location","addRedirectStateDecorator","hookRoutingEvents","$log","$state","RoutingVar","error","unfoundState","5","config","BackDecorator_1","run","BackDecorator_2","RedirectDecorator_1","RoutingEvents_1","./BackDecorator","./RedirectDecorator","./RoutingEvents","6","initError","scope","errors","message","undefined","details","errorMessage","data","statusText","status","errorCode","errorDetails","scopeObject","reset","console","isObject","createError","$injector","has","get","pipTranslate","setTranslations","ENTERING","PROCESSING","LOADING","SAVING","factory","pipError","initTransaction","transactions","id","operation","busy","transaction","failed","empty","Date","getTime","abort","err","set","createTransaction","IdentityService_1","IdentityProvider","_setRootVar","_identity","_service","value","enumerable","configurable","prototype","$get","IdentityService","10","IdentityRootVar","IdentityChangedEvent","setRootVar","identity","_rootScope","_log","$emit","debug","full_name","11","IdentityProvider_1","SessionProvider_1","SessionProvider","./SessionProvider","12","SessionService_1","_session","SessionService","13","SessionRootVar","SessionOpenedEvent","SessionClosedEvent","session","Object","defineProperty","isOpened","open","fullReset","partialReset","close","oldSession","restrict","key1","key2","link","element","attrs","key","translate","text","html","translateDirective","translateHtmlDirective","15","translateFilter","optionalTranslateFilter","16","TranslateProvider_1","provider","TranslateProvider","filter","TranslateFilter_1","directive","TranslateDirective_1","TranslateDirective_2","./TranslateFilter","./TranslateProvider","17","__extends","d","b","__","constructor","p","hasOwnProperty","create","_super","_persist","TranslateService_1","TranslateService","Translation","./Translation","18","LanguageChangedEvent","translation","persist","_translation","_window","localStorage","language","getItem","save","LanguageRootVar","setItem","PageResetService_1","ResetPageEvent","use","translations","translateArray","keys","translateSet","keyProp","valueProp","translateObjects","items","translateWithPrefix","prefix","translateSetWithPrefix","translateSetWithPrefix2","19","en","ru","es","pt","de","fr","_language","map","_translations","isUndefined","values","each","k","push","item","replace","toUpperCase","Codes","hash","result","charCodeAt","verification","Math","random","toString","substr","Format","cache","sample","maxLength","indexOf","substring","strRepeat","str","qty","getType","variable","slice","toLowerCase","parseFormat","fmt","match","parse_tree","arg_names","exec","_fmt","replacement_field","field_match","field_list","format","argv","tree_length","node_type","arg","cursor","sprintf","test","String","fromCharCode","parseInt","toExponential","parseFloat","toFixed","abs","pad_character","charAt","pad","pad_length","output","join","_i","arguments","args","hookResetEvents","pipPageReset","ResetAreaEvent","area","resetArea","ResetRootVar","ResetAreaRootVar","PageResetService","_timeout","performReset","_this","ScrollService","scrollTo","parentElement","childElement","animationDuration","setTimeout","$","position","modDiff","scrollTop","top","animate","SystemInfo","ua","navigator","userAgent","search","browser","browserName","version","split","osAll","osAndroid","isDesktop","platform","isMobile","isCordova","isSupported","supported","edge","ie","firefox","opera","browserVersion","Tags","normalizeOne","tag","trim","compressOne","equal","tag1","tag2","normalizeAll","tags","isString","compressAll","extract","entity","searchFields","field","hashTags","concat","uniq","26","TimerEvent","timeout","TimerService","$interval","_started","_events","DefaultEvents","_interval","isStarted","addEvent","existingEvent","find","newEvent","startEvent","removeEvent","stopEvent","splice","clearEvents","interval","cancel","ex","start","stop","27","Format_1","Tags_1","TimerService_1","service","Codes_1","SystemInfo_1","ScrollService_1","PageResetService_2"],"mappings":"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","file":"pip-webui-services.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","﻿'use strict';\r\n\r\nimport './translate/TranslateModule';\r\nimport './session/SessionModule';\r\nimport './routing/RoutingModule';\r\nimport './utilities/UtilitiesModule';\r\n\r\nangular.module('pipServices', [\r\n    'pipTranslate',\r\n    'pipSession',\r\n    'pipScope',\r\n    'pipRouting',\r\n    'pipUtils'\r\n]);\r\n","'use strict';\r\n\r\nexport let CurrentState: any;\r\nexport let PreviousState: any;\r\n\r\nexport function captureStateTranslations($rootScope: ng.IRootScopeService) {\r\n    \"ngInject\";\r\n\r\n    $rootScope.$on('$stateChangeSuccess',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            CurrentState = {\r\n                name: toState.name, \r\n                url: toState.url, \r\n                params: toParams\r\n            };\r\n\r\n            PreviousState = {\r\n                name: fromState.name, \r\n                url: fromState.url, \r\n                params: fromParams\r\n            };\r\n        }\r\n    );\r\n\r\n}\r\n\r\nfunction decorateBackStateService($delegate, $window: ng.IWindowService) {\r\n    \"ngInject\";\r\n\r\n    $delegate.goBack = goBack;\r\n    $delegate.goBackAndSelect = goBackAndSelect;\r\n\r\n    return $delegate;\r\n    //////////////////////////////////////////////////\r\n\r\n    function goBack(): void {\r\n        $window.history.back()\r\n    }\r\n\r\n    function goBackAndSelect(params: any): void {\r\n        if (PreviousState != null \r\n            && PreviousState.name != null) {\r\n\r\n            let state = _.cloneDeep(PreviousState);\r\n\r\n            // Override selected parameters\r\n            state.params = _.extend(state.params, params);\r\n\r\n            $delegate.go(state.name, state.params);\r\n        } else {\r\n            $window.history.back();\r\n        }\r\n    }\r\n}\r\n\r\nexport function addBackStateDecorator($provide) {\r\n    $provide.decorator('$state', decorateBackStateService);\r\n}\r\n\r\n","'use strict';\r\n\r\nexport let RedirectedStates: any = {};\r\n\r\nfunction decorateRedirectStateProvider($delegate) {\r\n    \"ngInject\";\r\n\r\n    $delegate.redirect = redirect;\r\n\r\n    return $delegate;\r\n    /////////////////////////////////////////////\r\n\r\n    // Specify automatic redirect from one state to another\r\n    function redirect(fromState, toState) {\r\n        RedirectedStates[fromState] = toState;  \r\n        return this;\r\n    }\r\n}\r\n\r\nexport function addRedirectStateProviderDecorator($provide) {\r\n    \"ngInject\";\r\n\r\n    $provide.decorator('$state', decorateRedirectStateProvider);\r\n}\r\n\r\nfunction decorateRedirectStateService($delegate, $timeout) {\r\n    \"ngInject\";\r\n\r\n    $delegate.redirect = redirect;\r\n    \r\n    return $delegate;\r\n    ////////////////////////////////\r\n    \r\n    // Todo: Move this code directly to event handler?\r\n    // Todo: Nothing calls this code!!\r\n    function redirect(event, state, params) {\r\n        let toState = RedirectedStates[state.name];\r\n        if (_.isFunction(toState)) {\r\n            toState = toState(state.name, params);\r\n\r\n            if (_.isNull(toState))\r\n                throw new Error('Redirected toState cannot be null');\r\n        }\r\n\r\n        if (!!toState) {\r\n            $timeout(() => {\r\n                event.preventDefault();\r\n                $delegate.transitionTo(toState, params, {location: 'replace'});\r\n            });\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\r\n\r\nexport function addRedirectStateDecorator($provide) {\r\n    \"ngInject\";\r\n\r\n    $provide.decorator('$state', decorateRedirectStateService);\r\n}\r\n\r\n","'use strict';\r\n\r\nexport let RoutingVar: string = \"$routing\";\r\n\r\nexport function hookRoutingEvents(\r\n    $rootScope: ng.IRootScopeService,\r\n    $log: ng.ILogService,\r\n    $state: ng.ui.IStateService\r\n) {\r\n    \"ngInject\";\r\n\r\n    $rootScope.$on('$stateChangeStart',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            $rootScope[RoutingVar] = true;\r\n        }\r\n    );\r\n\r\n    $rootScope.$on('$stateChangeSuccess',\r\n        (event, toState, toParams, fromState, fromParams) => {\r\n            // Unset routing variable to disable page transition\r\n            $rootScope[RoutingVar] = false;                \r\n        }\r\n    );\r\n\r\n    // Intercept route error\r\n    $rootScope.$on('$stateChangeError',\r\n        (event, toState, toParams, fromState, fromParams, error) => {\r\n            // Unset routing variable to disable page transition\r\n            $rootScope[RoutingVar] = false;\r\n\r\n            $log.error('Error while switching route to ' + toState.name);\r\n            $log.error(error);\r\n        }\r\n    );\r\n\r\n    // Intercept route error\r\n    $rootScope.$on('$stateNotFound',\r\n        function(event, unfoundState, fromState, fromParams) {\r\n            event.preventDefault();\r\n\r\n            $rootScope[RoutingVar] = false;\r\n\r\n            // Todo: Move to errors\r\n            $state.go('errors_missing_route',  {\r\n                    unfoundState: unfoundState,\r\n                    fromState : {\r\n                        to: fromState ? fromState.name : '',\r\n                        fromParams: fromParams\r\n                    }\r\n                }\r\n            );\r\n        }\r\n    );\r\n\r\n}\r\n\r\n","'use strict';\r\n\r\nimport { addBackStateDecorator } from './BackDecorator';\r\nimport { captureStateTranslations } from './BackDecorator';\r\nimport { addRedirectStateDecorator } from './RedirectDecorator';\r\nimport { addRedirectStateProviderDecorator } from './RedirectDecorator';\r\nimport { hookRoutingEvents } from './RoutingEvents';\r\n\r\nangular\r\n    .module('pipRouting', ['ui.router'])\r\n    .config(addBackStateDecorator)\r\n    .run(captureStateTranslations)\r\n    .config(addRedirectStateProviderDecorator)\r\n    .config(addRedirectStateDecorator)\r\n    .run(hookRoutingEvents);\r\n    ","'use strict';\r\n\r\nangular.module('pipScope', ['pipTranslate', 'pipScope.Error', 'pipScope.Transaction']);\r\nangular.module('pipTransactions', ['pipScope']);\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipScope.Error', []);\r\n\r\n/*\r\n    * Error is designed to assist with error handling\r\n    * within different application scopes & controllers without overlap.\r\n    *\r\n    * A unique identification of the scope/controller is passed to the service\r\n    * when it is initialized to identify the error for that scope.\r\n    * */\r\nthisModule.factory('pipError',\r\n    function ($rootScope) {\r\n\r\n        // Initialize error scope\r\n        $rootScope.errors = {};\r\n\r\n        return createError;\r\n\r\n        //----------------------------\r\n\r\n        function initError(scope) {\r\n            $rootScope.errors[scope] = {\r\n                message: undefined,\r\n                code: undefined,\r\n                details: undefined\r\n            };\r\n        };\r\n\r\n        function errorMessage(error) {\r\n            if (_.isNull(error)) {\r\n                return null;\r\n            }\r\n\r\n            // Process regular messages\r\n            if (error.message) {\r\n                return error.message;\r\n            }\r\n\r\n            // Process server application errors\r\n            if (error.data) {\r\n                if (error.data.code) {\r\n                    // process server error codes here\r\n                    return 'ERROR_' + error.data.code;\r\n                }\r\n\r\n                if (error.data.message) {\r\n                    return error.data.message;\r\n                }\r\n            }\r\n\r\n            // Process standard HTTP errors\r\n            if (error.statusText) {\r\n                return error.statusText;\r\n            }\r\n\r\n            if (error.status) {\r\n                return 'ERROR_' + error.status;\r\n            }\r\n            \r\n            return error.data ? error.data : error;\r\n        };\r\n\r\n        function errorCode(error) {\r\n            if (_.isNull(error)) {\r\n                return null;\r\n            }\r\n\r\n            if (error.data && error.data.code) {\r\n                return error.data.code;\r\n            }\r\n\r\n            if (error.status) {\r\n                return error.status;\r\n            }\r\n            \r\n            return null;\r\n        };\r\n\r\n        function errorDetails(error) {\r\n            return error && error.data ? error.data : error;\r\n        };\r\n\r\n        function createError(scope, scopeObject) {\r\n            scope = scope || 'global';\r\n\r\n            var error = {\r\n                reset: function () {\r\n                    initError(scope);\r\n                },\r\n\r\n                empty: function() {\r\n                    var error = $rootScope.errors[scope];\r\n                    return _.isNull(error) || (_.isNull(error.message) && _.isNull(error.code));\r\n                },\r\n\r\n                get: function () {\r\n                    if ($rootScope.errors[scope]) {\r\n                        return $rootScope.errors[scope];\r\n                    }\r\n                    return '';\r\n                },\r\n\r\n                message: function () {\r\n                    if ($rootScope.errors[scope]) {\r\n                        return $rootScope.errors[scope].message;\r\n                    }\r\n                    return null;\r\n                },\r\n\r\n                code: function () {\r\n                    if ($rootScope.errors[scope]) {\r\n                        return $rootScope.errors[scope].code;\r\n                    }\r\n                    return null;\r\n                },\r\n\r\n                details: function () {\r\n                    if ($rootScope.errors[scope]) {\r\n                        return $rootScope.errors[scope].details;\r\n                    }\r\n                    return null;\r\n                },\r\n\r\n                set: function (error) {\r\n                    if (error) {\r\n                        //pipAssert.isObject(error, \"Setting error: error should be an object\");\r\n\r\n                        $rootScope.errors[scope] = {\r\n                            message: errorMessage(error),\r\n                            code: errorCode(error),\r\n                            details: errorDetails(error)\r\n                        };\r\n                        console.error($rootScope.errors[scope]);\r\n                    } else {\r\n                        initError(scope);\r\n                    }\r\n                }\r\n            };\r\n\r\n            // Assign error into scope\r\n            if (_.isObject(scopeObject)) scopeObject.error = error;\r\n\r\n            return error;\r\n        };\r\n    }\r\n);\r\n","'use strict';\r\n\r\nvar thisModule = angular.module('pipScope.Transaction', ['pipTranslate']);\r\n\r\nthisModule.run(function($injector) {\r\n    var pipTranslate = $injector.has('pipTranslate') ? $injector.get('pipTranslate') : null;\r\n    if (pipTranslate) {\r\n        pipTranslate.setTranslations('en', {\r\n            'ENTERING': 'Entering...',\r\n            'PROCESSING': 'Processing...',\r\n            'LOADING': 'Loading...',\r\n            'SAVING': 'Saving...'\r\n        });\r\n\r\n        pipTranslate.setTranslations('ru', {\r\n            'ENTERING': 'Вход в систему...',\r\n            'PROCESSING': 'Обрабатывается...',\r\n            'LOADING': 'Загружается...',\r\n            'SAVING': 'Сохраняется...'\r\n        });   \r\n    }\r\n    \r\n});\r\n\r\n/*\r\n    * Transaction is designed to assist with transaction processing\r\n    * within different application scopes & controllers without overlap.\r\n    *\r\n    * A unique identification of the scope/controller is passed to the service\r\n    * when it is initialized to identify the error for that scope.\r\n    * \r\n    * Transaction is also integrated with Error service. So you don't need to double it\r\n    * */\r\nthisModule.factory('pipTransaction',\r\n    function ($rootScope, pipError) {\r\n\r\n        // Initialize transaction scope\r\n        $rootScope.transactions = {};\r\n\r\n        return createTransaction;\r\n\r\n        //---------------------------------\r\n\r\n        function initTransaction(scope) {\r\n            $rootScope.transactions[scope] = {\r\n                id: undefined,\r\n                operation: undefined\r\n            };\r\n        }\r\n        \r\n        function createTransaction(scope, scopeObject) {\r\n            scope = scope || 'global';\r\n\r\n            var error = pipError(scope);\r\n            var transaction = {\r\n                error: error,\r\n\r\n                reset: function () {\r\n                    initTransaction(\"\");\r\n                    error.reset();\r\n                },\r\n\r\n                busy: function() {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    return transaction != null && transaction.id;\r\n                },\r\n\r\n                failed: function() {\r\n                    return !error.empty();\r\n                },\r\n\r\n                aborted: function(id) {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    return _.isNull(transaction) || transaction.id != id;\r\n                },\r\n\r\n                get: function () {\r\n                    if (_.isNull($rootScope.transactions[scope])) {\r\n                        initTransaction(scope);\r\n                    }\r\n                    return $rootScope.transactions[scope];\r\n                },\r\n\r\n                id: function () {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    return transaction ? transaction.id : null;\r\n                },\r\n\r\n                operation: function () {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    return transaction ? transaction.operation : null;\r\n                },\r\n\r\n                errorMessage: function () {\r\n                    return error.message();\r\n                },\r\n\r\n                begin: function (operation) {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    // Transaction already in progress\r\n                    if (transaction != null && transaction.id) {\r\n                        return null;\r\n                    }                      \r\n\r\n                    transaction = $rootScope.transactions[scope] = {\r\n                        id: new Date().getTime(),\r\n                        operation: operation || 'PROCESSING'\r\n                    };\r\n                    error.reset();\r\n\r\n                    return transaction.id;\r\n                },\r\n\r\n                abort: function() {\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    if (transaction) {\r\n                        transaction.id = null;\r\n                    }\r\n                    error.reset();\r\n                },\r\n\r\n                end: function (err) {\r\n                    if (err) error.set(err);\r\n                    else error.reset();\r\n\r\n                    var transaction = $rootScope.transactions[scope];\r\n                    if (transaction != null) {\r\n                        transaction.id = null;\r\n                    }                      \r\n                }\r\n            };\r\n\r\n            if (_.isObject(scopeObject)) {\r\n                scopeObject.error = error;\r\n                scopeObject.transaction = transaction;\r\n            }\r\n\r\n            return transaction;\r\n        }\r\n    }\r\n);\r\n","'use strict';\r\n\r\nimport { IIdentity } from './IdentityService';\r\nimport { IdentityService } from './IdentityService';\r\n\r\nexport interface IIdentityProvider extends ng.IServiceProvider {\r\n    setRootVar: boolean;\r\n    identity: IIdentity;\r\n}\r\n\r\nexport class IdentityProvider implements IdentityProvider {\r\n    private _setRootVar = true;\r\n    private _identity: IIdentity = null;\r\n    private _service: IdentityService = null;\r\n\r\n    public constructor() { }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get identity(): any {\r\n        return this._identity;  \r\n    }\r\n\r\n    public set identity(value: any) {\r\n        this._identity = value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null)\r\n            this._service = new IdentityService(this._setRootVar, this._identity, $rootScope, $log);\r\n\r\n        return this._service;\r\n    }\r\n\r\n}\r\n","'use strict';\r\n\r\nexport let IdentityRootVar = \"$identity\";\r\nexport let IdentityChangedEvent = \"pipIdentityChanged\";\r\n\r\nexport interface IIdentity {\r\n    id: string;\r\n    full_name: string;\r\n    details: string;\r\n    email: string;\r\n    photo_url: string;\r\n}\r\n\r\nexport interface IIdentityService {\r\n    identity: IIdentity;\r\n}\r\n\r\nexport class IdentityService implements IIdentityService {\r\n    private _identity: IIdentity;\r\n    private _setRootVar: boolean;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n\r\n    public constructor(\r\n        setRootVar: boolean,\r\n        identity: IIdentity,\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._identity = identity;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n\r\n        this.setRootVar();\r\n    }\r\n\r\n    private setRootVar(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[IdentityRootVar] = this._identity;\r\n    }\r\n\r\n    public get identity(): IIdentity {\r\n        return this._identity;\r\n    }\r\n\r\n    public set identity(value: IIdentity) {\r\n        this._identity = value;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(IdentityChangedEvent, this._identity);\r\n\r\n        let identity: IIdentity = value || <IIdentity>{};\r\n        this._log.debug(\"Changed identity to \" + identity.id + \" \" + identity.full_name);\r\n    }\r\n}\r\n","'use strict';\r\n\r\nimport { IdentityProvider } from './IdentityProvider';\r\nimport { SessionProvider } from './SessionProvider';\r\n\r\nangular\r\n    .module('pipSession', [])\r\n    .provider('pipIdentity', IdentityProvider)\r\n    .provider('pipSession', SessionProvider); \r\n","'use strict';\r\n\r\nimport { SessionService } from './SessionService';\r\n\r\nexport interface ISessionProvider extends ng.IServiceProvider {\r\n    setRootVar: boolean;\r\n    session: any;\r\n}\r\n\r\nexport class SessionProvider implements ISessionProvider {\r\n    private _setRootVar = true;\r\n    private _session: any = null;\r\n    private _service: SessionService = null;\r\n\r\n    public constructor() { }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get session(): any {\r\n        return this._session;  \r\n    }\r\n\r\n    public set session(value: any) {\r\n        this._session = value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null)\r\n            this._service = new SessionService(this._setRootVar, this._session, $rootScope, $log);\r\n\r\n        return this._service;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport const SessionRootVar = \"$session\";\r\nexport const SessionOpenedEvent = \"pipSessionOpened\";\r\nexport const SessionClosedEvent = \"pipSessionClosed\";\r\n\r\nexport interface ISessionService {\r\n    session: any;\r\n    isOpened(): boolean;\r\n\r\n    open(session: any): void;\r\n    close(): void;\r\n}\r\n\r\nexport class SessionService implements ISessionService {\r\n    private _setRootVar: boolean;\r\n    private _session: any;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n\r\n    public constructor(\r\n        setRootVar: boolean, \r\n        session: any, \r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._session = session;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n\r\n        this.setRootVar();\r\n    }\r\n    \r\n    private setRootVar(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[SessionRootVar] = this._session;\r\n    }\r\n\r\n    public get session(): any {\r\n        return this._session;\r\n    }\r\n\r\n    public isOpened(): boolean {\r\n        return this._session != null;\r\n    }\r\n\r\n    public open(session: any, fullReset: boolean = false, partialReset: boolean = false) {\r\n        if (session == null)\r\n            throw new Error(\"Session cannot be null\");\r\n\r\n        this._session = session;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(SessionOpenedEvent, session);\r\n\r\n        this._log.debug(\"Opened session \" + session);\r\n    }\r\n\r\n    public close(fullReset: boolean = false, partialReset: boolean = false) {\r\n        let oldSession = this._session;\r\n\r\n        this._session = null;\r\n        this.setRootVar();\r\n        this._rootScope.$emit(SessionClosedEvent, oldSession);\r\n\r\n        this._log.debug(\"Closed session \" + oldSession);\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport function translateDirective(pipTranslate): ng.IDirective {\r\n    \"ngInject\";\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            key1: '@pipTranslate',\r\n            key2: '@key'\r\n        },\r\n        link: (scope: any, element: any, attrs: any) => {\r\n            let key = scope.key1 || scope.key2;\r\n            let value = pipTranslate.translate(key);\r\n            element.text(value);\r\n        }\r\n    };\r\n}\r\n\r\nexport function translateHtmlDirective(pipTranslate): ng.IDirective {\r\n    \"ngInject\";\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            key1: '@pipTranslateHtml',\r\n            key2: '@key'\r\n        },\r\n        link: (scope: any, element: any, attrs: any) => {\r\n            let key = scope.key1 || scope.key2;\r\n            let value = pipTranslate.translate(key);\r\n            element.html(value);\r\n        }\r\n    };\r\n}\r\n","'use strict';\r\n\r\nexport function translateFilter(pipTranslate) {\r\n    \"ngInject\";\r\n\r\n    return function (key) {\r\n        return pipTranslate.translate(key) || key;\r\n    }\r\n}\r\n\r\nexport function optionalTranslateFilter($injector) {\r\n    \"ngInject\";\r\n\r\n    let pipTranslate = $injector.has('pipTranslate') \r\n        ? $injector.get('pipTranslate') : null;\r\n\r\n    return function (key) {\r\n        return pipTranslate  ? pipTranslate.translate(key) || key : key;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nimport { TranslateProvider } from './TranslateProvider';\r\nimport { translateFilter } from './TranslateFilter';\r\nimport { translateDirective } from './TranslateDirective';\r\nimport { translateHtmlDirective } from './TranslateDirective';\r\n\r\nangular\r\n    .module('pipTranslate', [])\r\n    .provider('pipTranslate', TranslateProvider)\r\n    .filter('translate', translateFilter)\r\n    .directive('pipTranslate', translateDirective)\r\n    .directive('pipTranslateHtml', translateHtmlDirective);\r\n","'use strict';\r\n\r\nimport { Translation } from './Translation';\r\nimport { ITranslateService } from './TranslateService';\r\nimport { TranslateService } from './TranslateService';\r\n\r\nexport interface ITranslateProvider extends ITranslateService, ng.IServiceProvider {\r\n}\r\n\r\nexport class TranslateProvider extends Translation implements ITranslateProvider {\r\n    private _translation: Translation;\r\n    private _setRootVar: boolean = true;\r\n    private _persist: boolean = true;\r\n    private _service: TranslateService;\r\n    \r\n    public constructor() {\r\n        super();\r\n    }\r\n\r\n    public get setRootVar(): boolean {\r\n        return this._setRootVar;  \r\n    }\r\n\r\n    public set setRootVar(value: boolean) {\r\n        this._setRootVar = !!value;\r\n    }\r\n\r\n    public get persist(): boolean {\r\n        return this._persist;  \r\n    }\r\n\r\n    public set persist(value: boolean) {\r\n        this._persist = !!value;\r\n    }\r\n\r\n    public $get(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $window: ng.IWindowService\r\n    ): any {\r\n        \"ngInject\";\r\n\r\n        if (this._service == null) \r\n            this._service = new TranslateService(this, this._setRootVar, this._persist, $rootScope, $log, $window);\r\n\r\n        return this._service;\r\n    }\r\n}\r\n","﻿'use strict';\r\n\r\nimport { Translation } from './Translation';\r\nimport { ResetPageEvent } from '../utilities/PageResetService';\r\n\r\nexport let LanguageRootVar = \"$language\";\r\nexport let LanguageChangedEvent = \"pipLanguageChanged\";    \r\n\r\nexport interface ITranslateService {\r\n    language: string;\r\n\r\n    use(language: string): string;\r\n    setTranslations(language: string, translations: any): void;\r\n    translations(language: string, translations: any): void;\r\n\r\n    translate(key: string): string;\r\n    translateArray(keys: string[]): string[];\r\n    translateSet(keys: string[], keyProp: string, valueProp: string): any[];\r\n    translateObjects(items: any[], keyProp: string, valueProp: string): any[];\r\n    translateWithPrefix(prefix: string, key: string);\r\n    translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string);\r\n    translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string);\r\n}\r\n\r\nexport class TranslateService implements ITranslateService {\r\n    private _translation: Translation;\r\n    private _setRootVar: boolean;\r\n    private _persist: boolean;\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _window: ng.IWindowService;\r\n\r\n    public constructor(\r\n        translation: Translation,\r\n        setRootVar: boolean,\r\n        persist: boolean,\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService,\r\n        $window: ng.IWindowService\r\n    ) {\r\n        this._setRootVar = setRootVar;\r\n        this._persist = persist;\r\n        this._translation = translation;\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._window = $window;\r\n\r\n        if (this._persist && this._window.localStorage)\r\n            this._translation.language = this._window.localStorage.getItem('language') || this._translation.language;\r\n\r\n        this._log.debug(\"Set language to \" + this._translation.language);\r\n\r\n        this.save();\r\n    }\r\n\r\n    private save(): void {\r\n        if (this._setRootVar)\r\n            this._rootScope[LanguageRootVar] = this._translation.language;\r\n\r\n        if (this._persist && this._window.localStorage != null)\r\n            this._window.localStorage.setItem('language', this._translation.language);\r\n    }\r\n\r\n    public get language(): string {\r\n        return this._translation.language;\r\n    }\r\n\r\n    public set language(value: string) {\r\n        if (value != this._translation.language) {\r\n            this._translation.language = value;\r\n            \r\n            this._log.debug(\"Changing language to \" + value);\r\n\r\n            this.save();                \r\n\r\n            this._rootScope.$emit(LanguageChangedEvent, value);\r\n            this._rootScope.$emit(ResetPageEvent);\r\n        }\r\n    }\r\n\r\n    public use(language: string): string {\r\n        if (language != null)\r\n            this.language = language;\r\n        return this.language;\r\n    }\r\n\r\n    public setTranslations(language: string, translations: any): void {\r\n        return this._translation.setTranslations(language, translations);\r\n    }\r\n\r\n    public translations(language: string, translations: any): void {\r\n        return this._translation.setTranslations(language, translations);\r\n    }\r\n\r\n    public translate(key: string): string {\r\n        return this._translation.translate(key);\r\n    }\r\n\r\n    public translateArray(keys: string[]): string[] {\r\n        return this._translation.translateArray(keys);\r\n    }\r\n    \r\n    public translateSet(keys: string[], keyProp: string, valueProp: string): any[] {\r\n        return this._translation.translateSet(keys, keyProp, valueProp);\r\n    }\r\n\r\n    public translateObjects(items: any[], keyProp: string, valueProp: string): any[] {\r\n        return this._translation.translateObjects(items, keyProp, valueProp);\r\n    }\r\n\r\n    public translateWithPrefix(prefix: string, key: string) {\r\n        return this._translation.translateWithPrefix(prefix, key);\r\n    }\r\n\r\n    public translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        return this._translation.translateSetWithPrefix(prefix, keys, keyProp, valueProp);\r\n    }\r\n\r\n    public translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        return this._translation.translateSetWithPrefix2(prefix, keys, keyProp, valueProp);\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport class Translation {\r\n    protected _language = 'en';\r\n    protected _translations = {\r\n        en: {\r\n            'en': 'English',\r\n            'ru': 'Russian',\r\n            'es': 'Spanish',\r\n            'pt': 'Portuguese',\r\n            'de': 'German',\r\n            'fr': 'French'\r\n        },\r\n        ru: {\r\n            'en': 'Английский',\r\n            'ru': 'Русский',\r\n            'es': 'Испанский',\r\n            'pt': 'Португальский',\r\n            'de': 'Немецкий',\r\n            'fr': 'Французский'\r\n        }\r\n    };\r\n\r\n    public constructor() {}\r\n\r\n    public get language(): string { return this._language; }\r\n    public set language(value: string) { this._language = value; }\r\n\r\n    public use(language: string): string {\r\n        if (language != null)\r\n            this._language = language;\r\n        return this._language;\r\n    }\r\n\r\n    // Set translation strings for specific language\r\n    public setTranslations(language: string, translations: any): void {\r\n        let map = this._translations[language] || {};\r\n        this._translations[language] = _.extend(map, translations);\r\n    }\r\n\r\n    // Yet another method to set translation strings for specific language\r\n    public translations(language: string, translations: any): void {\r\n        this.setTranslations(language, translations);\r\n    }\r\n\r\n    // Translate a string by key using set language\r\n    public translate(key: string): string {\r\n        if (_.isNull(key) || _.isUndefined(key)) return '';\r\n\r\n        let translations = this._translations[this._language] || {};\r\n        return translations[key] || key;\r\n    }\r\n\r\n    // Translate an array of strings\r\n    public translateArray(keys: string[]): string[] {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (k) {\r\n            let key = k || '';\r\n            values.push(translations[key] || key);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate an array of strings into array of objects (set)\r\n    public translateSet(keys: string[], keyProp: string, valueProp: string): any[] {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n\r\n        let values: any[] = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {};\r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[key] || key;\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate a collection of objects\r\n    public translateObjects(items: any[], keyProp: string, valueProp: string): any[] {\r\n        if (_.isNull(items) || items.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'name';\r\n        valueProp = valueProp || 'nameLocal';\r\n\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(items, function (item) {\r\n            let key = item[keyProp] || '';\r\n\r\n            item[valueProp] = translations[key] || key;\r\n        });\r\n\r\n        return items;\r\n    }\r\n\r\n    // Translate a string by key  with prefix using set language todo\r\n    public translateWithPrefix(prefix: string, key: string) {\r\n        prefix = prefix ? prefix + '_' : '';\r\n        key = (prefix + key).replace(/ /g, '_').toUpperCase();\r\n        if (key == null) return '';\r\n        let translations = this._translations[this._language] || {};\r\n        return translations[key] || key;\r\n    };\r\n\r\n    public translateSetWithPrefix(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() : '';\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {}; \r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[prefix + '_' + key] || key;\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    // Translate an array of strings, apply uppercase and replace ' ' => '_'\r\n    public translateSetWithPrefix2(prefix: string, keys: string[], keyProp: string, valueProp: string) {\r\n        if (_.isNull(keys) || keys.length == 0) return [];\r\n\r\n        keyProp = keyProp || 'id';\r\n        valueProp = valueProp || 'name';\r\n        prefix = prefix ? prefix.replace(/ /g, '_').toUpperCase() + '_': '';\r\n\r\n        let values = [];\r\n        let translations = this._translations[this._language] || {};\r\n\r\n        _.each(keys, function (key) {\r\n            let value: any = {};\r\n            key = key || '';\r\n\r\n            value[keyProp] = key;\r\n            value[valueProp] = translations[prefix + key.replace(/ /g, '_').toUpperCase()]\r\n                || (prefix + key.replace(/ /g, '_').toUpperCase());\r\n\r\n            values.push(value);\r\n        });\r\n\r\n        return values;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport interface ICodes {\r\n    // Simple version of string hashcode\r\n    hash(value: string): number;\r\n    // Generates random big number for verification codes\r\n    verification(): string;\r\n}\r\n\r\nexport class Codes implements ICodes {\r\n    // Simple version of string hashcode\r\n    public hash(value: string): number {\r\n        if (value == null) return 0;\r\n        \r\n        let result = 0;\r\n        for (let i = 0; i < value.length; i++)\r\n            result += value.charCodeAt(i);\r\n\r\n        return result;\r\n    }\r\n\r\n    // Generates random big number for verification codes\r\n    public verification(): string {\r\n        return Math.random().toString(36).substr(2, 10).toUpperCase(); // remove `0.`\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport interface IFormat {\r\n    // Creates a sample line from a text\r\n    sample(value: string, maxLength: number): string;\r\n\r\n    sprintf(message: string, ...args: any[]): string;\r\n}\r\n\r\nexport class Format implements IFormat {\r\n    // Cached for parsed formats\r\n    private cache = {};\r\n\r\n    // Creates a sample line from a text\r\n    public sample(value: string, maxLength: number): string {\r\n        if (!value || value == '') return '';\r\n\r\n        var length = value.indexOf('\\n');\r\n        length = length >= 0 ? length : value.length;\r\n        length = length < maxLength ? value.length : maxLength;\r\n\r\n        return value.substring(0, length);\r\n    }\r\n\r\n    private strRepeat(str: string, qty: number): string {\r\n        if (qty < 1) return '';\r\n        var result = '';\r\n        while (qty > 0) {\r\n            if (qty & 1) result += str;\r\n            qty >>= 1, str += str;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private getType(variable) {\r\n        return toString.call(variable).slice(8, -1).toLowerCase();\r\n    }\r\n\r\n    private parseFormat(fmt: string) {\r\n        let _fmt = fmt, match = [], parse_tree = [], arg_names = 0;\r\n        while (_fmt) {\r\n            if ((match = /^[^\\x25]+/.exec(_fmt)) !== null) {\r\n                parse_tree.push(match[0]);\r\n            }\r\n            else if ((match = /^\\x25{2}/.exec(_fmt)) !== null) {\r\n                parse_tree.push('%');\r\n            }\r\n            else if ((match = /^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt)) !== null) {\r\n                if (match[2]) {\r\n                    arg_names |= 1;\r\n                    var field_list = [], replacement_field = match[2], field_match = [];\r\n                    if ((field_match = /^([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                        field_list.push(field_match[1]);\r\n                        while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {\r\n                            if ((field_match = /^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field)) !== null) {\r\n                                field_list.push(field_match[1]);\r\n                            }\r\n                            else if ((field_match = /^\\[(\\d+)\\]/.exec(replacement_field)) !== null) {\r\n                                field_list.push(field_match[1]);\r\n                            }\r\n                            else {\r\n                                throw new Error('Unknown error');\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        throw new Error('Unknown error');\r\n                    }\r\n                    match[2] = field_list;\r\n                }\r\n                else {\r\n                    arg_names |= 2;\r\n                }\r\n                if (arg_names === 3) {\r\n                    throw new Error('Mixing positional and named placeholders is not (yet) supported');\r\n                }\r\n                parse_tree.push(match);\r\n            }\r\n            else {\r\n                throw new Error('Unknown error');\r\n            }\r\n            _fmt = _fmt.substring(match[0].length);\r\n        }\r\n        return parse_tree;\r\n    }\r\n\r\n    private format(parse_tree, argv) {\r\n        let cursor = 0; \r\n        let tree_length = parse_tree.length; \r\n        let output = [];\r\n\r\n        for (let i = 0; i < tree_length; i++) {\r\n            let node_type = this.getType(parse_tree[i]);\r\n            if (node_type === 'string') {\r\n                output.push(parse_tree[i]);\r\n            }\r\n            else if (node_type === 'array') {\r\n                let match = parse_tree[i]; // convenience purposes only\r\n                let arg: any;\r\n                if (match[2]) { // keyword argument\r\n                    arg = argv[cursor];\r\n                    for (let k = 0; k < match[2].length; k++) {\r\n                        if (!arg.hasOwnProperty(match[2][k])) {\r\n                            throw new Error(this.sprintf('Property \"%s\" does not exist', match[2][k]));\r\n                        }\r\n                        arg = arg[match[2][k]];\r\n                    }\r\n                } else if (match[1]) { // positional argument (explicit)\r\n                    arg = argv[match[1]];\r\n                }\r\n                else { // positional argument (implicit)\r\n                    arg = argv[cursor++];\r\n                }\r\n\r\n                if (/[^s]/.test(match[8]) && (this.getType(arg) != 'number')) {\r\n                    throw new Error(this.sprintf('Expecting number but found %s', this.getType(arg)));\r\n                }\r\n                switch (match[8]) {\r\n                    case 'b': arg = arg.toString(2); break;\r\n                    case 'c': arg = String.fromCharCode(arg); break;\r\n                    case 'd': arg = parseInt(arg, 10); break;\r\n                    case 'e': arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential(); break;\r\n                    case 'f': arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg); break;\r\n                    case 'o': arg = arg.toString(8); break;\r\n                    case 's': arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg); break;\r\n                    case 'u': arg = Math.abs(arg); break;\r\n                    case 'x': arg = arg.toString(16); break;\r\n                    case 'X': arg = arg.toString(16).toUpperCase(); break;\r\n                }\r\n                arg = (/[def]/.test(match[8]) && match[3] && arg >= 0 ? '+'+ arg : arg);                \r\n                let pad_character = match[4] ? match[4] == '0' ? '0' : match[4].charAt(1) : ' ';\r\n                let pad_length = match[6] - String(arg).length;\r\n                let pad = match[6] ? this.strRepeat(pad_character, pad_length) : '';\r\n                output.push(match[5] ? arg + pad : pad + arg);\r\n            }\r\n        }\r\n        return output.join('');\r\n    }\r\n    \r\n    public sprintf(message: string, ...args: any[]): string {\r\n        if (!this.cache.hasOwnProperty(message))\r\n            this.cache[message] = this.parseFormat(message);\r\n\r\n        return this.format(this.cache[message], args);\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport let ResetPageEvent: string = \"pipResetPage\";\r\nexport let ResetAreaEvent: string = \"pipResetArea\";\r\n\r\nexport let ResetRootVar: string = \"$reset\";\r\nexport let ResetAreaRootVar: string = \"$resetArea\";\r\n\r\nexport interface IPageResetService {\r\n    reset(): void;\r\n    resetArea(area: string): void;\r\n}\r\n\r\nexport class PageResetService implements IPageResetService {\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _timeout: ng.ITimeoutService;\r\n\r\n    public constructor(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $timeout: ng.ITimeoutService\r\n    ) {\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._timeout = $timeout;\r\n\r\n        $rootScope[ResetRootVar] = false;\r\n        $rootScope[ResetAreaRootVar] = null;\r\n    }\r\n\r\n    public reset(): void {\r\n        this._log.debug(\"Resetting the entire page\");\r\n        this.performReset(null);\r\n    }\r\n\r\n    public resetArea(area: string): void {\r\n        this._log.debug(\"Resetting the area \" + area);\r\n        this.performReset(area);\r\n    }\r\n\r\n    private performReset(area?: string): void {\r\n        this._rootScope[ResetRootVar] = area == null;\r\n        this._rootScope[ResetAreaRootVar] = area;\r\n\r\n        this._timeout(() => {\r\n            this._rootScope[ResetRootVar] = false;\r\n            this._rootScope[ResetAreaRootVar] = null;\r\n        }, 0);\r\n    }\r\n}\r\n\r\nexport function hookResetEvents(\r\n    $rootScope: ng.IRootScopeService, \r\n    pipPageReset: IPageResetService\r\n) {\r\n    $rootScope.$on(ResetPageEvent, () => { pipPageReset.reset(); });\r\n    $rootScope.$on(ResetAreaEvent, (event, area) => { pipPageReset.resetArea(area); });\r\n}","'use strict';\r\n\r\nexport interface IScrollService {\r\n    scrollTo(parentElement, childElement, animationDuration): void;\r\n}\r\n\r\nexport class ScrollService implements IScrollService {\r\n\r\n    public scrollTo(parentElement, childElement, animationDuration): void {\r\n        if (!parentElement || !childElement) return;\r\n        if (animationDuration == undefined) animationDuration = 300;\r\n\r\n        setTimeout(function () {\r\n            if (!$(childElement).position()) return;\r\n            var modDiff= Math.abs($(parentElement).scrollTop() - $(childElement).position().top);\r\n            if (modDiff < 20) return;\r\n            var scrollTo = $(parentElement).scrollTop() + ($(childElement).position().top - 20);\r\n            if (animationDuration > 0)\r\n                $(parentElement).animate({\r\n                    scrollTop: scrollTo + 'px'\r\n                }, animationDuration);\r\n        }, 100);\r\n    }\r\n\r\n}\r\n","'use strict';\r\n\r\nexport interface ISystemInfo {\r\n    browserName: string;\r\n    browserVersion: string;\r\n    platform: string;\r\n    os: string;\r\n\r\n    isDesktop(): boolean;\r\n    isMobile(): boolean;\r\n    isCordova(): boolean;\r\n    isSupported(supported?: any): boolean;\r\n}\r\n\r\nexport class SystemInfo implements ISystemInfo {\r\n    private _window: ng.IWindowService;\r\n\r\n    public constructor($window: ng.IWindowService) {\r\n        \"ngInject\";\r\n\r\n        this._window = $window;\r\n    }\r\n\r\n    // todo add support for iPhone\r\n    public get browserName(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        if (ua.search(/Edge/) > -1) return \"edge\";\r\n        if (ua.search(/MSIE/) > -1) return \"ie\";\r\n        if (ua.search(/Trident/) > -1) return \"ie\";\r\n        if (ua.search(/Firefox/) > -1) return \"firefox\";\r\n        if (ua.search(/Opera/) > -1) return \"opera\";\r\n        if (ua.search(/OPR/) > -1) return \"opera\";\r\n        if (ua.search(/YaBrowser/) > -1) return \"yabrowser\";\r\n        if (ua.search(/Chrome/) > -1) return \"chrome\";\r\n        if (ua.search(/Safari/) > -1) return \"safari\";\r\n        if (ua.search(/Maxthon/) > -1) return \"maxthon\";\r\n        \r\n        return \"unknown\";\r\n    }\r\n\r\n    public get browserVersion(): string {\r\n        let version;\r\n        let ua = this._window.navigator.userAgent;\r\n        let browser = this.browserName;\r\n\r\n        switch (browser) {\r\n            case \"edge\":\r\n                version = (ua.split(\"Edge\")[1]).split(\"/\")[1];\r\n                break;\r\n            case \"ie\":\r\n                version = (ua.split(\"MSIE \")[1]).split(\";\")[0];\r\n                break;\r\n            case \"ie11\":\r\n                browser = \"ie\";\r\n                version = (ua.split(\"; rv:\")[1]).split(\")\")[0];\r\n                break;\r\n            case \"firefox\":\r\n                version = ua.split(\"Firefox/\")[1];\r\n                break;\r\n            case \"opera\":\r\n                version = ua.split(\"Version/\")[1];\r\n                break;\r\n            case \"operaWebkit\":\r\n                version = ua.split(\"OPR/\")[1];\r\n                break;\r\n            case \"yabrowser\":\r\n                version = (ua.split(\"YaBrowser/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"chrome\":\r\n                version = (ua.split(\"Chrome/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"safari\":\r\n                version = (ua.split(\"Version/\")[1]).split(\" \")[0];\r\n                break;\r\n            case \"maxthon\":\r\n                version = ua.split(\"Maxthon/\")[1];\r\n                break;\r\n        }\r\n\r\n        return version;\r\n    }\r\n    \r\n    public get platform(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        if (/iphone|ipad|ipod|android|blackberry|mini|windows\\sce|palm/i.test(ua.toLowerCase())) \r\n            return 'mobile';\r\n\r\n        return 'desktop';\r\n    }\r\n\r\n    public get os(): string {\r\n        let ua = this._window.navigator.userAgent;\r\n\r\n        try {\r\n            let osAll = (/(windows|mac|android|linux|blackberry|sunos|solaris|iphone)/.exec(ua.toLowerCase()) || [ua])[0].replace('sunos', 'solaris');\r\n            let osAndroid = (/(android)/.exec(ua.toLowerCase()) || '');\r\n            return osAndroid && (osAndroid == 'android' || (osAndroid[0] == 'android')) ? 'android' : osAll;\r\n        } catch (err) {\r\n            return 'unknown'\r\n        }\r\n    }\r\n\r\n    public isDesktop(): boolean {\r\n        return this.platform == 'desktop';\r\n    }\r\n\r\n    public isMobile(): boolean {\r\n        return this.platform == 'mobile';\r\n    }\r\n\r\n    // Todo: complete implementation\r\n    public isCordova(): boolean {\r\n        return false;\r\n    }\r\n\r\n    // Todo: Move to errors\r\n    public isSupported(supported?: any): boolean {\r\n        if (!supported) \r\n            supported = {\r\n                edge: 11,\r\n                ie: 11,\r\n                firefox: 43, //4, for testing\r\n                opera: 35,\r\n                chrome: 47\r\n            };\r\n\r\n        let browser = this.browserName;\r\n        let version = this.browserVersion;\r\n        version = version.split(\".\")[0]\r\n\r\n        if (browser && supported[browser] && version >= supported[browser]) \r\n            return true;\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\n\r\n","'use strict';\r\n\r\nexport interface ITags {\r\n    normalizeOne(tag: string): string;\r\n    compressOne(tag: string): string;\r\n    equal(tag1: string, tag2: string): boolean;\r\n    normalizeAll(tags: any): string[];\r\n    compressAll(tags: any): string[];\r\n    extract(entity: any, searchFields?: string[]): string[];\r\n}\r\n\r\nexport class Tags implements ITags {\r\n\r\n    public normalizeOne(tag: string): string {\r\n        return tag \r\n            ? _.trim(tag.replace(/(_|#)+/g, ' '))\r\n            : null;\r\n    }\r\n\r\n    public compressOne(tag: string): string {\r\n        return tag\r\n            ? tag.replace(/( |_|#)/g, '').toLowerCase()\r\n            : null;\r\n    }\r\n\r\n    public equal(tag1: string, tag2: string): boolean {\r\n        if (tag1 == null && tag2 == null)\r\n            return true;\r\n        if (tag1 == null || tag2 == null)\r\n            return false;\r\n        return this.compressOne(tag1) == this.compressOne(tag2);\r\n    }\r\n\r\n    public normalizeAll(tags: any): string[] {\r\n        if (_.isString(tags))\r\n            tags = tags.split(/( |,|;)+/);\r\n\r\n        tags = _.map(tags, (tag: string) => this.normalizeOne(tag));\r\n\r\n        return tags;\r\n    }\r\n\r\n    public compressAll(tags: any): string[] {\r\n        if (_.isString(tags))\r\n            tags = tags.split(/( |,|;)+/);\r\n\r\n        tags = _.map(tags, (tag: string) => this.compressOne(tag));\r\n\r\n        return tags;\r\n    }\r\n\r\n    public extract(entity: any, searchFields?: string[]): string[] {\r\n        let tags = this.normalizeAll(entity.tags);\r\n\r\n        _.each(searchFields, (field) => {\r\n            let text = entity[field] || '';\r\n\r\n            if (text != '') {\r\n                let hashTags = text.match(/#\\w+/g);\r\n                tags = tags.concat(this.normalizeAll(hashTags));\r\n            }\r\n        });\r\n\r\n        return _.uniq(tags);\r\n    }\r\n}\r\n","'use strict';\r\n\r\nexport interface ITimerService {\r\n    isStarted(): boolean;\r\n\r\n    addEvent(event: string, timeout: number): void;\r\n    removeEvent(event: string): void;\r\n    clearEvents(): void;\r\n\r\n    start(): void;\r\n    stop(): void;\r\n}\r\n\r\nclass TimerEvent {\r\n    public event: string;\r\n    public timeout: number;\r\n    public interval: any;\r\n\r\n    public constructor(event: string, timeout: number) {\r\n        this.event = event;\r\n        this.timeout = timeout;\r\n    }\r\n}\r\n\r\nlet DefaultEvents: TimerEvent[] = [\r\n    new TimerEvent('pipAutoPullChanges', 60000), // 1 min\r\n    new TimerEvent('pipAutoUpdatePage', 15000), // 15 sec\r\n    new TimerEvent('pipAutoUpdateCollection', 300000) // 5 min\r\n];\r\n\r\nexport class TimerService implements ITimerService {\r\n    private _rootScope: ng.IRootScopeService;\r\n    private _log: ng.ILogService;\r\n    private _interval: ng.IIntervalService;        \r\n    private _started = false;\r\n    private _events: TimerEvent[] = _.cloneDeep(DefaultEvents);\r\n\r\n    public constructor(\r\n        $rootScope: ng.IRootScopeService,\r\n        $log: ng.ILogService, \r\n        $interval: ng.IIntervalService\r\n    ) {\r\n        \"ngInject\";\r\n\r\n        this._rootScope = $rootScope;\r\n        this._log = $log;\r\n        this._interval = $interval;\r\n    }\r\n\r\n    public isStarted(): boolean {\r\n        return this._started;\r\n    }\r\n\r\n    public addEvent(event: string, timeout: number): void {\r\n        var existingEvent = _.find(this._events, (e) => e.event == event);\r\n        if (existingEvent != null) return;\r\n\r\n        let newEvent = <TimerEvent> {\r\n            event: event,\r\n            timeout: timeout\r\n        };\r\n        this._events.push(newEvent);\r\n\r\n        if (this._started)\r\n            this.startEvent(newEvent);\r\n    }\r\n\r\n    public removeEvent(event: string): void {\r\n        for (let i = this._events.length - 1; i >= 0; i--) {\r\n            let existingEvent = this._events[i];\r\n            if (existingEvent.event == event) {\r\n                this.stopEvent(existingEvent);\r\n                this._events.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    public clearEvents(): void {\r\n        this.stop();\r\n        this._events = [];\r\n    }\r\n\r\n    private startEvent(event: TimerEvent): void {\r\n        event.interval = this._interval(\r\n            () => { \r\n                this._log.debug('Generated timer event ' + event.event); \r\n                this._rootScope.$emit(event.event)\r\n            },\r\n            event.timeout\r\n        )\r\n    }\r\n\r\n    private stopEvent(event: TimerEvent): void {\r\n        if (event.interval != null) {\r\n            try {\r\n                this._interval.cancel(event.interval);\r\n            } catch (ex) {\r\n                // Do nothing\r\n            }\r\n            event.interval = null;\r\n        }\r\n    }\r\n\r\n    public start(): void {\r\n        if (this._started) return;\r\n\r\n        _.each(this._events, (event) => {\r\n            this.startEvent(event);\r\n        });\r\n\r\n        this._started = true;\r\n    }\r\n\r\n    public stop(): void {\r\n        _.each(this._events, (event) => {\r\n            this.stopEvent(event);\r\n        });\r\n\r\n        this._started = false;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nimport { Format } from './Format';\r\nimport { Tags } from './Tags';\r\nimport { Codes } from './Codes';\r\nimport { SystemInfo } from './SystemInfo';\r\nimport { TimerService } from './TimerService';\r\nimport { ScrollService } from './ScrollService';\r\n\r\nangular.module('pipFormat', []).service('pipFormat', Format);\r\nangular.module('pipTags', []).service('pipTags', Tags);\r\nangular.module('pipCodes', []).service('pipCodes', Codes);\r\nangular.module('pipSystemInfo', []).service('pipSystemInfo', SystemInfo);\r\nangular.module('pipTimer', []).service('pipTimer', TimerService);\r\nangular.module('pipScroll', []).service('pipScroll', ScrollService);\r\n\r\nimport { PageResetService } from './PageResetService';\r\nimport { hookResetEvents } from './PageResetService';\r\n\r\nangular.module('pipPageReset', [])\r\n    .service('pipPageReset', PageResetService)\r\n    .run(hookResetEvents);\r\n\r\nangular\r\n    .module('pipUtils', [\r\n        'pipFormat',\r\n        'pipTimer',\r\n        'pipScroll',\r\n        'pipTags',\r\n        'pipCodes',\r\n        'pipSystemInfo',\r\n        'pipPageReset'\r\n    ]);\r\n\r\n"]}